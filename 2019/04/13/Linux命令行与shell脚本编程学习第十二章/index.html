<!DOCTYPE html>
<html>
<head>
 <meta name="baidu-site-verification" content="d8vuriatOq" />
 <meta name="google-site-verification" content="ZKzrltgUA1iKyVKyH5hNp1TzVg-9LIJqbb09vFyUcWg" />
  <meta charset="utf-8">
  

  
  <title>Linux命令行与shell脚本编程学习第十二章 | Rumble&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="使用结构化命令在一些简单脚本中，shell按照命令在脚本中出现的顺序依次进行处理。但许多程序要求对shell脚本中的命令施加一些逻辑流程控制。有一类命令会根据条件使脚本跳过某些命令。这样的命令通常称为结构化命令。">
<meta name="keywords" content="Linux，shell, bash">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux命令行与shell脚本编程学习第十二章">
<meta property="og:url" content="https://cldiao.github.io/2019/04/13/Linux命令行与shell脚本编程学习第十二章/index.html">
<meta property="og:site_name" content="Rumble&#39;s blog">
<meta property="og:description" content="使用结构化命令在一些简单脚本中，shell按照命令在脚本中出现的顺序依次进行处理。但许多程序要求对shell脚本中的命令施加一些逻辑流程控制。有一类命令会根据条件使脚本跳过某些命令。这样的命令通常称为结构化命令。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-05-03T15:14:28.619Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux命令行与shell脚本编程学习第十二章">
<meta name="twitter:description" content="使用结构化命令在一些简单脚本中，shell按照命令在脚本中出现的顺序依次进行处理。但许多程序要求对shell脚本中的命令施加一些逻辑流程控制。有一类命令会根据条件使脚本跳过某些命令。这样的命令通常称为结构化命令。">
  
    <link rel="alternate" href="/atom.xml" title="Rumble&#39;s blog" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon" type="image/x-ico">
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Rumble&#39;s blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Stay hungry, stay foolish.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://cldiao.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Linux命令行与shell脚本编程学习第十二章" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/13/Linux命令行与shell脚本编程学习第十二章/" class="article-date">
  <time datetime="2019-04-13T09:47:41.000Z" itemprop="datePublished">2019-04-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Linux命令行与shell脚本编程学习第十二章
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
	         <!-- Table of Contents -->
                 
                   <div id="toc" class="toc-article">
                     <strong class="toc-title">目录</strong>
                     <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#使用结构化命令"><span class="toc-text">使用结构化命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-使用if-then-语句"><span class="toc-text">1. 使用if-then 语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-if-then-else语句"><span class="toc-text">2. if-then-else语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-嵌套if"><span class="toc-text">3 嵌套if</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-test命令"><span class="toc-text">4 test命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-数值比较"><span class="toc-text">4.1 数值比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-字符串比较"><span class="toc-text">4.2 字符串比较</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-字符串相等性"><span class="toc-text">4.2.1 字符串相等性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-字符串顺序"><span class="toc-text">4.2.2 字符串顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-字符串大小"><span class="toc-text">4.2.3 字符串大小</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-文件比较"><span class="toc-text">4.3 文件比较</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1检查目录"><span class="toc-text">4.3.1检查目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-检查对象是否存在"><span class="toc-text">4.3.2 检查对象是否存在</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-检查文件"><span class="toc-text">4.3.3 检查文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-4-检查是否可读"><span class="toc-text">4.3.4 检查是否可读</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-5-检查空文件"><span class="toc-text">4.3.5 检查空文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-6-检查是否可写"><span class="toc-text">4.3.6 检查是否可写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-7-检查文件是否可以执行"><span class="toc-text">4.3.7 检查文件是否可以执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-8-检查所属关系"><span class="toc-text">4.3.8 检查所属关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-9-检查默认属组关系"><span class="toc-text">4.3.9 检查默认属组关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-10-检查文件日期"><span class="toc-text">4.3.10 检查文件日期</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-复合条件测试"><span class="toc-text">5 复合条件测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-if-then的高级特性"><span class="toc-text">6 if-then的高级特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-使用双括号"><span class="toc-text">6.1 使用双括号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-使用双方括号"><span class="toc-text">6.2 使用双方括号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-case命令"><span class="toc-text">7 case命令</span></a></li></ol></li></ol>
                   </div>
                 
        <h1 id="使用结构化命令"><a href="#使用结构化命令" class="headerlink" title="使用结构化命令"></a>使用结构化命令</h1><p>在一些简单脚本中，shell按照命令在脚本中出现的顺序依次进行处理。但许多程序要求对shell脚本中的命令施加一些逻辑流程控制。有一类命令会根据条件使脚本跳过某些命令。这样的命令通常称为结构化命令。</p>
<a id="more"></a>
<h2 id="1-使用if-then-语句"><a href="#1-使用if-then-语句" class="headerlink" title="1. 使用if-then 语句"></a>1. 使用if-then 语句</h2><p>最基本的结构化命令就是if-then语句。格式：</p>
<p><code>if command</code></p>
<p><code>then</code></p>
<p>​        <code>commands</code></p>
<p><code>fi</code></p>
<p>bash shell的if语句会运行if后面的那个命令。如果该命令的退出状态码是0，位于then部分的命令就会被执行。如果该命令的退出状态码是其他值，then部分的命令被跳过，bash shell会继续执行脚本中的下一个命令。fi语句用来表示if-then语句到此结束。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ cat test1.sh </span><br><span class="line"><span class="meta">#</span>！/bin/bash</span><br><span class="line"><span class="meta">#</span> testing the if statement</span><br><span class="line">if pwd</span><br><span class="line">then</span><br><span class="line">    echo "It worked"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ chmod u+x test1.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ./test1.sh </span><br><span class="line">/home/vip5</span><br><span class="line">It worked</span><br></pre></td></tr></table></figure>
<p>上面这个脚本中，if行采用了pwd命令。命令成功结束，echo语句显示文本字符串。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test1.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing a bad command</span><br><span class="line">if IamNotCommand</span><br><span class="line">then</span><br><span class="line">    echo "It worked"</span><br><span class="line">fi</span><br><span class="line">echo "We are outside the if statement"</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test1.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test1.sh </span><br><span class="line">./test1.sh: line 3: IamNotCommand: command not found</span><br><span class="line">We are outside the if statement</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure>
<p>上面这个例子中，if语句使用了错误的命令，产生非零的退出状态码，且bash shell跳过then部分的echo语句。运行if语句中的那个错误命令产生的错误消息依然会显示在脚本的输出中。</p>
<p>在then部分，可以使用多条命令。bash shell会将这些命令当成一个块，如果if语句行的命令的退出状态值是0，所有的命令都会被执行；如果if语句行的命令退出状态不为0，所有的命令都会被跳过。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test2.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing multiple commands in the then section</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">testuser=vip5</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if grep $testuser /etc/passwd</span><br><span class="line">then </span><br><span class="line">   echo "This is my first command"</span><br><span class="line">   echo "This is my second command"</span><br><span class="line">   echo "I can even put in other commands besides echo:"</span><br><span class="line">   ls -a /home/$testuser/.b*</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test2.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test2.sh </span><br><span class="line">vip5:x:1009:1013::/home/vip5:/bin/bash</span><br><span class="line">This is my first command</span><br><span class="line">This is my second command</span><br><span class="line">I can even put in other commands besides echo:</span><br><span class="line">/home/vip5/.bash_history  /home/vip5/.ba</span><br></pre></td></tr></table></figure>
<p>if语句行使用grep命令在/etc/passwd文件中查找某个用户名当前是否在系统上使用。如果用户使用了那个登录名，脚本会显示一些文本信息并列出该用户HOME目录的bash文件。但是，当testuser变量设置成一个系统上不存在的用户，则什么都不会显示。</p>
<h2 id="2-if-then-else语句"><a href="#2-if-then-else语句" class="headerlink" title="2. if-then-else语句"></a>2. if-then-else语句</h2><p>如果命令返回一个非零退出状态码，bash shell会继续执行脚本中的下一条命令。这时，如果能执行另一组命令，需要if-then-else语句。</p>
<p>if-then-else语句在语句中提供了另外一组命令。</p>
<p><code>if command</code></p>
<p><code>then</code></p>
<p>​      <code>commands</code></p>
<p><code>else</code></p>
<p>​      <code>commands</code></p>
<p><code>fi</code></p>
<p>当if语句中的命令返回退出状态码0时，then部分中的命令会被执行。当if语句中的命令返回状态非零时，else部分中的命令会被执行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cp test2.sh test3.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ nano test3.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test3.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing the else section</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">testuser=NoSuchUser</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if grep $testuser /etc/passwd</span><br><span class="line">then </span><br><span class="line">   echo "The bash files for user $testuser are:"</span><br><span class="line">   ls -a /home/$testuser/.b*</span><br><span class="line">   echo</span><br><span class="line">else</span><br><span class="line">   echo "The user $testuser does not exit on this system."</span><br><span class="line">   echo</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test3.sh </span><br><span class="line">The user NoSuchUser does not exit on this system.</span><br></pre></td></tr></table></figure>
<p>else部分可以包含多条命令。fi语句说明else部分结束了。</p>
<h2 id="3-嵌套if"><a href="#3-嵌套if" class="headerlink" title="3 嵌套if"></a>3 嵌套if</h2><p>有时需要检查脚本代码中的多种条件。对此，可以使用嵌套的if-then语句。</p>
<p>要检查/etc/psswd文件中是否存在某个用户名以及该用户的目录是否尚在，可以使用嵌套的if-then语句。嵌套的if-then语句位于主if-then-else语句的else代码块中。但在脚本中使用这种嵌套的if-then语句会使代码不易阅读，很难理清逻辑流程。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test4.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing the else section</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">testuser=NoSuchUser</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if grep $testuser /etc/passwd</span><br><span class="line">then </span><br><span class="line">   echo "Ther user $testuser exits on this system."</span><br><span class="line">else</span><br><span class="line">   echo "The user $testuser does not exit on this system."</span><br><span class="line">   if ls -d /home/$testuser/</span><br><span class="line">   then</span><br><span class="line">      echo "However, $testuser has a directory."</span><br><span class="line">   fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>可以使用else部分的另一种形式：elif。这样不用书写多个if-then语句。</p>
<p><code>if commands</code></p>
<p><code>then</code></p>
<p>​      <code>commands</code></p>
<p><code>elif command2</code></p>
<p><code>then</code></p>
<p>​      <code>more commands</code></p>
<p><code>fi</code></p>
<p>elif语句行提供了另一个要测试的命令，如果elif后命令的退出状态码是0，则bash会执行第二个then语句部分的命令。使用这样的嵌套方法，代码更清晰，逻辑更易懂。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test5.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Testing nested ifs - use elif</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">testuser=NoSuchUser</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if grep $testuser /etc/passwd</span><br><span class="line">then</span><br><span class="line">   echo "The user $testuser exits on this system."</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">elif ls -d /home/$testuser</span><br><span class="line">then</span><br><span class="line">   echo "The user $testuser does not exist on this system."</span><br><span class="line">   echo "However, $testuser has a directory."</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>甚至可以让脚本检查拥有目录的不存在用户以及没有拥有目录的不存在用户据。这可以通过嵌套再elif中加入一个else语句来实现。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test5.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Testing nested ifs - use elif</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">testuser=NoSuchUser</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if grep $testuser /etc/passwd</span><br><span class="line">then</span><br><span class="line">   echo "The user $testuser exits on this system."</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">elif ls -d /home/$testuser</span><br><span class="line">then</span><br><span class="line">   echo "The user $testuser does not exist on this system."</span><br><span class="line">   echo "However, $testuser has a directory."</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">else</span><br><span class="line">   echo "The user $testuser does not exit on this system."</span><br><span class="line">   echo "However, $testuser does not have a directory."</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>可以将多个elif语句穿起来，形成一个大的if-then-elif嵌套组合。</p>
<p><code>if command1</code></p>
<p><code>then</code></p>
<p>​      <code>command set1</code></p>
<p><code>elif command2</code></p>
<p><code>then</code></p>
<p>​      <code>command set 2</code></p>
<p><code>elif command 3</code></p>
<p><code>then</code></p>
<p>​      <code>command set 3</code></p>
<p><code>elif command 4</code></p>
<p><code>then</code></p>
<p>​      <code>command set 4</code></p>
<p><code>fi</code></p>
<p>每块命令都会根据命令是否会返回退出状态码0来执行。bash shell会一次执行if语句，只有第一个返回退出状态码0的语句中的then部分会被执行。</p>
<h2 id="4-test命令"><a href="#4-test命令" class="headerlink" title="4 test命令"></a>4 test命令</h2><p>if-then语句不能测试命令退出状态码之外的条件。但bash shell中的test命令可以通过if-then语句测试不同条件的途径。如果test命令中列出的条件成立，test命令就会退出并返回退出状态码0.这样if-then语句就和其他编程语言中的if-then语句以类似的方式工作了。如果条件不成立，test命令就会退出并返回非零的退出状态码，使得if-then语句不再被执行。test命令格式：<code>test condition</code>。</p>
<p>condition是test命令要测试的一系列参数和值。当用在if-then语句中时，如下。</p>
<p><code>if test condition</code></p>
<p><code>then</code></p>
<p>​     <code>commands</code></p>
<p><code>fi</code></p>
<p>如果不写test命令的condition部分，它会以非零的退出状态码退出，并执行else语句块。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test6.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Testing the test command</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">if test</span><br><span class="line">then</span><br><span class="line">   echo "No expression returns a True."</span><br><span class="line">else</span><br><span class="line">   echo "No expression returns a False."</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test6.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test6.sh </span><br><span class="line">No expression returns a False.</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure>
<p>当加入一个条件时，test命令会测试该条件。例如，确定变量中是否有内容。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test6.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Testing the test command</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">my_variable="Full"</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">if test $my_variable</span><br><span class="line">then</span><br><span class="line">   echo "No expression returns a True."</span><br><span class="line">else</span><br><span class="line">   echo "No expression returns a False."</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test6.sh </span><br><span class="line">No expression returns a True.</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure>
<p>bash shell有另一种测试方法，无需在if-then语句中生命test命令。</p>
<p><code>if [ condition ]</code></p>
<p><code>then</code></p>
<p>​      <code>commands</code></p>
<p><code>fi</code></p>
<p>方括号定义测试条件。方括号和condition之间要有空格。</p>
<p>test命令可以判断三类条件：</p>
<ul>
<li>数值比较</li>
<li>字符串比较</li>
<li>文件比较</li>
</ul>
<h3 id="4-1-数值比较"><a href="#4-1-数值比较" class="headerlink" title="4.1 数值比较"></a>4.1 数值比较</h3><p>testm命令最常用于对两个整数数值的比较（浮点数会报错）。下表为测试两个值时可用的条件参数。</p>
<table>
<thead>
<tr>
<th>比较</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>n1 -eq n2</td>
<td>n1是否等于n2</td>
</tr>
<tr>
<td>n1 -ge n2</td>
<td>n1是否大于或等于n2</td>
</tr>
<tr>
<td>n1 -gt n2</td>
<td>n1是否大于n2</td>
</tr>
<tr>
<td>n1 -le n2</td>
<td>n1是否小于或等于n2</td>
</tr>
<tr>
<td>n1 -lt n2</td>
<td>n1是否小于n2</td>
</tr>
<tr>
<td>n1 -ne n2</td>
<td>n1是否不等于n2</td>
</tr>
</tbody>
</table>
<p>数值条件测试可以用在数字和变量上。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat numeric_test.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Using numeric test evaluations</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">value1=10</span><br><span class="line">value2=11</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ $value1 -gt 5 ]</span><br><span class="line">then </span><br><span class="line">   echo "The test value $value1 is greater than 5."</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ $value1 -eq $value2 ]</span><br><span class="line">then </span><br><span class="line">   echo "The values are equel."</span><br><span class="line">else </span><br><span class="line">   echo "The values are different."</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./numeric_test.sh </span><br><span class="line">The test value 10 is greater than 5.</span><br><span class="line">The values are different.</span><br></pre></td></tr></table></figure>
<h3 id="4-2-字符串比较"><a href="#4-2-字符串比较" class="headerlink" title="4.2 字符串比较"></a>4.2 字符串比较</h3><p>条件测试允许比较字符串值，但比较麻烦。下面是常用字符串比较功能。</p>
<table>
<thead>
<tr>
<th>比较</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>str1 = str2</td>
<td>检查str1是否和str2相同</td>
</tr>
<tr>
<td>str1 != str2</td>
<td>检查str1是否和str2不同</td>
</tr>
<tr>
<td>str1 &gt; str2</td>
<td>检查str1是否比str2大</td>
</tr>
<tr>
<td>str1 &lt; str2</td>
<td>检查str1是否比str2小</td>
</tr>
<tr>
<td>-n str1</td>
<td>检查str1的长度是否非0</td>
</tr>
<tr>
<td>-z str1</td>
<td>检查str1的长度是否为0</td>
</tr>
</tbody>
</table>
<h4 id="4-2-1-字符串相等性"><a href="#4-2-1-字符串相等性" class="headerlink" title="4.2.1 字符串相等性"></a>4.2.1 字符串相等性</h4><p>在比较字符串的相等性时，比较测试会将所有的标点和大小写情况都考虑在内。</p>
<h4 id="4-2-2-字符串顺序"><a href="#4-2-2-字符串顺序" class="headerlink" title="4.2.2 字符串顺序"></a>4.2.2 字符串顺序</h4><p>当开始使用测试条件的大于或小于功能时，会出现两个问题：</p>
<ul>
<li>大于号和小于号必须转义，否则会被当做重定向符号，把字符串值当做文件名</li>
<li>大于和小于顺序和sort命令所采用的不同</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test7.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> mis-using string comparisons</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">val1=baseball</span><br><span class="line">val2=hockey</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ $val1 \&gt; $val2 ]</span><br><span class="line">then</span><br><span class="line">   echo "$val1 is greater than $val2"</span><br><span class="line">else </span><br><span class="line">   echo "$val1 is less than $val2"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test7.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test7.sh </span><br><span class="line">baseball is less than hockey</span><br></pre></td></tr></table></figure>
<p>第二个问题很少遇到。sort命令处理大小写字母的方法正好和test命令相反。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test8.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing string sort order</span><br><span class="line">val1=Testing</span><br><span class="line">val2=testing</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ $val1 \&gt; $val2 ]</span><br><span class="line">then</span><br><span class="line">   echo "$val1 is greater than $val2"</span><br><span class="line">else</span><br><span class="line">   echo "$val1 is less than $val2"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test8.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test8.sh </span><br><span class="line">Testing is less than testing</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort testfile </span><br><span class="line">testing</span><br><span class="line">Testing</span><br></pre></td></tr></table></figure>
<p>比较测试中大写字母被认为是小于小写字母的。sort命令相反。</p>
<h4 id="4-2-3-字符串大小"><a href="#4-2-3-字符串大小" class="headerlink" title="4.2.3 字符串大小"></a>4.2.3 字符串大小</h4><p>-n和-z参数可以检查一个变量是否含有数据。未被定义的变量字符串长度仍然为0。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test9.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing string length</span><br><span class="line">val1=testing</span><br><span class="line">val2=''</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -n $val1 ]</span><br><span class="line">then </span><br><span class="line">   echo "The string '$val1' is not empty"</span><br><span class="line">else </span><br><span class="line">   echo "The string '$val1' is empty"</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -z $val2 ]</span><br><span class="line">then</span><br><span class="line">   echo "The string '$val2' is empty"</span><br><span class="line">else </span><br><span class="line">   echo "The string '$val2' is not empty"</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -z $val3 ]</span><br><span class="line">then </span><br><span class="line">   echo "The string '$val3' is empty"</span><br><span class="line">else</span><br><span class="line">   echo "The string '$val3' is not empty"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test9.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test9.sh </span><br><span class="line">The string 'testing' is not empty</span><br><span class="line">The string '' is empty</span><br><span class="line">The string '' is empty</span><br></pre></td></tr></table></figure>
<h3 id="4-3-文件比较"><a href="#4-3-文件比较" class="headerlink" title="4.3 文件比较"></a>4.3 文件比较</h3><p>这类是shell编程中最强大、用的最多的比较形式。可以测试Linux文件系统上文件和目录的状态。</p>
<table>
<thead>
<tr>
<th>比较</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>-d file</td>
<td>file是否存在并是一个目录</td>
</tr>
<tr>
<td>-e file</td>
<td>file是否存在</td>
</tr>
<tr>
<td>-f file</td>
<td>file是否存在并是一个文件</td>
</tr>
<tr>
<td>-r file</td>
<td>file是否存在并可读</td>
</tr>
<tr>
<td>-s file</td>
<td>file是否存在并非空</td>
</tr>
<tr>
<td>-w file</td>
<td>file是否存在并可写</td>
</tr>
<tr>
<td>-x file</td>
<td>file是否存在并可执行</td>
</tr>
<tr>
<td>-O file</td>
<td>file是否存在并属于当前用户所有</td>
</tr>
<tr>
<td>-G file</td>
<td>file是否存在并且默认组与当前用户相同</td>
</tr>
<tr>
<td>file1 -nt file2</td>
<td>file1是否比file2新</td>
</tr>
<tr>
<td>file1 -ot file2</td>
<td>file1是否比file2旧</td>
</tr>
</tbody>
</table>
<p>这些测试条件是我们可以在shell脚本中检查文件系统中的文件。经常出现在需要进行文件访问的脚本中。</p>
<h4 id="4-3-1检查目录"><a href="#4-3-1检查目录" class="headerlink" title="4.3.1检查目录"></a>4.3.1检查目录</h4><p>-d测试会检查指定的目录是否存在于系统中。在打算将文件写入目录或是准备切换到某个目录中，先测试总是好的。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test10.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Look before you leap</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">jump_directory=/home/arthur</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">if [ -d $The $jump_directory ]</span><br><span class="line">then</span><br><span class="line">   echo "The $jump_directory directory exits"</span><br><span class="line">   cd $jump_directory</span><br><span class="line">   ls</span><br><span class="line">else</span><br><span class="line">   echo "The $jump_directory directory does not exit"</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test10.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test10.sh </span><br><span class="line">The /home/arthur directory does not exit</span><br></pre></td></tr></table></figure>
<h4 id="4-3-2-检查对象是否存在"><a href="#4-3-2-检查对象是否存在" class="headerlink" title="4.3.2 检查对象是否存在"></a>4.3.2 检查对象是否存在</h4><p>-e比较使得代码在使用文件或目录前先检查它们是否存在。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test11.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Check if either a directory or file exists</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">location=$HOME</span><br><span class="line">file_name="sentinel"</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -e $location ]</span><br><span class="line">then #Directory does exist</span><br><span class="line">   echo "OK on the $location directory."</span><br><span class="line">   echo "Now checking on the file, $file_name."</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   if [ -e $location/$file_name ]</span><br><span class="line">   then #File does exist</span><br><span class="line">      echo "OK on the filename"</span><br><span class="line">      echo "Updating Current Date..."</span><br><span class="line">      date &gt;&gt; $location/$file_name</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   else #File does not exist</span><br><span class="line">      echo "File does not exist"</span><br><span class="line">      echo "Nothing to update"</span><br><span class="line">   fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">else #Directory does not exist</span><br><span class="line">   echo "The $location directory does not exist."</span><br><span class="line">   echo "Nothing to update."</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test11.sh </span><br><span class="line">OK on the /home/vip5 directory.</span><br><span class="line">Now checking on the file, sentinel.</span><br><span class="line">File does not exist</span><br><span class="line">Nothing to update</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ touch sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ./test/test11.sh </span><br><span class="line">OK on the /home/vip5 directory.</span><br><span class="line">Now checking on the file, sentinel.</span><br><span class="line">OK on the filename</span><br><span class="line">Updating Current Date...</span><br></pre></td></tr></table></figure>
<h4 id="4-3-3-检查文件"><a href="#4-3-3-检查文件" class="headerlink" title="4.3.3 检查文件"></a>4.3.3 检查文件</h4><p>-e比较可用于文件和目录。要确定指定对象为文件，必须用-f比较。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test12.sh</span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Check if either a directory or fi</span><br><span class="line">le exists</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">item_name=$HOME</span><br><span class="line">echo</span><br><span class="line">echo "The item being checked: $item_name"</span><br><span class="line">echo</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -e $item_name ]</span><br><span class="line">then #Item does exit</span><br><span class="line">   echo "The item, $item_name, does exist."</span><br><span class="line">   echo "But is it a file?"</span><br><span class="line">   echo</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   if [ -f $item_name ]</span><br><span class="line">   then #Item is a file</span><br><span class="line">      echo "Yes, $item_name is a file."</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   else #Item is not a file</span><br><span class="line">      echo "No, $item_name is not a file."</span><br><span class="line">   fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">else #Item does not exist</span><br><span class="line">   echo "The item, $item_name, does not exist."</span><br><span class="line">   echo "Nothing to update"</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test12.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ cd </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ./test/test12.sh </span><br><span class="line"></span><br><span class="line">The item being checked: /home/vip5</span><br><span class="line"></span><br><span class="line">The item, /home/vip5, doe</span><br><span class="line">s exist.</span><br><span class="line">But is it a file?</span><br><span class="line"></span><br><span class="line">No, /home/vip5 is not a file.</span><br></pre></td></tr></table></figure>
<p>我们将变量item_name中目录$HOME替换成文件$HOME/sentinel，结果就不一样。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ./test/test12.sh </span><br><span class="line"></span><br><span class="line">The item being checked: /home/vip5/sentinel</span><br><span class="line"></span><br><span class="line">The item, /home/vip5/sentinel, does exist.</span><br><span class="line">But is it a file?</span><br><span class="line"></span><br><span class="line">Yes, /home/vip5/sentinel is a file.</span><br></pre></td></tr></table></figure>
<h4 id="4-3-4-检查是否可读"><a href="#4-3-4-检查是否可读" class="headerlink" title="4.3.4 检查是否可读"></a>4.3.4 检查是否可读</h4><p>在尝试从文件中读取数据之前，最好用-r测试文件是否可读。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test13.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing if you can read a file</span><br><span class="line">pwfile=/etc/shadow</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> first, test if the file exists, and is a file</span><br><span class="line">if [ -f $pwfile ]</span><br><span class="line">then</span><br><span class="line"><span class="meta">   #</span> now test if you can read it.</span><br><span class="line">   if [ -f $pwfile ]</span><br><span class="line">   then</span><br><span class="line">      tail $pwfile</span><br><span class="line">   else</span><br><span class="line">      echo "Sorry, I am unable to read the $pwfile file"</span><br><span class="line">   fi</span><br><span class="line">else </span><br><span class="line">   echo "Sorry, the file $file does not exist"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test13.sh </span><br><span class="line">Sorry, I am unable to read the /etc/shadow file</span><br></pre></td></tr></table></figure>
<p>/etc/shadow文件中含有系统用户加密后的密码，所以普通用户不可读。因此测试失败，执行了else语句。</p>
<h4 id="4-3-5-检查空文件"><a href="#4-3-5-检查空文件" class="headerlink" title="4.3.5 检查空文件"></a>4.3.5 检查空文件</h4><p>用-s检查文件是否为空，尤其是在不想删除非空文件时。要注意，-s比较成功时，说明文件中有数据。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test14.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Testing if a file is empty</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">file_name=$HOME/sentinel</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -f $file_name ]</span><br><span class="line">then </span><br><span class="line">   if [ -s $file_name ]</span><br><span class="line">   then </span><br><span class="line">      echo "The $file_name file exists and has data in it."</span><br><span class="line">      echo "Will not remove this file."</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">   else</span><br><span class="line">      echo "The $file_name file exists, but is empty."</span><br><span class="line">      echo "Deleting empty file..."</span><br><span class="line">   fi</span><br><span class="line">else </span><br><span class="line">   echo "File, $file_name, does not exist."</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span> </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l $HOME/sentinel</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 29 Apr 17 15:23 /home/vip5/sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test14.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test14.sh </span><br><span class="line">The /home/vip5/sentinel file exists and has data in it.</span><br><span class="line">Will not remove this file.</span><br></pre></td></tr></table></figure>
<h4 id="4-3-6-检查是否可写"><a href="#4-3-6-检查是否可写" class="headerlink" title="4.3.6 检查是否可写"></a>4.3.6 检查是否可写</h4><p>-w比较会判断文件的可写权限。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test15.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> Check if a file is writable</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">item_name=$HOME/sentinel</span><br><span class="line">echo</span><br><span class="line">echo "The item being checked: $item_name"</span><br><span class="line">echo</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -e $item_name ]</span><br><span class="line">then #Item does exist</span><br><span class="line">   echo "The item, $item_name, does exist."</span><br><span class="line">   echo "But is it a file?"</span><br><span class="line">   echo</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   if [ -f $item_name ]</span><br><span class="line">   then #Item is a file</span><br><span class="line">      echo "Yes, $item_name is a file."</span><br><span class="line">      echo "But is it writable?"</span><br><span class="line">      echo</span><br><span class="line">      #</span><br><span class="line">      if [ -w $item_name ]</span><br><span class="line">      then #Ttem is writable</span><br><span class="line">         echo "Writing current time to $item_name"</span><br><span class="line">         date +%H%M &gt;&gt; $item_name</span><br><span class="line">      #</span><br><span class="line">      else #Item is not writable</span><br><span class="line">         echo "Unable to write to $item_name"</span><br><span class="line">      fi</span><br><span class="line"><span class="meta">   #</span></span><br><span class="line">   else #Item is not a file </span><br><span class="line">      echo "No, $item_name is not a file."</span><br><span class="line">   fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">else #Item is not exist</span><br><span class="line">   echo "The item, $item_name, does not exist."</span><br><span class="line">   echo "Nothing to update."</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l sentinel</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Apr 17 15:21 sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test15.sh</span><br><span class="line"></span><br><span class="line">The item being checked: /home/vip5/sentinel</span><br><span class="line"></span><br><span class="line">The item, /home/vip5/sentinel, does exist.</span><br><span class="line">But is it a file?</span><br><span class="line"></span><br><span class="line">Yes, /home/vip5/sentinel is a file.</span><br><span class="line">But is it writable?</span><br><span class="line"></span><br><span class="line">Writing current time to /home/vip5/sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ cat sentinel</span><br><span class="line">Wed Apr 17 15:23:38 CST 2019</span><br><span class="line">2108</span><br></pre></td></tr></table></figure>
<p>变量item_name被设置为$HOME/sentinel，该文件允许用户写入。当脚本运行时，-w测试表达式返回非零退出状态，再执行then代码块，将时间戳写入文件sentinel中。</p>
<p>如果使用chmod关闭文件sentinel的用户写入权限，-w测试表达式会返回非零的退出状态码，时间戳不会被写入文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ chmod u-w sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ls -l sentinel</span><br><span class="line">-r--rw-r-- 1 vip5 vip5 34 Apr 21 21:08 sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ./test/test15.sh </span><br><span class="line"></span><br><span class="line">The item being checked: /home/vip5/sentinel</span><br><span class="line"></span><br><span class="line">The item, /home/vip5/sentinel, does exist.</span><br><span class="line">But is it a file?</span><br><span class="line"></span><br><span class="line">Yes, /home/vip5/sentinel is a file.</span><br><span class="line">But is it writable?</span><br><span class="line"></span><br><span class="line">Unable to write to /home/vip5/sentinel</span><br></pre></td></tr></table></figure>
<h4 id="4-3-7-检查文件是否可以执行"><a href="#4-3-7-检查文件是否可以执行" class="headerlink" title="4.3.7 检查文件是否可以执行"></a>4.3.7 检查文件是否可以执行</h4><p>-x比较是判断特定文件是否有执行权限的一个简单方法。当在shell脚本中运行大量脚本，它就能发挥作用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test16.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing file execution</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -x test16.sh ]</span><br><span class="line">then</span><br><span class="line">   echo "You can run the script: "</span><br><span class="line">   ./test16.sh</span><br><span class="line">else </span><br><span class="line">   echo "Sorry, you are unable to execute the script"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test16.sh</span><br><span class="line">You can run the script: </span><br><span class="line"></span><br><span class="line">The item being checked: /home/vip5/sentinel</span><br><span class="line"></span><br><span class="line">The item, /home/vip5/sentinel, does exist.</span><br><span class="line">But is it a file?</span><br><span class="line"></span><br><span class="line">Yes, /home/vip5/sentinel is a file.</span><br><span class="line">But is it writable?</span><br><span class="line"></span><br><span class="line">Unable to write to /home/vip5/sentinel</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u-x test15.sh</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test16.sh </span><br><span class="line">Sorry, you are unable to execute the script</span><br></pre></td></tr></table></figure>
<h4 id="4-3-8-检查所属关系"><a href="#4-3-8-检查所属关系" class="headerlink" title="4.3.8 检查所属关系"></a>4.3.8 检查所属关系</h4><p>-O比较可以测试出你是否是文件的属主。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test17.sh</span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> check file ownership</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -O /etc/passwd ]</span><br><span class="line">then </span><br><span class="line">   echo "You are the owner of the /etc/passwd file"</span><br><span class="line">else</span><br><span class="line">   echo "Sorry, you are not the owner of the /etc/passwd file"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test17.sh</span><br><span class="line">Sorry, you are not the owner of the /etc/passwd file</span><br></pre></td></tr></table></figure>
<h4 id="4-3-9-检查默认属组关系"><a href="#4-3-9-检查默认属组关系" class="headerlink" title="4.3.9 检查默认属组关系"></a>4.3.9 检查默认属组关系</h4><p>-G比较会检查文件的默认组，如果它匹配了用户的默认组，则测试成功。且-G比较只会检查默认组而非用户所属的所有组。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test19.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> check file group test</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -G $HOME/test ]</span><br><span class="line">then </span><br><span class="line">   echo "You are in the same group as the file"</span><br><span class="line">else </span><br><span class="line">   echo "The file is not owned by your group"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l $HOME/test</span><br><span class="line">total 144</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5    51 Jan  3 22:59 file1.gz</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5    71 Jan  3 23:05 file3.gz</span><br><span class="line">[...]</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test19.sh </span><br><span class="line">You are in the same group as the file</span><br></pre></td></tr></table></figure>
<p>$HOME/test文件夹属于vip5组，所以通过了-G比较。但使用chgrp命令改变组时，-G比较会失败，因为它只比较默认组。</p>
<h4 id="4-3-10-检查文件日期"><a href="#4-3-10-检查文件日期" class="headerlink" title="4.3.10 检查文件日期"></a>4.3.10 检查文件日期</h4><p>对两个文件的创建日期进行比较，在编写软件安装脚本时非常有用。-nt比较会判定一个文件是否比另一个文件新。-ot比较会判定一个文件是否比另一个文件旧。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test20.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing file dates</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ test19.sh -nt test17.sh ]</span><br><span class="line">then </span><br><span class="line">   echo "The test19 file is newer than test18"</span><br><span class="line">else </span><br><span class="line">   echo "The test18 file is newer than test19"</span><br><span class="line">fi</span><br><span class="line">if [ test16.sh -ot test19.sh ]</span><br><span class="line">then </span><br><span class="line">   echo "The test16 file is older than the test19 file"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test20.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test20.sh </span><br><span class="line">The test19 file is newer than test18</span><br><span class="line">The test16 file is older than the test19 file</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test16.sh test19.sh test20.sh</span><br><span class="line">-rwxrw-r-- 1 vip5 vip5 177 Apr 21 21:27 test16.sh</span><br><span class="line">-rwxrw-r-- 1 vip5 vip5 168 May  3 20:46 test19.sh</span><br><span class="line">-rwxrw-r-- 1 vip5 vip5 271 May  3 21:02 test20.sh</span><br></pre></td></tr></table></figure>
<p>用于比较文件路径是相对你运行脚本的目录而言的。如果要检查的文件已经被移走，就会出现问题。另一个问题是，这些比较不会检查文件是否存在。所以，在使用-nt或者-ot比较文件之前，必须先确认文件是存在的。</p>
<h2 id="5-复合条件测试"><a href="#5-复合条件测试" class="headerlink" title="5 复合条件测试"></a>5 复合条件测试</h2><p>if-then语句允许使用布尔逻辑来组合测试（布尔逻辑是将可能的返回值简化为TRUE或FALSE的方法)。有两种布尔运算符可用：</p>
<ul>
<li>[ condition1 ] &amp;&amp; [ condition2 ]</li>
<li>[ condition1 ] || [ condition2 ]</li>
</ul>
<p>第一种使用AND布尔运算来组和两个条件。要让then部分的命令执行，两个条件都必须满足。</p>
<p>第二种布尔运算使用OR布尔运算符来组和两个条件。如果任意条件为TRUE，then部分的命令就会执行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test22.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> testing compound comparisons</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [ -d $HOME ] &amp;&amp; [ -w $HOME/test ]</span><br><span class="line">then </span><br><span class="line">   echo "The file exists and you can write to it"</span><br><span class="line">else </span><br><span class="line">   echo "I cannot write to the file"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ vip5@VM-0-15-ubuntu:~/test$ </span><br><span class="line">-bash: vip5@VM-0-15-ubuntu:~/test$: No such file or directory</span><br></pre></td></tr></table></figure>
<h2 id="6-if-then的高级特性"><a href="#6-if-then的高级特性" class="headerlink" title="6 if-then的高级特性"></a>6 if-then的高级特性</h2><p>bash shell提供了两项可在if-then语句中使用的高级特性：</p>
<ul>
<li>用于数学表达式的双括号</li>
<li>用于高级字符串处理功能的双方括号</li>
</ul>
<h3 id="6-1-使用双括号"><a href="#6-1-使用双括号" class="headerlink" title="6.1 使用双括号"></a>6.1 使用双括号</h3><p>双括号命令允许在比较过程中使用高级数学表达式。test命令只能在比较中使用简单的算术操作。双括号命令提供了更多的数学符号。格式：</p>
<p><code>(( expression ))</code></p>
<p>双括号命令中会用到的运算符如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:left">描述？</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">val++</td>
<td style="text-align:left">后增</td>
</tr>
<tr>
<td style="text-align:center">val- -</td>
<td style="text-align:left">后减</td>
</tr>
<tr>
<td style="text-align:center">++val</td>
<td style="text-align:left">先增</td>
</tr>
<tr>
<td style="text-align:center">- -val</td>
<td style="text-align:left">后减</td>
</tr>
<tr>
<td style="text-align:center">！</td>
<td style="text-align:left">逻辑求反</td>
</tr>
<tr>
<td style="text-align:center">~</td>
<td style="text-align:left">位求反</td>
</tr>
<tr>
<td style="text-align:center">**</td>
<td style="text-align:left">幂运算</td>
</tr>
<tr>
<td style="text-align:center">&lt;&lt;</td>
<td style="text-align:left">左位移</td>
</tr>
<tr>
<td style="text-align:center">>&gt;</td>
<td style="text-align:left">右位移</td>
</tr>
<tr>
<td style="text-align:center">&amp;</td>
<td style="text-align:left">位布尔和</td>
</tr>
<tr>
<td style="text-align:center">l</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:center">&amp;&amp;</td>
<td style="text-align:left">逻辑和</td>
</tr>
<tr>
<td style="text-align:center">ll</td>
</tr>
</tbody>
</table>
<p>可以在if语句中使用双括号命令，也可以在脚本中的普通命令里使用来赋值。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test23.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> using double parenthesis</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">val1=10 </span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if (( $val1 ** 2 ))</span><br><span class="line">then </span><br><span class="line">   (( val2 = $val1 ** 2 ))</span><br><span class="line">   echo "The square of $val1 is $val2"</span><br><span class="line">fi</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test23.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test23.sh </span><br><span class="line">The square of 10 is 100</span><br></pre></td></tr></table></figure>
<p>注意，双括号中表达式里的大于号不用转义。</p>
<h3 id="6-2-使用双方括号"><a href="#6-2-使用双方括号" class="headerlink" title="6.2 使用双方括号"></a>6.2 使用双方括号</h3><p>双方括号命令提供了字符串比较的高级特性，还提供了test命令未提供的特性——模式匹配。格式：</p>
<p><code>[[ expression ]]</code></p>
<p>在模式匹配中，可以定义一个正则表达式来匹配字符值。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat test24.sh </span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> using pattern matching</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">if [[ $USER == v* ]]</span><br><span class="line">then </span><br><span class="line">   echo "Hello $USER"</span><br><span class="line">else </span><br><span class="line">   echo "Sorry, I do not know you"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ chmod u+x test24.sh </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ./test24.sh </span><br><span class="line">Hello vip5</span><br></pre></td></tr></table></figure>
<h2 id="7-case命令"><a href="#7-case命令" class="headerlink" title="7 case命令"></a>7 case命令</h2><p>在尝试计算一个变量的值，在一组可能的值中寻找特定值时，会写出很长的if-then-else语句。其中elif语句继续if-then检查，为比较变量寻找特定的值。</p>
<p>有了case命令，就不需要写出所有的elif语句来不停地检查同一个变量的值了。case命令会采用列表格式来检查单个变量的多个值。</p>
<p><code>case variable in</code></p>
<p><code>pattern1 | pattern2) command1;;</code></p>
<p><code>pattern3) command2;;</code></p>
<p><code>*) default commands;;</code></p>
<p><code>esac</code></p>
<p>case命令会将指定的变量与不同模式进行比较。如果变量和模式是匹配的，那么shell会执行为该模式指定的命令。可以通过竖线操作符在一行中分割出多个模式。星号会捕获所有与已知模式不匹配的值。一个例子：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> cat test26.sh</span><br><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line"><span class="meta">#</span> using the case command</span><br><span class="line"><span class="meta">#</span></span><br><span class="line">case $USER in</span><br><span class="line">rich | barbara)</span><br><span class="line">echo "Welcome, $USER"</span><br><span class="line">echo "Please enjoy your visit";;</span><br><span class="line">testing)</span><br><span class="line">echo "Special testing account";;</span><br><span class="line">jessica)</span><br><span class="line">echo "Do not forget to log off when you're done";;</span><br><span class="line">*)</span><br><span class="line">echo "Sorry, you are not allowed here";;</span><br><span class="line">esac</span><br><span class="line"><span class="meta">$</span></span><br><span class="line"><span class="meta">$</span> ./test26.sh</span><br><span class="line">Welcome, rich</span><br><span class="line">Please enjoy your visit</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cldiao.github.io/2019/04/13/Linux命令行与shell脚本编程学习第十二章/" data-id="cjv87jnd8000do0mvlbealfud" class="article-share-link">Share</a>
      
<section id="comments">
<!-- 多说评论框 start -->
  <div class="ds-thread" data-thread-key="2019/04/13/Linux命令行与shell脚本编程学习第十二章/" data-title="Linux命令行与shell脚本编程学习第十二章" data-url=""></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"chaooo"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end -->
</section>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux，shell-bash/">Linux，shell, bash</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/04/07/Linux命令行与shell脚本编程学习第十一章/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Linux命令行与shell脚本编程学习第十一章</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/GEO/" style="font-size: 10px;">GEO</a> <a href="/tags/GSEA/" style="font-size: 10px;">GSEA</a> <a href="/tags/GSEA/" style="font-size: 10px;">GSEA,</a> <a href="/tags/LINUX-VMware-RNA-Seq-R/" style="font-size: 10px;">LINUX, VMware, RNA-Seq, R</a> <a href="/tags/Linux-shell-bash/" style="font-size: 20px;">Linux, shell, bash</a> <a href="/tags/Linux，shell-bash/" style="font-size: 10px;">Linux，shell, bash</a> <a href="/tags/Mac-office-Vmware-fusion-Ps，Adobe/" style="font-size: 10px;">Mac, office, Vmware fusion, Ps，Adobe</a> <a href="/tags/Pubmed-R-visualization/" style="font-size: 10px;">Pubmed, R, visualization</a> <a href="/tags/R-表达矩阵，heatmap-PCA-T检验，火山图，ID转换/" style="font-size: 10px;">R, 表达矩阵，heatmap, PCA, T检验，火山图，ID转换</a> <a href="/tags/R2-database-correlation/" style="font-size: 10px;">R2, database, correlation</a> <a href="/tags/RNA-Seq/" style="font-size: 10px;">RNA-Seq</a> <a href="/tags/SP-FCAS/" style="font-size: 10px;">SP, FCAS</a> <a href="/tags/TFBS/" style="font-size: 10px;">TFBS</a> <a href="/tags/blog-hexo-github/" style="font-size: 10px;">blog,hexo,github</a> <a href="/tags/linux-shell-bash/" style="font-size: 15px;">linux, shell, bash</a> <a href="/tags/lipoplex/" style="font-size: 10px;">lipoplex</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/scholar-IF-publications/" style="font-size: 10px;">scholar, IF, publications</a> <a href="/tags/windows10-activation/" style="font-size: 10px;">windows10, activation</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/04/13/Linux命令行与shell脚本编程学习第十二章/">Linux命令行与shell脚本编程学习第十二章</a>
          </li>
        
          <li>
            <a href="/2019/04/07/Linux命令行与shell脚本编程学习第十一章/">Linux命令行与shell脚本编程学习第十一章</a>
          </li>
        
          <li>
            <a href="/2019/04/06/Linux命令行与shell脚本编程学习第十章/">Linux命令行与shell脚本编程学习第十章</a>
          </li>
        
          <li>
            <a href="/2019/04/05/Linux命令行与shell脚本编程学习第九章/">Linux命令行与shell脚本编程学习第九章</a>
          </li>
        
          <li>
            <a href="/2019/04/03/Linux命令行与shell脚本编程大全学习第六章/">Linux命令行与shell脚本编程学习第六章</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Chaoliang Diao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>