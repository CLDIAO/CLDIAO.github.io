<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Rumble&#39;s blog</title>
  
  <subtitle>Stay hungry, stay foolish.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://cldiao.github.io/"/>
  <updated>2019-04-06T13:33:50.580Z</updated>
  <id>https://cldiao.github.io/</id>
  
  <author>
    <name>Chaoliang Diao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Linux命令行与shell脚本编程学习第十章</title>
    <link href="https://cldiao.github.io/2019/04/06/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%AC%E5%8D%81%E7%AB%A0/"/>
    <id>https://cldiao.github.io/2019/04/06/Linux命令行与shell脚本编程学习第十章/</id>
    <published>2019-04-06T07:53:53.000Z</published>
    <updated>2019-04-06T13:33:50.580Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用编辑器"><a href="#使用编辑器" class="headerlink" title="使用编辑器"></a>使用编辑器</h1><p>进行shell脚本编程，需要指导Linux中至少一款文本编辑器的用法。<a id="more"></a></p><h2 id="1-vim文本编辑器"><a href="#1-vim文本编辑器" class="headerlink" title="1. vim文本编辑器"></a>1. vim文本编辑器</h2><h3 id="1-vim基础"><a href="#1-vim基础" class="headerlink" title="1. vim基础"></a>1. vim基础</h3><p>vim编辑器在内存缓冲区中处理数据，只要键入vim命令和要编辑的文件的名字就可以启动vim编辑器；若未指定文件或者文件不存在，vim会开辟新的缓冲区域来编辑。底部的消息行根据文件的状态和vim安装时的默认设置显示所编辑的文件的信息。</p><p>vim编辑器有两种操作模式：普通模式和插入模式。当打开要编辑的文件时，vim编辑器进入普通模式，按键为输入命令；按下i键进入插入模式进行编辑。推出插入模式，按下ESC键。</p><p>普通模式下，方向键在文本区域移动光标。vim中也有用来移动光标的命令：</p><p>h：左移一个字符；</p><p>j：下移一行；</p><p>k：上移一行；</p><p>l：右移一个字符；</p><p>ctrl+f：下一屏；</p><p>ctrl+b：上一屏；</p><p>G：移动到缓冲区最后一行；</p><p>gg：移动到缓冲区的第一行；</p><p>vim编辑器在普通模式下键入：，进入命令行模式，输入命令。几个命令可以将缓冲区的数据保存到文件中并退出：</p><p>q：如果未修改缓冲区数据，退出；</p><p>q!：取消所有对缓冲区数据的修改并退出；</p><p>w <em>filename</em> ：将文件保存到另一个文件中；</p><p>wq：将缓冲区数据保存到文件并退出。</p><h3 id="2-编辑数据"><a href="#2-编辑数据" class="headerlink" title="2. 编辑数据"></a>2. 编辑数据</h3><p>插入模式下，可以向缓冲区插入数据。数据输入到缓冲区后，需要再进行添加或删除。普通模式下，vim有些命令可以编辑缓冲区的数据。</p><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">x</td><td style="text-align:left">删除当前光标所在位置的字符</td></tr><tr><td style="text-align:left">dd</td><td style="text-align:left">删除当前光标所在行</td></tr><tr><td style="text-align:left">dw</td><td style="text-align:left">删除当前光标所在位置的单词</td></tr><tr><td style="text-align:left">d$</td><td style="text-align:left">删除当前光标所在位置至行尾的内容</td></tr><tr><td style="text-align:left">J</td><td style="text-align:left">删除当前光标所在行行尾的换行符</td></tr><tr><td style="text-align:left">u</td><td style="text-align:left">撤销前一编辑命令</td></tr><tr><td style="text-align:left">a</td><td style="text-align:left">在当前光标后追加数据</td></tr><tr><td style="text-align:left">A</td><td style="text-align:left">在当前光标所在行行尾追加数据</td></tr><tr><td style="text-align:left">r <em>char</em></td><td style="text-align:left">用<em>char</em>替换当前光标所在位置的单个词符</td></tr><tr><td style="text-align:left">R <em>text</em></td><td style="text-align:left">用<em>text</em>覆盖当前所在位置的数据，直到按下ESC键</td></tr></tbody></table><h3 id="3-复制和粘贴"><a href="#3-复制和粘贴" class="headerlink" title="3.复制和粘贴"></a>3.复制和粘贴</h3><p>剪切和粘贴相对容易。上述删除命令删除数据时，数据会被保存在单独的寄存器中，用p命令取回数据。</p><p>复制文本要稍复杂。复制的命令是y。在y后面使用和d命令相同的第二字符。在复制文本后，把光标移到想放置文本的地方，输入p。复杂之处在于不确定复制了什么，知道粘贴后才能明白。但可视模式会在移动光标时高亮显示文本。进入可视模式，应移动光标到开始复制的位置，按下v键。下一步，移动光标覆盖想要复制的文本。按y键复制。移动光标到想要复制的位置，使用p命令来粘贴。</p><h3 id="4-查找和替换"><a href="#4-查找和替换" class="headerlink" title="4. 查找和替换"></a>4. 查找和替换</h3><p>要输入一个查找字符串，就按下斜线（/）键。光标会到消息行，vim显示出斜线。输入要查找的文本后，按下回车键。vim编辑器有三种回应：</p><ul><li>如果要查找的文本在光标当前位置之后，则光标跳到该文本出现的第一个位置</li><li>如果要查找的文本未在光标当前位置之后出现，则光标出现在该文本的第一个位置</li><li>输出一条错误消息，说明文件中没有找到要查找的文本</li></ul><p>要查找同一个单词，按/键，再按回车键。或者使用n键。</p><p>替换命令需要进入命令行模式才能使用。格式是<code>:s/old/new/</code>。修改后可以替换多处文本。</p><ul><li><code>:s/old/new/g</code> ：一行命令替换所有old</li><li><code>:n,ms/old/new/g</code> ：替换行号n和m之间所有old</li><li><code>:%s/old/new/g</code> ：替换整个文件中的所有old</li><li><code>:%s/old/new/gc</code> ：替换整个文件中的所有old，但每次出现时提示</li></ul><h2 id="2-nano文本编辑器"><a href="#2-nano文本编辑器" class="headerlink" title="2. nano文本编辑器"></a>2. nano文本编辑器</h2><p>nano编辑器简单易用。命令行键入nano打开文件。没有指定文件名时，或者指定的文件不存在，nano会开辟新的缓冲区进行编辑。若指定了已有的文件，nano会将该文件的全部内容读入缓冲区。</p><p>nano编辑器的窗口底部显示了各种命令及简要描述。^表示ctrl键。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;使用编辑器&quot;&gt;&lt;a href=&quot;#使用编辑器&quot; class=&quot;headerlink&quot; title=&quot;使用编辑器&quot;&gt;&lt;/a&gt;使用编辑器&lt;/h1&gt;&lt;p&gt;进行shell脚本编程，需要指导Linux中至少一款文本编辑器的用法。
    
    </summary>
    
    
      <category term="Linux, shell, bash" scheme="https://cldiao.github.io/tags/Linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行与shell脚本编程学习第九章</title>
    <link href="https://cldiao.github.io/2019/04/05/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B9%9D%E7%AB%A0/"/>
    <id>https://cldiao.github.io/2019/04/05/Linux命令行与shell脚本编程学习第九章/</id>
    <published>2019-04-05T09:26:05.000Z</published>
    <updated>2019-04-06T07:52:54.900Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装软件程序"><a href="#安装软件程序" class="headerlink" title="安装软件程序"></a>安装软件程序</h1><p>Linux上有各种包管理系统（PMS），以及用来进行软件安装、管理和删除的命令行工具。<a id="more"></a></p><h2 id="1-包管理基础"><a href="#1-包管理基础" class="headerlink" title="1. 包管理基础"></a>1. 包管理基础</h2><p>PMS利用数据库来记录各种软件和库的相关内容：系统已安装了什么软件包；每个包安装了什么文件；每个已安装软件包的版本。Linux中广泛使用的两种主要的PMS基础工具是dpkg和rpm。</p><p>基于Debian的发行版（如Ubuntu）使用的是dpkg命令。dpkg会直接和Linux系统上的PMS交互，用来安装、管理和删除软件包。</p><h2 id="2-基于Debian的系统"><a href="#2-基于Debian的系统" class="headerlink" title="2.基于Debian的系统"></a>2.基于Debian的系统</h2><p>包含在dpkg这个PMS中的其他工具有：apt-get，apt-cache，aptitude。最常用的命令行工具是aptitude，dpkg是软件包管理系统工具，aptitude是完整的软件包管理系统。命令行下使用aptitude命令有助于比避免常见的软件安装问题，如依赖关系缺失、系统环境不稳定及其它不必要的麻烦。</p><h3 id="2-1-用aptitude管理软件包"><a href="#2-1-用aptitude管理软件包" class="headerlink" title="2.1 用aptitude管理软件包"></a>2.1 用aptitude管理软件包</h3><p>如果Linux版本中已经安装了aptitude，只需在shell提示符键入aptitude并按下回车就行。接着会进入aptitude的全屏模式。但学习用的服务器没有安装aptitude，这节留白。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ aptitude</span><br><span class="line">The program 'aptitude' is currently not installed. To run 'aptitude' please ask your administrator to install the package 'aptitude'</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><h3 id="2-2-用aptitude安装软件包"><a href="#2-2-用aptitude安装软件包" class="headerlink" title="2.2 用aptitude安装软件包"></a>2.2 用aptitude安装软件包</h3><h3 id="2-3-用aptitude更新软件"><a href="#2-3-用aptitude更新软件" class="headerlink" title="2.3 用aptitude更新软件"></a>2.3 用aptitude更新软件</h3><h3 id="2-4-用aptitude卸载软件"><a href="#2-4-用aptitude卸载软件" class="headerlink" title="2.4 用aptitude卸载软件"></a>2.4 用aptitude卸载软件</h3><h3 id="2-5-aptitude仓库"><a href="#2-5-aptitude仓库" class="headerlink" title="2.5 aptitude仓库"></a>2.5 aptitude仓库</h3><h2 id="3-从源码安装"><a href="#3-从源码安装" class="headerlink" title="3. 从源码安装"></a>3. 从源码安装</h2><p>前面了解了通过tar命令行命令进行创建和解包。这里进一步了解其中过程。我们以软件包sysstat为例，它提供各种系统监测工具，非常好用。下载，解包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ wget http://pagesperso-orange.fr/sebastien.godard/sysstat-12.1.3.tar.gz</span><br><span class="line">--2019-04-06 15:20:43--  http://pagesperso-orange.fr/sebastien.godard/sysstat-12.1.3.tar.gz</span><br><span class="line">[...]</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ ls</span><br><span class="line">anaconda  bowtie2-2.3.4.3-source.zip  test</span><br><span class="line">bowtie    sysstat-12.1.3.tar.gz       test_one</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ tar -zxvf sysstat-12.1.3.tar.gz </span><br><span class="line">sysstat-12.1.3/</span><br><span class="line">sysstat-12.1.3/cifsiostat.c</span><br><span class="line">sysstat-12.1.3/version.in</span><br><span class="line">[...]</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ ls</span><br><span class="line">anaconda  bowtie2-2.3.4.3-source.zip  sysstat-12.1.3.tar.gz  test_one</span><br><span class="line">bowtie    sysstat-12.1.3              test</span><br></pre></td></tr></table></figure><p>解包完成后，所有文件放到了sysstat-12.1.3的目录中。查看目录的内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ cd sysstat-12.1.3/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/sysstat-12.1.3$ ls</span><br><span class="line">activity.c    images        rd_sensors.c  svg_stats.c</span><br><span class="line">BUG_REPORT    INSTALL       rd_sensors.h  svg_stats.h</span><br><span class="line">build         ioconf.c      rd_stats.c    sysconfig.in</span><br><span class="line">CHANGES       ioconf.h      rd_stats.h    sysstat-12.1.3.lsm</span><br><span class="line">cifsiostat.c  iostat.c      README.md     sysstat-12.1.3.spec</span><br><span class="line">cifsiostat.h  iostat.h      rndr_stats.c  sysstat.in</span><br><span class="line">common.c      json_stats.c  rndr_stats.h  sysstat.ioconf</span><br><span class="line">common.h      json_stats.h  sa1.in        sysstat.service.in</span><br><span class="line">configure     Makefile.in   sa2.in        sysstat.sysconfig.in</span><br><span class="line">configure.in  man           sa_common.c   tapestat.c</span><br><span class="line">contrib       mpstat.c      sa_conv.c     tapestat.h</span><br><span class="line">COPYING       mpstat.h      sa_conv.h     tests</span><br><span class="line">count.c       nls           sadc.c        version.in</span><br><span class="line">count.h       pidstat.c     sadf.c        xml</span><br><span class="line">CREDITS       pidstat.h     sadf.h        xml_stats.c</span><br><span class="line">cron          pr_stats.c    sadf_misc.c   xml_stats.h</span><br><span class="line">FAQ.md        pr_stats.h    sa.h</span><br><span class="line">format.c      raw_stats.c   sar.c</span><br><span class="line">iconfig       raw_stats.h   sa_wrap.c</span><br></pre></td></tr></table></figure><p>按照README文件中的建议进行配置susstat。make步骤进行编译。若要将它安装到Linux系统中常用的位置上，需要root用户身份登录，然后用make install命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/sysstat-12.1.3$ ./configure</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/sysstat-12.1.3$ make</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/sysstat-12.1.3$ make install</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;安装软件程序&quot;&gt;&lt;a href=&quot;#安装软件程序&quot; class=&quot;headerlink&quot; title=&quot;安装软件程序&quot;&gt;&lt;/a&gt;安装软件程序&lt;/h1&gt;&lt;p&gt;Linux上有各种包管理系统（PMS），以及用来进行软件安装、管理和删除的命令行工具。
    
    </summary>
    
    
      <category term="Linux, shell, bash" scheme="https://cldiao.github.io/tags/Linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行与shell脚本编程学习第六章</title>
    <link href="https://cldiao.github.io/2019/04/03/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%A4%A7%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%AC%E5%85%AD%E7%AB%A0/"/>
    <id>https://cldiao.github.io/2019/04/03/Linux命令行与shell脚本编程大全学习第六章/</id>
    <published>2019-04-03T12:05:03.000Z</published>
    <updated>2019-04-06T06:41:50.834Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用Linux环境变量"><a href="#使用Linux环境变量" class="headerlink" title="使用Linux环境变量"></a>使用Linux环境变量</h1><p>Linux环境变量，我们需要了解：它们存储在哪里，怎样使用，以及怎样创建自己的环境变量。<a id="more"></a></p><h2 id="1-什么是环境变量"><a href="#1-什么是环境变量" class="headerlink" title="1. 什么是环境变量"></a>1. 什么是环境变量</h2><p>bash shell用一个叫做环境变量（environment variable）的特性来存储有关shell会话和工作环境的信息。这项特性允许你在内存中存储数据，以便程序或shell中运行的脚本能够轻松访问到它们。这也是存储持久数据的一种方法。环境变量分为两种：全局变量和局部变量。</p><h3 id="1-1-全局环境变量"><a href="#1-1-全局环境变量" class="headerlink" title="1.1 全局环境变量"></a>1.1 全局环境变量</h3><p>全局环境变量对于shell会话和所生成的子shell都是可见的。局部变量只对创建他们的shell可见.系统环境变量基本上都是使用全大写字母,以区别普通用户的环境变量。要查看全局变量,可以使用env或printenv命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ printenv</span><br><span class="line">XDG_SESSION_ID=236714</span><br><span class="line">TERM=xterm</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">HISTSIZE=3000</span><br><span class="line">SSH_CLIENT=59.46.158.67 4042 22</span><br><span class="line">SSH_TTY=/dev/pts/0</span><br><span class="line">USER=vip5</span><br><span class="line">MAIL=/var/mail/vip5</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">PWD=/home/vip5</span><br><span class="line">LANG=en_US.utf8</span><br><span class="line">SHLVL=1</span><br><span class="line">HOME=/home/vip5</span><br><span class="line">LOGNAME=vip5</span><br><span class="line">SSH_CONNECTION=59.46.158.67 4042 172.30.0.15 22</span><br><span class="line">PROMPT_COMMAND=history -a; </span><br><span class="line">XDG_RUNTIME_DIR=/run/user/1009</span><br><span class="line">HISTTIMEFORMAT=%F %T </span><br><span class="line">_=/usr/bin/printenv</span><br></pre></td></tr></table></figure><p>系统为bash shell设置的全局环境变量数目众多。很多是在登录过程中设置的，另外，登陆方式也会影响所设置的环境变量。查看个别环境变量的值，可以使用printenv命令，但不要使用env命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ printenv HOME</span><br><span class="line">/home/vip5</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ env HOME</span><br><span class="line">env: ‘HOME’: No such file or directory</span><br></pre></td></tr></table></figure><p>也可以使用echo显示变量的值。这种情况下引用某个环境变量的时候，必须在变量前面加$。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ echo $HOME</span><br><span class="line">/home/vip5</span><br></pre></td></tr></table></figure><p>变量名前加$不仅可以显示变量当前的值。它能够作为命令行参数。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls $HOME</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ls /home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br></pre></td></tr></table></figure><p>全局变量可用于进程的所有子shell。在下面的例子中，bash命令生成一个子shell后，显示了HOME环境变量的当前值，这个值和父shell中是一样的。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5      4174 27158  0 20:36 pts/0    00:00:00 bash</span><br><span class="line">vip5      4242  4174  0 20:36 pts/0    00:00:00 ps -f</span><br><span class="line">vip5     27158 27147  0 20:25 pts/0    00:00:00 -bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $HOME</span><br><span class="line">/home/vip5</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><h3 id="1-2-局部环境变量"><a href="#1-2-局部环境变量" class="headerlink" title="1.2 局部环境变量"></a>1.2 局部环境变量</h3><p>局部环境变量只能在定义它们的进程中可见，但和全局环境变量一样重要。Linux中没有一个只显示局部变量的命令。set命令会显示为某个特定进程设置的所有环境变量，包括局部变量、全局变量以及用户自定义的变量。通过printenv命令看到的全局变量都出现在了set命令的输出中。</p><h2 id="2-设置用户定义变量"><a href="#2-设置用户定义变量" class="headerlink" title="2.设置用户定义变量"></a>2.设置用户定义变量</h2><p>bash shell中可以直接设置自己的变量。那么怎样在交互式shell或者shell脚本程序中创建自己的变量并引用它们。</p><h3 id="2-1-设置局部用户自定义变量"><a href="#2-1-设置局部用户自定义变量" class="headerlink" title="2.1 设置局部用户自定义变量"></a>2.1 设置局部用户自定义变量</h3><p>一旦启动了bash shell，就能创建在这个shell进程内可见的局部变量了。可以通过等号给环境变量赋值，值可以是数值或者字符串。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable=Hello</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">Hello</span><br></pre></td></tr></table></figure><p>如果要给变量赋一个含空格的字符串值，必须用引号界定字符串的首和尾。变量名、等号和值之间没有空格，否则值会被当做单独的命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable=Hello World</span><br><span class="line">World: command not found</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="Hello World"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">Hello World</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable='Hello World'</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">Hello World</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable</span><br><span class="line">my_variable:: command not found</span><br></pre></td></tr></table></figure><p>设置了局部环境变量后，可以在shell进程任何地方使用它，但如果生成了另一个shell，它在子shell中不可用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable='Hello World'</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable Hello World</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>如上，在子shell中无法使用用户定义变量my_variable。当推出子shell回到原来的shell时，局部环境变量依然可用。类似的，在子shell中设置了局部环境变量，退出子进程，那个局部环境变量就不可用。</p><h3 id="2-2-设置全局环境变量"><a href="#2-2-设置全局环境变量" class="headerlink" title="2.2 设置全局环境变量"></a>2.2 设置全局环境变量</h3><p>在设定全局环境变量的进程所创建的子进程中，该变量都是可见的。创建全局环境变量的方法时先创建一个局部环境变量，再把它导出到全局环境中。这个过程需要export命令来完成，变量名前不加$。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="I am Global now"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ export my_variable</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>定义并到处局部环境变量my_variable后，bash命令启动了一个子shell。在这个子shell中能够正确的显示出变量my_variable的值，因为export命令使其变成了全局环境变量。修改子shell中全局环境变量并不会影响到父shell中该变量的值。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="I am Global now"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ export my_variable</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="Null"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>在定义并导出变量my_variable后，bash命令启动了一个子shell。这个子shell可正确显示出全局环境便令my_variable的值。子shell随后改变了这个变量的值。但是这种改变仅在子shell中有效，不会反映到父shell中。子shell甚至无法使用export命令改变父shell中全局环境变量的值。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="I am Global now"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ export my_variable</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="Null"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ export my_variable</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">Null</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br></pre></td></tr></table></figure><h2 id="3-删除环境变量"><a href="#3-删除环境变量" class="headerlink" title="3. 删除环境变量"></a>3. 删除环境变量</h2><p>使用unset命令来删除已经存在的环境变量。在unset命令中引用环境变量时，不要使用$。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ my_variable="I am Global now"</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line">I am Global now</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ unset my_variable </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><blockquote><p>涉及到环境便令名时，如果要用变量，使用$,如果要操作变量，不适用$。</p><p>在子shell中删除全局环境变量，只对子shell进程有效，无法反映到父shell中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ my_variable="I am Global now"</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ export my_variable</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line"><span class="meta">&gt;</span> I am Global now</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line"><span class="meta">&gt;</span> I am Global now</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ unset my_variable</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ echo $my_variable</span><br><span class="line"><span class="meta">&gt;</span> </span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ exit </span><br><span class="line"><span class="meta">&gt;</span> exit</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ echo $my_variable </span><br><span class="line"><span class="meta">&gt;</span> I am Global now</span><br><span class="line"><span class="meta">&gt;</span> vip5@VM-0-15-ubuntu:~$ </span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p> ​        </p></blockquote><h2 id="4-设置PATH环境变量"><a href="#4-设置PATH环境变量" class="headerlink" title="4. 设置PATH环境变量"></a>4. 设置PATH环境变量</h2><p>当shell命令行界面输入一个外部命令时，shell必须搜索系统来找到对应的程序。PATH环境变量定义了用于进行命令和程序查找的目录。学习所用的Ubuntu系统中，PATH环境变量内容是这样的：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>输出中显示了9个可供shell用来查找命令和程序。PATH中的目录使用冒号分隔。如果命令或者程序的未知没有包括在PATH变量中，若不适用绝对路径的话，shell是没法找到的。当shell找不到指定的命令或程序，会产生一个错误信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ myprog</span><br><span class="line">myprog: command not found</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>所以我们要保证PATH环境变量包含了所有存放应用程序的目录。我们可以把新的搜索目录添加到现有的PATH环境变量中，无需从头定义。只需引用原来的PATH值，冒号间隔，再给这个字符串添加新的目录就行。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ echo $PATH </span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ PATH=$PATH:/home/vip5/biosoft/anaconda/anaconda3/bin</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $PATH </span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/vip5/biosoft/anaconda/anaconda3/bin</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ conda</span><br><span class="line">usage: conda [-h] [-V] command ...</span><br><span class="line"></span><br><span class="line">conda is a tool for managing and deploying applications, environments and packages.</span><br></pre></td></tr></table></figure><p>将目录添加到PATH环境变量之后，可以在虚拟目录结构的任何位置执行程序。也可以将单点符加入PATH环境变量，代表当前目录。</p><p>对PATH变量的修改只能持续到退出或者重启系统。这个效果不能一直持续。后面学习如何永久保持环境变量的修改效果。</p><h2 id="5-定位系统环境变量"><a href="#5-定位系统环境变量" class="headerlink" title="5.定位系统环境变量"></a>5.定位系统环境变量</h2><p>知道了如何修改系统环境变量，也知道了如何创建自己的环境变量，那么如何让环境变量的作用持久化？</p><p>bash shell启动方式有三种</p><h3 id="5-1-登录shell"><a href="#5-1-登录shell" class="headerlink" title="5.1 登录shell"></a>5.1 登录shell</h3><h3 id="5-2-交互式shell进程"><a href="#5-2-交互式shell进程" class="headerlink" title="5.2 交互式shell进程"></a>5.2 交互式shell进程</h3><h3 id="5-3-非交互式shell"><a href="#5-3-非交互式shell" class="headerlink" title="5.3 非交互式shell"></a>5.3 非交互式shell</h3><h3 id="5-4-环境变量持久化"><a href="#5-4-环境变量持久化" class="headerlink" title="5.4 环境变量持久化"></a>5.4 环境变量持久化</h3><p>对全局环境变量来说，更倾向于将新的或修改过的变量设置放在/etc/profile文件中。如果升级了所用的发行版，这个文件会更新，所有定制过的变量设置就没了。最好在/etc/profile.d目录中创建一个.sh结尾的文件。把所有新的或修改过的全局环境变量设置放在这个文件中。</p><p>在多数发行版中，存储个人用户永久性bash shell变量的地方是$HOME/.bashrc文件。</p><p>alias命令设置是不能持久的。可以把自己的alias设置放在$HOME/.bashrc启动文件中，使其效果永久化。</p><h2 id="6-数组变量"><a href="#6-数组变量" class="headerlink" title="6. 数组变量"></a>6. 数组变量</h2><p>环境变量可作为数组使用。数组可以存储多个值，这些值可以单独引用或作为整个数组来使用。</p><p>要给某个环境变量设置多个值，可以把值放在括号里，值与值之间用空格分隔。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ mytest=(one two three four five)</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $mytest </span><br><span class="line">one</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[2]&#125; </span><br><span class="line">three</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[*]&#125; </span><br><span class="line">one two three four five</span><br></pre></td></tr></table></figure><p>要引用一个单独的数组元素，必须用代表它在数组中位置的数值索引值，用方括号括起来。索引值从零开始。要显示整个数组变量，用星号作为通配符放在索引值的位置。</p><p>可以改变某个索引值位置的值。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ mytest[2]=seven</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[*]&#125; </span><br><span class="line">one two seven four five</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>甚至使用unset命令删除某个值或整个数组。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ unset mytest[2]</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[*]&#125; </span><br><span class="line">one two four five</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[2]&#125; </span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;mytest[4]&#125; </span><br><span class="line">five</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ unset mytest </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ echo $&#123;myset[*]&#125;</span><br><span class="line"></span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>数组变量有时会让事情麻烦，不常用。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;使用Linux环境变量&quot;&gt;&lt;a href=&quot;#使用Linux环境变量&quot; class=&quot;headerlink&quot; title=&quot;使用Linux环境变量&quot;&gt;&lt;/a&gt;使用Linux环境变量&lt;/h1&gt;&lt;p&gt;Linux环境变量，我们需要了解：它们存储在哪里，怎样使用，以及怎样创建自己的环境变量。
    
    </summary>
    
    
      <category term="Linux, shell, bash" scheme="https://cldiao.github.io/tags/Linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行与shell脚本编程大全学习第五章</title>
    <link href="https://cldiao.github.io/2019/03/30/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%94%E7%AB%A0/"/>
    <id>https://cldiao.github.io/2019/03/30/Linux命令行与shell脚本编程学习第五章/</id>
    <published>2019-03-30T08:05:13.000Z</published>
    <updated>2019-04-06T06:44:50.408Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第五章-理解shell"><a href="#第五章-理解shell" class="headerlink" title="第五章 理解shell"></a>第五章 理解shell</h1><p>​    通过进一步学习shell进程，将了解如何创建子shell以及父shell与子shell之间的关系。探究各种用于创建子进程的命令和内建命令。<a id="more"></a></p><h2 id="1-shell的类型"><a href="#1-shell的类型" class="headerlink" title="1.shell的类型"></a>1.shell的类型</h2><p>​    系统启动什么样的shell程序取决于个人的用户id配置。在/etc/passwd文件夹中，用户ID记录的第七个字段中列出默认的shell程序。用户登录后，默认的shell程序就会开始运行。</p><p>​    下面的例子中，用户使用bash shell作为默认的shell程序：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ cat /etc/passwd</span><br><span class="line">[...]</span><br><span class="line">vip5:x:1009:1013::/home/vip5:/bin/bash</span><br></pre></td></tr></table></figure><p>​    bash shell程序位于/bin目录中。是一个可执行程序：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -lF /bin/bash</span><br><span class="line">-rwxr-xr-x 1 root root 1037528 May 16  2017 /bin/bash*</span><br></pre></td></tr></table></figure><p>​    默认的交互shell会在用户登录后运行终端时启动。另外还有一个默认shell是/bin/sh，它作为默认的系统shell，用于那些需要启动时使用的shell脚本。在Ubuntu中，默认的系统shell和默认的交互shell并不相同：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -l /bin/sh</span><br><span class="line">lrwxrwxrwx 1 root root 4 Oct 26  2016 /bin/sh -&gt; dash</span><br></pre></td></tr></table></figure><h2 id="2-shell的父子关系"><a href="#2-shell的父子关系" class="headerlink" title="2.shell的父子关系"></a>2.shell的父子关系</h2><p>​    登录终端时所启动的默认的交互shell，是一个父shell。提示符$是父shell提供CLI提示符，等待命令输入。</p><p>​    在CLI提示符后输入/bin/bash命令或其他等效的bash命令时，会创建一个新的shell程序。这个shell程序称为子shell。子shell也有CLI提示符，同样等待命令输入。</p><p>​    当输入bash、生成子shell的时候，我们是看不到的，需要ps命令配合选项-f来使用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5     25481 32086  0 22:01 pts/4    00:00:00 ps -f</span><br><span class="line">vip5     32086 32081  0 13:08 pts/4    00:00:00 -bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5     26590 32086  0 22:03 pts/4    00:00:00 bash</span><br><span class="line">vip5     26658 26590  0 22:03 pts/4    00:00:00 ps -f</span><br><span class="line">vip5     32086 32081  0 13:08 pts/4    00:00:00 -bash</span><br></pre></td></tr></table></figure><p>​    第一次使用ps -f的时候，显示出了两个进程。输入bash命令后，一个子shell出现了。根据PPID，可以发现第二个ps -f是在子shell中执行的。可以看到两个bash shell程序在运行。</p><p>​    生成子shell进程时，只有部分父进程的环境被复制到子shell环境中。这会对包括变量在内的一些东西造成影响。</p><p>​    子shell可以从父shell中创建，也可以从另一个子shell中创建。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5      3943 32086  0 22:15 pts/4    00:00:00 ps -f</span><br><span class="line">vip5     32086 32081  0 13:08 pts/4    00:00:00 -bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps --forest</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">32086 pts/4    00:00:00 bash</span><br><span class="line"> 4018 pts/4    00:00:00  \_ bash</span><br><span class="line"> 4090 pts/4    00:00:00      \_ bash</span><br><span class="line"> 4119 pts/4    00:00:00          \_ bash</span><br><span class="line"> 4229 pts/4    00:00:00              \_ ps</span><br></pre></td></tr></table></figure><p>​    如上，bash命令被输入了三次。创建了三个子shell。ps -forest命令展示了这些子shell间的嵌套结构。</p><p>​    exit命令可以有条不紊地退出子shell。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ exit </span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5      6636 32086  0 22:18 pts/4    00:00:00 ps -f</span><br><span class="line">vip5     32086 32081  0 13:08 pts/4    00:00:00 -bash</span><br></pre></td></tr></table></figure><p>​    exit还可以退出当前终端。</p><h3 id="1-进程列表"><a href="#1-进程列表" class="headerlink" title="1. 进程列表"></a>1. 进程列表</h3><p>​    在一行中指定要依次运行的一系列命令。这可以通过命令列表来实现，只需要在命令之间加入分号（;）。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ pwd; ls; cd /etc; pwd; cd; pwd; ls</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">/etc</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br></pre></td></tr></table></figure><p>​    命令列表要想成为进程列表，这些命令必须包含在括号里。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ (pwd; ls; cd /etc; pwd; cd; pwd; ls)</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">/etc</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br></pre></td></tr></table></figure><p>​    多出来的括号看起来没什么不同，但起到的效果是非同寻常的。括号使得命令列表变成进程列表，生成了一个子shell来执行对应的命令。</p><p>​    要想知道是否生成了子shell，可以借助环境变量命令echo $BASH_SUBSHELL。若返回为0，表明没有子shell。返回1或更大数字，就表明有子shell。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ pwd; ls; cd /etc; pwd; cd; pwd; ls; echo $BASH_SUBSHELL</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">/etc</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">0</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ (pwd; ls; cd /etc; pwd; cd; pwd; ls; echo $BASH_SUBSHELL)</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">/etc</span><br><span class="line">/home/vip5</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>​    在shell脚本中，经常使用子shell进行多进程处理。但会拖慢处理速度。</p><h3 id="2-子shell的用法"><a href="#2-子shell的用法" class="headerlink" title="2. 子shell的用法"></a>2. 子shell的用法</h3><p>​    交互式shell中，一个搞笑的子shell用法就是使用后台模式。</p><h4 id="2-1-探索后台模式"><a href="#2-1-探索后台模式" class="headerlink" title="2.1. 探索后台模式"></a>2.1. 探索后台模式</h4><p>​    后台模式中运行命令可以在处理命令的同时让出CLI，演示后台模式的经典命令就是sleep。</p><p>​    sleep命令接受一个参数是进程等待的秒数。命令sleep 5会将会话暂停5秒钟，然后返回shell CLI提示符。要想将命令置入后台模式，在命令末尾加上&amp;。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ sleep 100&amp;</span><br><span class="line">[1] 28503</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5     28503 32086  0 22:44 pts/4    00:00:00 sleep 100</span><br><span class="line">vip5     28599 32086  0 22:44 pts/4    00:00:00 ps -f</span><br><span class="line">vip5     32086 32081  0 13:08 pts/4    00:00:00 -bash</span><br></pre></td></tr></table></figure><p>​    当命令被置入后台，CLI提示符返回之前，出现两条信息。一个条是后台作业号[1]，第二条是后台作业的进程ID(28503)。</p><p>​    除了ps命令，还可以使用jobs命令来显示后台作业信息。-l 参数可以显示命令的PID。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ jobs -l</span><br><span class="line">[1]+   689 Running                 sleep 1000 &amp;</span><br></pre></td></tr></table></figure><p>​    jobs命令显示了作业号，当前状态，及对应的命令。</p><h4 id="2-2-将进程列表置入后台"><a href="#2-2-将进程列表置入后台" class="headerlink" title="2.2. 将进程列表置入后台"></a>2.2. 将进程列表置入后台</h4><p>​    使用包含sleep命令的进程列表，并显示出变量BASH_SUBSHELL。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ (sleep 2; echo $BASH_SUBSHELL; sleep 2)</span><br><span class="line">1</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    上面的例子中，有一个2秒的暂停，显示数字1表明只有一个子进程，在返回提示符前又经历一个2秒的暂停。但相同的进程列表置入后台会在命令输出上表现出些许不同。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ (sleep 2; echo $BASH_SUBSHELL; sleep 2)&amp;</span><br><span class="line">[1] 16283</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ 1</span><br><span class="line"></span><br><span class="line">[1]+  Done                    ( sleep 2; echo $BASH_SUBSHELL; sleep 2 )</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    进程列表置入后台产生一个作业号和进程ID，返回到提示符和数字1。我们按一个回车键，会得到另一个提示符。</p><h4 id="2-3-协程"><a href="#2-3-协程" class="headerlink" title="2.3. 协程"></a>2.3. 协程</h4><p>​    协程可以同时做两件事。在后台生成一个子shell，并在这个子shell中执行命令。协程需要使用coproc命令，还有要在子shell中执行的命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ coproc sleep 10</span><br><span class="line">[1] 27984</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ jobs </span><br><span class="line">[1]+  Done                    coproc COPROC sleep 10</span><br></pre></td></tr></table></figure><p>​    输入coproc命令及其参数后，返回了作业号以及进程ID。jobs命令可以显示出协程的处理状态。可以看到子shell中执行的后台命令是coproc COPROC sleep 10。COPROC是coproc命令给进程起的名字。可以使用扩展语法设置名字。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ coproc My_Job &#123; sleep 10;&#125;</span><br><span class="line">[1] 2431</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ jobs</span><br><span class="line">[1]+  Done                    coproc My_Job &#123; sleep 10; &#125;</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    使用扩展语法，协程的名字被设置为My_Job。要注意扩展语法的写法。第一个或括号（{）和命令之间有一个空格。还必须保证命令以分号（;）结尾。分号和闭花括号（}）之间也得有个空格。</p><p>​    将协程和进程列表结合起来产生嵌套的子shell。只需输入进程列表，再把coproc放在前面就行。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ coproc ( sleep 10; sleep 2 )</span><br><span class="line">[1] 7736</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ jobs</span><br><span class="line">[1]+  Running                 coproc COPROC ( sleep 10; sleep 2 ) &amp;</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps --forest</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 5364 pts/0    00:00:00 bash</span><br><span class="line"> 7736 pts/0    00:00:00  \_ bash</span><br><span class="line"> 7737 pts/0    00:00:00  |   \_ sleep</span><br><span class="line"> 7869 pts/0    00:00:00  \_ ps</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    需要注意生成子shell的成本不低，而且速度还慢。</p><h3 id="3-理解shell的内建命令"><a href="#3-理解shell的内建命令" class="headerlink" title="3. 理解shell的内建命令"></a>3. 理解shell的内建命令</h3><p>​    搞明白shell的内建命令和非内建命令非常重要。二者的操作方式大不相同。</p><h4 id="3-1-外部命令"><a href="#3-1-外部命令" class="headerlink" title="3.1 外部命令"></a>3.1 外部命令</h4><p>​    ps就是一个外部命令。可以使用which和type命令找到它。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ which ps</span><br><span class="line">/bin/ps</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ type -a ps</span><br><span class="line">ps is /bin/ps</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ls -l /bin/ps</span><br><span class="line">-rwxr-xr-x 1 root root 97408 May 14  2018 /bin/ps</span><br></pre></td></tr></table></figure><p>​    当外部命令被执行时，会创建出一个子进程。这种操作成为衍生（forking）。外部命令很方便显示它的父进程及对应的衍生子进程。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ps -f</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">vip5      5364  5347  0 14:56 pts/0    00:00:00 -bash</span><br><span class="line">vip5     26930  5364  0 15:59 pts/0    00:00:00 ps -f</span><br></pre></td></tr></table></figure><h4 id="3-2-内建命令"><a href="#3-2-内建命令" class="headerlink" title="3.2 内建命令"></a>3.2 内建命令</h4><p>​    内建命令和外部命令区别在于前者不需要子进程来执行。cd和exit命令都内建于bash shell。可以利用type命令来了解某个命令是否是内建的。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ type ps</span><br><span class="line">ps is hashed (/bin/ps)</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ type cd </span><br><span class="line">cd is a shell builtin</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ type exit</span><br><span class="line">exit is a shell builtin</span><br></pre></td></tr></table></figure><p>​    内建命令执行速度更快，效率更高。有些命令有多种实现，可通过内建命令或者外部命令。查看命令的不同实现，使用type命令的-a选项。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ type -a echo</span><br><span class="line">echo is a shell builtin</span><br><span class="line">echo is /bin/echo</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ which echo</span><br><span class="line">/bin/echo</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ type -a pwd</span><br><span class="line">pwd is a shell builtin</span><br><span class="line">pwd is /bin/pwd</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ which pwd</span><br><span class="line">/bin/pwd</span><br></pre></td></tr></table></figure><p>​    命令type -a显示出了每个命令的两种实现。whic命令只显示了外部命令文件。</p><h5 id="1-使用history命令"><a href="#1-使用history命令" class="headerlink" title="1.  使用history命令"></a>1.  使用history命令</h5><p>​    要查看最近用过的命令列表，可以输入不带选项的history命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">886  2019-04-03 15:36:06 coproc (sleep 10; sleep 2)</span><br><span class="line"> 887  2019-04-03 15:36:10 jobs</span><br><span class="line"> 888  2019-04-03 15:36:18 ps --forest</span><br><span class="line"> 889  2019-04-03 15:37:11 coproc ( sleep 10; sleep 2 )</span><br><span class="line"> 890  2019-04-03 15:37:14 jobs</span><br><span class="line"> 891  2019-04-03 15:37:20 ps --forest</span><br><span class="line"> 892  2019-04-03 15:43:31 which ps</span><br><span class="line"> 893  2019-04-03 15:44:24 echo $BASH_SUBSHELL</span><br><span class="line"> 894  2019-04-03 15:44:38 which ps</span><br><span class="line"> 895  2019-04-03 15:44:43 type -a ps</span><br><span class="line"> 896  2019-04-03 15:44:56 ls -l /bin/ps</span><br><span class="line"> 897  2019-04-03 15:59:44 ps -f</span><br><span class="line"> 898  2019-04-03 16:03:24 type ps</span><br><span class="line"> 899  2019-04-03 16:03:34 type cd </span><br><span class="line"> 900  2019-04-03 16:03:38 type exit</span><br><span class="line"> 901  2019-04-03 16:18:07 type -a echo</span><br><span class="line"> 902  2019-04-03 16:18:22 which echo</span><br><span class="line"> 903  2019-04-03 16:18:29 type -a pwd</span><br><span class="line"> 904  2019-04-03 16:18:39 which pwd</span><br><span class="line"> 905  2019-04-03 16:24:25 type -a ps</span><br><span class="line"> 906  2019-04-03 16:26:07 history</span><br></pre></td></tr></table></figure><p>​    以上显示了最近的部分命令。通常历史记录中保存最近的1000条命令。</p><p>​    输入!!，然后按回车键就能唤出刚刚用过的那条命令来使用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ps --forest</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 5364 pts/0    00:00:00 bash</span><br><span class="line">23482 pts/0    00:00:00  \_ ps</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ !!</span><br><span class="line">ps --forest</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 5364 pts/0    00:00:00 bash</span><br><span class="line">23508 pts/0    00:00:00  \_ ps</span><br></pre></td></tr></table></figure><p>​    唤回历史列表中任一条命令，只需输入惊叹号和命令在历史列表中的编号即可。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  949  2019-04-03 16:33:50 ps --forest</span><br><span class="line">  950  2019-04-03 16:33:53 ps --forest</span><br><span class="line">  951  2019-04-03 16:36:07 history </span><br><span class="line">vip5@VM-0-15-ubuntu:~$ !950</span><br><span class="line">ps --forest</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 5364 pts/0    00:00:00 bash</span><br><span class="line">25574 pts/0    00:00:00  \_ ps</span><br></pre></td></tr></table></figure><h5 id="2-命令别名"><a href="#2-命令别名" class="headerlink" title="2. 命令别名"></a>2. 命令别名</h5><p>​    命令别名允许为常用的命令创建另一个名称，从而减少输入量。我们所使用的Linux可能已经设置好了一些常用命令的别名。查看当前可用别名，使用alias命令及选项-p。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ alias -p</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    当前服务器尚未进行设置。我们可以使用alias命令创建。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -li</span><br><span class="line">total 28</span><br><span class="line">30408710 drwxrwxr-x 5 vip5 vip5  4096 Dec 11 16:29 biosoft</span><br><span class="line">30408706 -rw-r--r-- 1 vip5 vip5   207 Dec 22 13:35 readme.txt</span><br><span class="line">30679310 drwxrwxr-x 2 vip5 vip5  4096 Mar 30 13:34 test</span><br><span class="line">30408712 -rw-rw-r-- 1 vip5 vip5 10240 Mar 30 13:34 test.tar</span><br><span class="line">30412381 -rw-rw-r-- 1 vip5 vip5   441 Mar 30 14:06 test.tar.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ alias li='ls -li'</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ li</span><br><span class="line">total 28</span><br><span class="line">30408710 drwxrwxr-x 5 vip5 vip5  4096 Dec 11 16:29 biosoft</span><br><span class="line">30408706 -rw-r--r-- 1 vip5 vip5   207 Dec 22 13:35 readme.txt</span><br><span class="line">30679310 drwxrwxr-x 2 vip5 vip5  4096 Mar 30 13:34 test</span><br><span class="line">30408712 -rw-rw-r-- 1 vip5 vip5 10240 Mar 30 13:34 test.tar</span><br><span class="line">30412381 -rw-rw-r-- 1 vip5 vip5   441 Mar 30 14:06 test.tar.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>​    别名属于内部命令，一个别名仅在它所被定义的shell中才有效。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ bash</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ li</span><br><span class="line">li: command not found</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ exit</span><br><span class="line">exit</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ li</span><br><span class="line">total 28</span><br><span class="line">30408710 drwxrwxr-x 5 vip5 vip5  4096 Dec 11 16:29 biosoft</span><br><span class="line">30408706 -rw-r--r-- 1 vip5 vip5   207 Dec 22 13:35 readme.txt</span><br><span class="line">30679310 drwxrwxr-x 2 vip5 vip5  4096 Mar 30 13:34 test</span><br><span class="line">30408712 -rw-rw-r-- 1 vip5 vip5 10240 Mar 30 13:34 test.tar</span><br><span class="line">30412381 -rw-rw-r-- 1 vip5 vip5   441 Mar 30 14:06 test.tar.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;第五章-理解shell&quot;&gt;&lt;a href=&quot;#第五章-理解shell&quot; class=&quot;headerlink&quot; title=&quot;第五章 理解shell&quot;&gt;&lt;/a&gt;第五章 理解shell&lt;/h1&gt;&lt;p&gt;​    通过进一步学习shell进程，将了解如何创建子shell以及父shell与子shell之间的关系。探究各种用于创建子进程的命令和内建命令。
    
    </summary>
    
    
      <category term="Linux, shell, bash" scheme="https://cldiao.github.io/tags/Linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>win10 installation and activation</title>
    <link href="https://cldiao.github.io/2019/03/27/win10%E5%AE%89%E8%A3%85/"/>
    <id>https://cldiao.github.io/2019/03/27/win10安装/</id>
    <published>2019-03-27T04:42:08.000Z</published>
    <updated>2019-03-27T05:24:35.207Z</updated>
    
    <content type="html"><![CDATA[<p>实验室新进一位阿拉伯留学生，电脑系统语言是中文。win10更新至1809后，不能修改系统显示语言。本着增加语言交流的目的，我在虚拟机中验证可行性后，帮其更换英文版系统。（个人安装，仅供科研学习，无商业用途）前段时间准备博士申请，markdown也变生疏，仍需多多学习，多多码字。</p><a id="more"></a><h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><ul><li><p><a href="https://www.microsoft.com/en-us/software-download/windows10" target="_blank" rel="noopener">系统下载</a></p></li><li><p><a href="https://www.dropbox.com/s/7eueeragoymstex/win10.txt?dl=0" target="_blank" rel="noopener">激活文件</a></p></li></ul><h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><ul><li><p>下载系统</p><p>使用上方下载链接下载<code>media creation tool</code>。然后根据需要下载Windows语言版本。</p></li><li><p>安装系统<br>windonws8开始，系统可以识别ISO文件，也就可以直接在当前系统使用<code>**.iso</code>文件进行系统安装。</p></li><li><p>激活系统</p><p>将以下文本粘贴至记事本。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">title Windows 10 ALL version activator&amp;cls&amp;echo ************************************&amp;echo Supported products:&amp;echo - Windows 10 Home&amp;echo - Windows 10 Professional&amp;echo - Windows 10 Enterprise, Enterprise LTSB&amp;echo - Windows 10 Education&amp;echo.&amp;echo.&amp;echo ************************************ &amp;echo Windows 10 activation...</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk TX9XD-98N7V-6WMQ6-BX7FG-H8Q99 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk 3KHY7-WNT83-DGQKR-F7HPR-844BM &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk 7HNRX-D7KGG-3K4RQ-4WPJ4-YTDFH &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk PVMJN-6DFY6-9CCP6-7BKTT-D3WVR &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk MH37W-N47XK-V7XM9-C7227-GCQG9 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk NW6C2-QMPVW-D7KKK-3GKT6-VCFB2 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk 2WH4N-8QGBV-H22JP-CT43Q-MDWWJ &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk NPPR9-FWDCX-D2C8J-H872K-2YT43 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk WNMTR-4C88C-JK8YV-HQ7T2-76DF9 &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ipk 2F77B-TNFGY-69QQF-B8YKP-D69TJ &gt;nul</span><br><span class="line">echo ************************************ &amp;echo.&amp;echo.&amp;set i=1</span><br><span class="line">:server</span><br><span class="line">if %i%==1 set KMS_Sev=kms.shuax.com</span><br><span class="line">if %i%==2 set KMS_Sev=NextLevel.uk.to</span><br><span class="line">if %i%==3 set KMS_Sev=GuangPeng.uk.to</span><br><span class="line">if %i%==4 set KMS_Sev=AlwaysSmile.uk.to</span><br><span class="line">if %i%==5 set KMS_Sev=kms.chinancce.com </span><br><span class="line">if %i%==6 exit</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /skms %KMS_Sev% &gt;nul</span><br><span class="line">cscript //nologo c:\windows\system32\slmgr.vbs /ato | find /i &quot;successfully&quot; &amp;&amp; (echo.&amp; echo ************************************ &amp; echo. &amp; choice /n /c YN /m &quot;Do you want to restart your PC now [Y,N]?&quot; &amp; if errorlevel 2 exit) || (echo The connection to the server failed! Trying to connect to another one... &amp; echo Please wait... &amp; echo. &amp; echo. &amp; set /a i+=1 &amp; goto server)</span><br><span class="line">shutdown.exe /r /t 00</span><br></pre></td></tr></table></figure><p>修改文件名为<code>windows10.cmd</code>。以管理员身份运行。即可完成激活。</p><p><img src="https://github.com/CLDIAO/CLDIAO.github.io/raw/master/2019/%E6%89%B9%E6%B3%A8%202019-03-27%20130432.jpg" alt=""></p><p><img src="https://github.com/CLDIAO/CLDIAO.github.io/raw/master/2019/%E6%89%B9%E6%B3%A8%202019-03-27%20130514.jpg" alt=""></p></li></ul><h1 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h1><p>如图：</p><p><img src="https://github.com/CLDIAO/CLDIAO.github.io/raw/master/2019/%E6%89%B9%E6%B3%A8%202019-03-27%20130311.jpg" alt=""></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://sihmar.com/download-windows-10-version-1803-iso-64-bit-or-32-bit-officially/" target="_blank" rel="noopener">http://sihmar.com/download-windows-10-version-1803-iso-64-bit-or-32-bit-officially/</a></p><p><a href="https://www.youtube.com/watch?v=x07dH20pVYs" target="_blank" rel="noopener">https://www.youtube.com/watch?v=x07dH20pVYs</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;实验室新进一位阿拉伯留学生，电脑系统语言是中文。win10更新至1809后，不能修改系统显示语言。本着增加语言交流的目的，我在虚拟机中验证可行性后，帮其更换英文版系统。（个人安装，仅供科研学习，无商业用途）前段时间准备博士申请，markdown也变生疏，仍需多多学习，多多码字。&lt;/p&gt;
    
    </summary>
    
    
      <category term="windows10, activation" scheme="https://cldiao.github.io/tags/windows10-activation/"/>
    
  </entry>
  
  <entry>
    <title>linux命令行与shell脚本编程大全学习笔记第四章</title>
    <link href="https://cldiao.github.io/2018/12/22/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%A4%A7%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E7%AC%AC%E5%9B%9B%E7%AB%A0/"/>
    <id>https://cldiao.github.io/2018/12/22/linux命令行与shell脚本编程大全学习笔记第四章/</id>
    <published>2018-12-22T06:53:52.000Z</published>
    <updated>2019-04-06T06:45:08.742Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第四章：更多的bash-shell-命令"><a href="#第四章：更多的bash-shell-命令" class="headerlink" title="第四章：更多的bash shell 命令"></a>第四章：更多的bash shell 命令</h1><h2 id="进程检测"><a href="#进程检测" class="headerlink" title="进程检测"></a>进程检测</h2><h3 id="1-探查进程-ps"><a href="#1-探查进程-ps" class="headerlink" title="1. 探查进程: ps"></a>1. 探查进程: ps</h3><p>程序运行在系统上时，称之为进程（process）。ps命令可以监测这些进程。但是它的参数诸多，要掌握能提供自己需要信息的一组参数即可。<a id="more"></a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下，ps命令不提供太多信息,即当前控制台下当前用户的进程</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">13106 pts/1    00:00:00 bash</span><br><span class="line">13320 pts/1    00:00:00 ps</span><br></pre></td></tr></table></figure><p>Linux中ps命令支持3种不同类型的命令行参数：</p><ul><li>Unix风格，前面加单破折线</li><li>BSD风格，前面不加破折线</li><li>GNU风格，前面加双破折线</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ps -efl</span><br><span class="line">F S UID        PID  PPID  C PRI  NI ADDR SZ WCHAN  STIME TTY          TIME CMD</span><br><span class="line">4 S root         1     0  0  80   0 - 29956 -       2018 ?        00:01:38 /sbin/init</span><br><span class="line">1 S root         2     0  0  80   0 -     0 -       2018 ?        00:00:00 [kthreadd]</span><br><span class="line">1 S root         3     2  0  80   0 -     0 -       2018 ?        00:00:37 [ksoftirqd/0]</span><br><span class="line">1 S root         5     2  0  60 -20 -     0 -       2018 ?        00:00:00 [kworker/0:0H]</span><br><span class="line">1 S root         7     2  0  80   0 -     0 -       2018 ?        00:17:18 [rcu_sched]</span><br><span class="line">1 S root         8     2  0  80   0 -     0 -       2018 ?        00:00:00 [rcu_bh]</span><br><span class="line">1 S root         9     2  0 -40   - -     0 -       2018 ?        00:00:37 [migration/0]</span><br></pre></td></tr></table></figure><p>上例中，使用了三个参数：-e参数显示所有运行在系统上的进程；-f参数扩展了输出；-l参数产生一个长格式输出。</p><ul><li>F：内核分配给进程的系统标记</li><li>S：进程的状态（O表示运行中；S表示休眠；R表示可运行,待运行；Z表示僵化；T表示停止）</li><li>PRI：进程的优先级</li><li>NI：谦让值用来参与决定优先级</li><li>ADDR：进程里的内存地址</li><li>SZ：假如进程被换出，所需交换空间的大致大小</li><li>WCHAN：进程休眠的内核函数的地址</li><li>UID：启动这些进程的用户</li><li>PID：进程的进程ID</li><li>PPID：父进程的进程号</li><li>C：进程生命周期中的CPU利用率</li><li>STIME：进程启动时的系统时间</li><li>TTY：进程启动时的终端设备</li><li>TIME：运行进程需要的累计CPU时间</li><li>CMD：启动的程序名称</li></ul><h3 id="2-实时监测进程：top"><a href="#2-实时监测进程：top" class="headerlink" title="2. 实时监测进程：top"></a>2. 实时监测进程：top</h3><p>ps命令显示的是某个时间点的信息。top命令可以实时显示进程信息。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">top - 00:21:32 up 66 days,  6:25,  3 users,  load average: 0.21, 0.06, 0.13</span><br><span class="line">Tasks: 212 total,   1 running, 209 sleeping,   0 stopped,   2 zombie</span><br><span class="line"><span class="meta">%</span><span class="bash">Cpu(s):  0.2 us,  0.3 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span><br><span class="line">KiB Mem : 16300680 total,   200944 free,   213296 used, 15886440 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used. 15543588 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                           </span><br><span class="line">    7 root      20   0       0      0      0 S   0.3  0.0  17:19.15 rcu_sched                                                                         </span><br><span class="line"> 6212 root      20   0  976084  16468   3256 S   0.3  0.1  65:42.46 barad_agent                                                                       </span><br><span class="line">13094 vip5      20   0   93084   5248   3964 S   0.3  0.0   0:06.38 sshd                                                                              </span><br><span class="line">30224 root      20   0  578288  26960   4276 S   0.3  0.2  12:58.74 YDService                                                                         </span><br><span class="line">    1 root      20   0  119824   5280   3280 S   0.0  0.0   1:38.21 systemd                                                                           </span><br><span class="line">    2 root      20   0       0      0      0 S   0.0  0.0   0:00.50 kthreadd                                                                          </span><br><span class="line">    3 root      20   0       0      0      0 S   0.0  0.0   0:37.76 ksoftirqd/0                                                                       </span><br><span class="line">    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H                                                                      </span><br><span class="line">    8 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh</span><br></pre></td></tr></table></figure><p>输出的第一部分是系统概况：第一行显示了当前时间、系统的运行时间、登录的用户数以及系统的平均负载。平均负载有三个值：近1分钟、近5分钟、近15分钟的平均负载；若近15分钟的平均负载都很高，说明系统可能有问题。</p><p>第二行显示了进程概要信息：有多少进程处在运行、休眠、停止、僵化状态。</p><p>下一行显示了CPU的概要信息。</p><p>下两行说明了系统内存状态。第一行说系统的物理内存，当前用了多少，还有多少空余。后一行是系统交换空间的同样的信息。</p><p>最后一部分显示了当前运行中的进程的详细列表。</p><ul><li><p>PID：进程的ID</p></li><li><p>USER：进程属主的名字</p></li><li><p>PR：进程的优先级</p></li><li><p>NI：进程的谦让度值</p></li><li><p>VIRT：进程占用虚拟内存的总量</p></li><li><p>RES：进程占用物理内存的总量</p></li><li><p>SHR：进程和其他进程共享的内存总量</p></li><li><p>S：进程的状态</p></li><li><p>%CPU：进程使用的CPU时间比例</p></li><li><p>%MEM：进程使用的内存占可用内存的比例</p></li><li><p>TIME+：自进程启动到目前为止的CPU时间总量</p></li><li><p>COMMAND：进程所对应的命令行名称，也就是启动的程序名</p></li></ul><p>top命令运行时，键入<strong>f</strong> 允许选择对输出进行排序的字段；键入<strong>d</strong>允许修改轮询间隔；键入<strong>q</strong>可以推出top。 使用top命令可以找出占用系统大部分资源的罪魁祸首，进而结束进程。</p><h3 id="3-结束进程"><a href="#3-结束进程" class="headerlink" title="3.结束进程"></a>3.结束进程</h3><p>程序能够接收识别进程信号，如下：</p><table><thead><tr><th style="text-align:center">信号</th><th style="text-align:center">名称</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">HUP</td><td style="text-align:center">挂起</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">INT</td><td style="text-align:center">中断</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">QUIT</td><td style="text-align:center">结束运行</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">KILL</td><td style="text-align:center">无条件终止</td></tr><tr><td style="text-align:center">11</td><td style="text-align:center">SEGV</td><td style="text-align:center">段错误</td></tr><tr><td style="text-align:center">15</td><td style="text-align:center">TERM</td><td style="text-align:center">尽可能终止</td></tr><tr><td style="text-align:center">17</td><td style="text-align:center">STOP</td><td style="text-align:center">无条件停止运行，但不终止</td></tr><tr><td style="text-align:center">18</td><td style="text-align:center">TSTP</td><td style="text-align:center">停止或暂停，但继续在后台运行</td></tr><tr><td style="text-align:center">19</td><td style="text-align:center">CONT</td><td style="text-align:center">在STOP或TSTP后恢复执行</td></tr></tbody></table><p>Linux上有两个命令可以向运行中的进程发出进程信号。</p><ol><li><p>kill命令</p><p>kill命令可以通过PID给进程发信号。要发送进程信号，你必须是进程的属主或者登录为root用户。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ kill 1137</span><br><span class="line">-bash: kill: (1137) - Operation not permitted</span><br></pre></td></tr></table></figure></li><li><p>killall命令</p><p>killall命令可以通过进程名来结束进程。也支持通配符。（root慎用！！！）</p></li></ol><h2 id="监测磁盘空间"><a href="#监测磁盘空间" class="headerlink" title="监测磁盘空间"></a>监测磁盘空间</h2><h3 id="1-挂在存储媒体"><a href="#1-挂在存储媒体" class="headerlink" title="1.挂在存储媒体"></a>1.挂在存储媒体</h3><p> 大多数Linux版本都支持自动挂载和卸载可移动存储媒体，有的发行版不支持，就必须手动完成。</p><ol><li><p>mount命令</p><p>Linux上挂载媒体的命令是mount。默认情况下，mount会输出当前系统上挂载的设备列表。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ mount</span><br><span class="line">sysfs on /sys type sysfs (rw,relatime)</span><br><span class="line">proc on /proc type proc /dev/sdb1 on /media/disk type vfat(rw,relatime)</span><br><span class="line">/dev/sdb1 on /media/disk type vfat</span><br></pre></td></tr></table></figure><p>mount命令提供如下四部分信息</p><ul><li><p>媒体的设备文件名</p></li><li><p>媒体挂载到虚拟目录的挂载点</p></li><li><p>文件系统类型</p></li><li><p>已挂载媒体的访问状态</p></li></ul><p>上面的最后一行输出中，U盘被自动挂载到了挂载点/media/disk。vfat文件系统类型说明它是在windows机器上被格式化的。</p><p>要手动在虚拟目录中挂载设备，需要以root用户身份登录，或运行sudo命令。基本命令：</p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t type device directory</span><br></pre></td></tr></table></figure><p>type参数指定了磁盘被格式化的文件系统类型。Linux可以识别非常多的文件系统类型。和Windows PC共用的存储设备，通常使用下列文件系统类型。</p><ul><li><p>vfat：Windows长文件系统</p></li><li><p>ntfs：Windows NT，XP，Windows 7中的高级文件系统</p></li><li><p>iso9660：标准的CD-ROM文件系统</p></li></ul><p>多数U盘和软盘是vfat文件系统。<br>后面两个参数定义了存储设备的设备文件的位置及挂载点在虚拟目录中的位置。<br>mount也有一些高级参数。通常是管理员使用。</p></li></ol><p>2.umont命令</p><p>   Linux系统上移除一个可移动设备需要先卸载。卸载的命令是umount。</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount [directory | device]</span><br></pre></td></tr></table></figure><p>   umount支持通过设备文件或者挂载点来指定要卸载的设备。有程序在使用设备上的文件时，系统不允许卸载。</p><h3 id="2-使用df命令"><a href="#2-使用df命令" class="headerlink" title="2.使用df命令"></a>2.使用df命令</h3><p>   当需要知道某个设备上的磁盘空间时，df命令可以方便地查看所有已挂载的磁盘的使用情况。</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ df</span><br><span class="line">Filesystem      1K-blocks      Used Available Use% Mounted on</span><br><span class="line">udev              8130340         0   8130340   0% /dev</span><br><span class="line">tmpfs             1630068    156788   1473280  10% /run</span><br><span class="line">/dev/vda1        51474024   3862640  45288916   8% /</span><br><span class="line">tmpfs             8150340        24   8150316   1% /dev/shm</span><br><span class="line">tmpfs                5120         0      5120   0% /run/lock</span><br><span class="line">tmpfs             8150340         0   8150340   0% /sys/fs/cgroup</span><br><span class="line">/dev/vdc1       515927296 282527476 207169088  58% /home</span><br><span class="line">/dev/vdb1      1031986328  97021188 882520008  10% /vip</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1023</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1007</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1053</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1123</span><br><span class="line">/dev/vdd1       619141896 501400280  86268004  86% /four</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1009</span><br><span class="line">tmpfs             1630068         0   1630068   0% /run/user/1056</span><br></pre></td></tr></table></figure><p>   df命令有一些参数可以使用，其中一个常用的是-h，会把输出中的磁盘空间按照用户易读的形式显示。</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ df -h</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            7.8G     0  7.8G   0% /dev</span><br><span class="line">tmpfs           1.6G  154M  1.5G  10% /run</span><br><span class="line">/dev/vda1        50G  3.7G   44G   8% /</span><br><span class="line">tmpfs           7.8G   24K  7.8G   1% /dev/shm</span><br><span class="line">tmpfs           5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs           7.8G     0  7.8G   0% /sys/fs/cgroup</span><br><span class="line">/dev/vdc1       493G  270G  198G  58% /home</span><br><span class="line">/dev/vdb1       985G   93G  842G  10% /vip</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1023</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1007</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1053</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1123</span><br><span class="line">/dev/vdd1       591G  479G   83G  86% /four</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1009</span><br><span class="line">tmpfs           1.6G     0  1.6G   0% /run/user/1056</span><br></pre></td></tr></table></figure><p>   可以看出df命令的输出包括：</p><ul><li><p>设备的设备文件位置</p></li><li><p>存储空间</p></li><li><p>已使用存储</p></li><li><p>剩余存储</p></li><li><p>已使用空间所占的比例</p></li><li><p>设备挂载的挂载点</p></li></ul><h3 id="3-使用du命令"><a href="#3-使用du命令" class="headerlink" title="3.使用du命令"></a>3.使用du命令</h3><p>du命令可以显示某个特定目录的磁盘使用情况，可以判断系统上某个目录下是否有超大文件。</p><p>默认情况下，du命令会显示当前目录下所有的文件、目录、子目录的磁盘使用情况。对标准大小的目录来说，这个输出会是很长的列表。如下是部分输出。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ du</span><br><span class="line">1716    ./biosoft/anaconda/anaconda3/include</span><br><span class="line">4       ./biosoft/anaconda/anaconda3/phrasebooks</span><br><span class="line">5814924 ./biosoft/anaconda/anaconda3</span><br><span class="line">6467104 ./biosoft/anaconda</span><br><span class="line">6540396 ./biosoft</span><br><span class="line">4       ./.cache</span><br><span class="line">8       ./test</span><br><span class="line">8       ./.vim</span><br><span class="line">4       ./.conda/pkgs</span><br><span class="line">12      ./.conda</span><br><span class="line">6540472 .</span><br></pre></td></tr></table></figure><p>因此要使用参数来达到目的。</p><ul><li><p>-c：显示所有已列出文件中的大小</p></li><li><p>-h：按用户易读的格式输出大小</p></li><li><p>-s：显示每个输出参数的总计</p></li></ul><h2 id="处理数据文件"><a href="#处理数据文件" class="headerlink" title="处理数据文件"></a>处理数据文件</h2><h3 id="1-排序数据"><a href="#1-排序数据" class="headerlink" title="1. 排序数据"></a>1. 排序数据</h3><p>处理大量数据时常用sort命令。默认按默认语言的排序规则。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat my_file.txt </span><br><span class="line">line1</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">Hello World - line 6</span><br><span class="line">line7</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">line10</span><br><span class="line">line11</span><br><span class="line">Hello again - line 12</span><br><span class="line">line13</span><br><span class="line">line14</span><br><span class="line">line15</span><br><span class="line">Sweet - line16</span><br><span class="line">line17</span><br><span class="line">line18</span><br><span class="line">line19</span><br><span class="line">Last line - line20</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort my_file.txt </span><br><span class="line">Hello again - line 12</span><br><span class="line">Hello World - line 6</span><br><span class="line">Last line - line20</span><br><span class="line">line1</span><br><span class="line">line10</span><br><span class="line">line11</span><br><span class="line">line13</span><br><span class="line">line14</span><br><span class="line">line15</span><br><span class="line">line17</span><br><span class="line">line18</span><br><span class="line">line19</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">line7</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">Sweet - line16</span><br></pre></td></tr></table></figure><p>但对于数字来说输出似乎要失望了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat file1 </span><br><span class="line">1</span><br><span class="line">25</span><br><span class="line">49</span><br><span class="line">38</span><br><span class="line">140</span><br><span class="line">480</span><br><span class="line">312</span><br><span class="line">5</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort file1 </span><br><span class="line">1</span><br><span class="line">140</span><br><span class="line">25</span><br><span class="line">312</span><br><span class="line">38</span><br><span class="line">480</span><br><span class="line">49</span><br><span class="line">5</span><br></pre></td></tr></table></figure><p>解决的方法就是参数-n，会告诉sort命令把数字识别成数字而不是字符，且按值排序。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort -n file1 </span><br><span class="line">1</span><br><span class="line">5</span><br><span class="line">25</span><br><span class="line">38</span><br><span class="line">49</span><br><span class="line">140</span><br><span class="line">312</span><br><span class="line">480</span><br></pre></td></tr></table></figure><p>另一个参数时-M，按月排序。Linux的日志文件经常会在每行起始位置有个时间戳。如果含时间戳日期的文件按默认排序会得到下面的结果。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort file3</span><br><span class="line">Apr</span><br><span class="line">Aug</span><br><span class="line">Dec</span><br><span class="line">Feb</span><br><span class="line">Jan</span><br><span class="line">Jul</span><br><span class="line">Jun</span><br><span class="line">Mar</span><br><span class="line">May</span><br><span class="line">Nov</span><br><span class="line">Oct</span><br><span class="line">Sep</span><br></pre></td></tr></table></figure><p>-M参数的sort命令可以识别三字符的月份名，并相应排序。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ sort -M file3</span><br><span class="line">Jan</span><br><span class="line">Feb</span><br><span class="line">Mar</span><br><span class="line">Apr</span><br><span class="line">May</span><br><span class="line">Jun</span><br><span class="line">Jul</span><br><span class="line">Aug</span><br><span class="line">Sep</span><br><span class="line">Oct</span><br><span class="line">Nov</span><br><span class="line">Dec</span><br></pre></td></tr></table></figure><h3 id="2-搜索数据"><a href="#2-搜索数据" class="headerlink" title="2. 搜索数据"></a>2. 搜索数据</h3><p>当在大文件中找一行数据时，需要grep命令。格式如下。</p><p>grep [options] pattern [file]</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep again my_file.txt </span><br><span class="line">Hello again - line 12</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep a my_file.txt </span><br><span class="line">Hello again - line 12</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><p>第一组在my_file.txt中匹配again的文本。第二个例子在my_file.txt中匹配a的文本。有两行匹配，两行都输出了。</p><p>-v参数实现反向搜索</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep -v H my_file.txt </span><br><span class="line">line1</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">line7</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">line10</span><br><span class="line">line11</span><br><span class="line">line13</span><br><span class="line">line14</span><br><span class="line">line15</span><br><span class="line">Sweet - line16</span><br><span class="line">line17</span><br><span class="line">line18</span><br><span class="line">line19</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><p>-n参数显示匹配的行号。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep -n again my_file.txt </span><br><span class="line">12:Hello again - line 12</span><br></pre></td></tr></table></figure><p>-c参数显示匹配的行数。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep -c again my_file.txt </span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>-e 参数可以指定多个匹配。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep -e a -e g my_file.txt </span><br><span class="line">Hello again - line 12</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><p>正则表达式中的方括号表明搜索含a或含g的匹配。如不用正则表达式，则会搜索匹配tf的文本。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ grep [ag] my_file.txt </span><br><span class="line">Hello again - line 12</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><h3 id="3-压缩数据"><a href="#3-压缩数据" class="headerlink" title="3. 压缩数据"></a>3. 压缩数据</h3><table><thead><tr><th>工具</th><th>文件扩展名</th><th>描述</th></tr></thead><tbody><tr><td>bzip2</td><td>.bz2</td><td>-</td></tr><tr><td>compress</td><td>.Z</td><td>初代，极少用</td></tr><tr><td>gzip</td><td>.gz</td><td>最流行</td></tr><tr><td>zip</td><td>.zip</td><td>-</td></tr></tbody></table><p>gzip是Linux上最流行的压缩工具。这个软件包含下面的工具。</p><ul><li><p>gzip：用来压缩文件</p></li><li><p>gzcat：用来查看压缩过的文本文件的内容</p></li><li><p>gunzip：用来解压文件</p></li></ul><p>这些工具基本上和bzip2的用法一样。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">file1  file3  my_file.txt</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ gzip my_file.txt </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">file1  file3  my_file.txt.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ gunzip my_file.txt.gz </span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">file1  file3  my_file.txt</span><br></pre></td></tr></table></figure><p>gzip命令可以压缩指定单个文件，多个文件甚至用通配符来批量压缩文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">file1  file3  my_file.txt</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ gzip fi*</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">file1.gz  file3.gz  my_file.txt</span><br></pre></td></tr></table></figure><h3 id="4-归档数据"><a href="#4-归档数据" class="headerlink" title="4. 归档数据"></a>4. 归档数据</h3><p>​    zip命令可以进行数据压缩和归档，但Unix和Linux中最广泛使用的归档工具是tar命令。</p><p>​    <code>tar</code>命令的格式：<code>tar function [options] object1 object2 ...</code></p><p>tar命令的功能：</p><table><thead><tr><th>功能</th><th>长名称</th><th>描述</th></tr></thead><tbody><tr><td>-A</td><td>–concatenate</td><td>将一个已有tar归档文件追加到另一个已有tar归档文件</td></tr><tr><td>-c</td><td>–create</td><td>创建一个新的tar归档文件</td></tr><tr><td>-d</td><td>–diff</td><td>检查归档文件和文件系统的不同之处</td></tr><tr><td></td><td>–delete</td><td>从已有tar归档文件中删除</td></tr><tr><td>-r</td><td>–append</td><td>追加文件到已有tar归档文件末尾</td></tr><tr><td>-t</td><td>–list</td><td>列出已有tar归档文件的内容</td></tr><tr><td>-u</td><td>–update</td><td>将比tar归档文件中已有的同名文件新的文件追加到该tar归档文件中</td></tr><tr><td>-x</td><td>–extract</td><td>从已有tar归档文件中提取文件</td></tr></tbody></table><p>tar命令选项</p><table><thead><tr><th>选项</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td>-c dir</td><td style="text-align:left">切换到指定目录</td></tr><tr><td>-f file</td><td style="text-align:left">输出结果到文件或设备file</td></tr><tr><td>-j</td><td style="text-align:left">将输出重定向给bzip2命令来压缩内容</td></tr><tr><td>-p</td><td style="text-align:left">保留所有文件权限</td></tr><tr><td>-v</td><td style="text-align:left">在处理文件时显示文件</td></tr><tr><td>-z</td><td style="text-align:left">将输出重定向给gzip命令来压缩内容</td></tr></tbody></table><p>这些选项通常合并到一起使用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建一个归档文件</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ tar -cvf test.tar test/</span><br><span class="line">test/</span><br><span class="line">test/my_file.txt</span><br><span class="line">test/file3.gz</span><br><span class="line">test/file1.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ls</span><br><span class="line">biosoft  readme.txt  test  test.tar</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 列出归档文件的内容</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ tar -tf test.tar</span><br><span class="line">test/</span><br><span class="line">test/my_file.txt</span><br><span class="line">test/file3.gz</span><br><span class="line">test/file1.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 提取归档文件的内容</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ tar -xvf test.tar</span><br><span class="line">test/</span><br><span class="line">test/my_file.txt</span><br><span class="line">test/file3.gz</span><br><span class="line">test/file1.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建归档文件并使用gzip命令压缩</span></span><br><span class="line">vip5@VM-0-15-ubuntu:~$ tar -zcvf test.tar.gz test/</span><br><span class="line">test/</span><br><span class="line">test/my_file.txt</span><br><span class="line">test/file3.gz</span><br><span class="line">test/file1.gz</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ ls</span><br><span class="line">biosoft  readme.txt  test  test.tar  test.tar.gz</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;第四章：更多的bash-shell-命令&quot;&gt;&lt;a href=&quot;#第四章：更多的bash-shell-命令&quot; class=&quot;headerlink&quot; title=&quot;第四章：更多的bash shell 命令&quot;&gt;&lt;/a&gt;第四章：更多的bash shell 命令&lt;/h1&gt;&lt;h2 id=&quot;进程检测&quot;&gt;&lt;a href=&quot;#进程检测&quot; class=&quot;headerlink&quot; title=&quot;进程检测&quot;&gt;&lt;/a&gt;进程检测&lt;/h2&gt;&lt;h3 id=&quot;1-探查进程-ps&quot;&gt;&lt;a href=&quot;#1-探查进程-ps&quot; class=&quot;headerlink&quot; title=&quot;1. 探查进程: ps&quot;&gt;&lt;/a&gt;1. 探查进程: ps&lt;/h3&gt;&lt;p&gt;程序运行在系统上时，称之为进程（process）。ps命令可以监测这些进程。但是它的参数诸多，要掌握能提供自己需要信息的一组参数即可。
    
    </summary>
    
    
      <category term="linux, shell, bash" scheme="https://cldiao.github.io/tags/linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>preparation of lipoplex</title>
    <link href="https://cldiao.github.io/2018/12/22/preparation-of-lipoplex/"/>
    <id>https://cldiao.github.io/2018/12/22/preparation-of-lipoplex/</id>
    <published>2018-12-22T06:26:43.000Z</published>
    <updated>2018-12-22T06:48:14.309Z</updated>
    
    <content type="html"><![CDATA[<p>Preparation of 10 ml of 20 mM DODAP:Chol (1:1)</p><ol><li>preparation </li></ol><p>DOTAP (Avanti, 890890)</p><p>cholesterol (Avanti,700000)</p><p>rotary water bath</p><p>D5W (5% Dextrose in water)</p><p>sonicator </p><p>filter</p>  <a id="more"></a><ol start="2"><li><p>protocol</p></li><li><p>Warm-up DOTAP at RT and weigh DOTAP 140 mg (0.2 mmol) (MW = 693.55, Cat#: 890890, 1g and 1:18)</p></li><li>Wight Chol. 77 mg (0.2 mmol) (MW = 386.66, Cat# 700000, &gt;98% pure)</li><li>Add them to a clean round-bottom flask (1 L) respectively and then cover the flask with parafilm.</li><li>Add 10 mL HPLC-graded CHCl3 to the bottle and be sure the chemicals are all dissolved.</li><li>Load the flask on the rotary water bath at 30 C for 30 min under vacuum at about 30 Hg (the pump Model B-169 is made by the Brinkman). At this stage the thin layer of film is formed.</li><li>Lyophilize the dried film to get rid of the trace amount of chloroform for 15 min.</li><li>Hydrate the thin film in the round flask with 10 ml of D5W (5% Dextrose in water) in hood to give a final concentration of 20 mM DOTAP:Chol.</li><li>Pre-wet everywhere of the film in the hood as quickly as possible and use parafilm to cover the flask and punch several small holes on the cover with needle.</li><li>Hold the flask in water bath at 50 ْC and rotate at different angles for at least 15 min or until you see most of the material is off the flask and then vertically move the flask for another 30 min.</li><li>Transfer the flask into a 37 ْC water bath and vertically move the flask for 10 min.</li><li>Cover the flask and leave it over-night at RT.</li><li>Hold the flask with a clamp on a stand and place it into a 50 ْC water bath sonicator and sonicate the DOTAP mixture at low frequency (low f = 35 kHz, high = 80 kHz) at 50 ْC for 5 min.</li><li>Bring the flask into a hood and carefully transfer the product into a 15 mL tube using 10 mL pipette.</li><li>Warm-up the mixture in the tube in a water bath at 50 ْC for 10-12 min.</li><li>Meanwhile open all 10 mL syringes in the hood, each syringe with 1.0, 0.45, 0.2, and 0.1 mm filter disk (Whatman Filters, Kent, UK), respectively, on it.</li><li>Take the tube out of water bath and, sequentially, filtrate the mixture into another syringe as quickly as possible.  </li><li>Collect the DOTAP solution from the last filtration into the glass tube, about 1 drop/色c.</li><li>Transfer the final product into a 1.5 mL glass vials to fill all the space and cap the vial and store at 4 ْC.</li><li>O.D. the products:  dilute 5 ml of DOTAP:Chol into 95 ml f dH2O, measure O.D. at 400 nm (vis).  The normal range of O.D. should be in 0.35-0.45.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Preparation of 10 ml of 20 mM DODAP:Chol (1:1)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;preparation &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;DOTAP (Avanti, 890890)&lt;/p&gt;
&lt;p&gt;cholesterol (Avanti,700000)&lt;/p&gt;
&lt;p&gt;rotary water bath&lt;/p&gt;
&lt;p&gt;D5W (5% Dextrose in water)&lt;/p&gt;
&lt;p&gt;sonicator &lt;/p&gt;
&lt;p&gt;filter&lt;/p&gt;
    
    </summary>
    
    
      <category term="lipoplex" scheme="https://cldiao.github.io/tags/lipoplex/"/>
    
  </entry>
  
  <entry>
    <title>side population assay</title>
    <link href="https://cldiao.github.io/2018/12/21/side-population-assay/"/>
    <id>https://cldiao.github.io/2018/12/21/side-population-assay/</id>
    <published>2018-12-21T08:32:05.000Z</published>
    <updated>2018-12-22T06:22:45.650Z</updated>
    
    <content type="html"><![CDATA[<h1 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h1><ul><li><p>cells（10^6/tube)</p></li><li><p>Hoechst33342 (sigma, B2261)</p></li><li><p>PI (2mg/ml)</p></li><li><p>Verapamil (sigma, 152-11-4)</p><a id="more"></a></li><li><p>medium added 10% FBS (37℃)</p></li><li><p>37 ℃ water bath</p></li><li><p>Hemocytometer</p></li><li><p>Refrigerated centrifuge</p></li><li><p>2ml ep tube</p></li><li><p>Flow filter</p></li><li><p>ice box</p></li></ul><h1 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h1><p>solution is prepared with ddH2O,  filtrated with 0.22 μm filter, protected from light.</p><ul><li><p>Verapamil, 4mM(2mg/ml). add 0.002g into 1ml H2O.(re-prepare for each experiment)</p></li><li><p>Hoechst33342(5mg/ml).(stable in a month)</p></li></ul><h1 id="protocol"><a href="#protocol" class="headerlink" title="protocol"></a>protocol</h1><ul><li><p>Cell dissociation. 150g, 3min</p></li><li><p>Resuspend the medium, 150g, 3min</p></li><li><p>Remove the supernatant, resuspend cells with 3 ml medium, and dilute to 10^6/ml</p></li><li><p>Prepare the flow tube and mark it: ctrl, , v-100, v-200(recommended)</p></li><li><p>Add 2 ml of suspension to each ep tube and add the corresponding volume Verapamil.</p><ul><li><p>V-50: 25 μl</p></li><li><p>V-100: 50 μl</p></li><li><p>V-200: 100 μl</p></li></ul></li><li><p>37 ° C water bath for 15 min (sample group does not need water bath)</p></li><li><p>Add 2 μL of Hoechst33342 to each tube to a final concentration of 5 μg/mL</p></li><li><p>37 ° C water bath for 90 min, vortex every 10 min(pre-cooling the centrifuge to 4 ℃)</p></li><li><p>Ice bath in ice box for 10min</p></li><li><p>4 ℃ centrifugation, 350g, 5min</p></li><li><p>After the centrifugation, remove the supernatant </p></li><li><p>resuspended with 500 μl cold medium, placed on ice</p></li><li><p>Add PI (2mg/mL) 1.25μl (final concentration 5μg/ml) before loading samples, vortex, ice bath for 10min</p></li><li><p>Filter the cell suspension into flow tubes, place on ice, protected from light.</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;preparation&quot;&gt;&lt;a href=&quot;#preparation&quot; class=&quot;headerlink&quot; title=&quot;preparation&quot;&gt;&lt;/a&gt;preparation&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;cells（10^6/tube)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hoechst33342 (sigma, B2261)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;PI (2mg/ml)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Verapamil (sigma, 152-11-4)&lt;/p&gt;
    
    </summary>
    
    
      <category term="SP, FCAS" scheme="https://cldiao.github.io/tags/SP-FCAS/"/>
    
  </entry>
  
  <entry>
    <title>GEO数据挖掘</title>
    <link href="https://cldiao.github.io/2018/12/12/GEO%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/"/>
    <id>https://cldiao.github.io/2018/12/12/GEO数据挖掘/</id>
    <published>2018-12-12T08:23:08.000Z</published>
    <updated>2019-03-27T05:29:07.359Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-表达矩阵下载"><a href="#1-表达矩阵下载" class="headerlink" title="1.表达矩阵下载"></a>1.表达矩阵下载</h2><ul><li><p>GEO Raw data(不推荐)</p></li><li><p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42872" target="_blank" rel="noopener">网页下载 </a> Series Matrix File(s)</p></li><li><p>R-GEOquery</p><a id="more"></a><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download the matrix</span></span><br><span class="line"><span class="keyword">library</span>(GEOquery)</span><br><span class="line"><span class="keyword">library</span>(stringr)</span><br><span class="line"></span><br><span class="line">gset &lt;- getGEO(<span class="string">'GSE42872'</span>, destdir=<span class="string">"."</span>, AnnotGPL = <span class="literal">F</span>, getGPL = <span class="literal">F</span>)</span><br><span class="line">save(gset, file = <span class="string">"GSE42872.gset.Rdata"</span>)</span><br><span class="line">load(<span class="string">'GSE42872.gset.Rdata'</span>)</span><br><span class="line"><span class="comment"># gset is a list.</span></span><br><span class="line">mar &lt;- gset[[<span class="number">1</span>]]</span><br><span class="line"><span class="comment"># expression matrix </span></span><br><span class="line">raw_exprSet &lt;- exprs(mar)</span><br><span class="line"><span class="comment"># phenotype</span></span><br><span class="line">phe &lt;- pData(mar)</span><br><span class="line"><span class="comment"># grouplist</span></span><br><span class="line">group_list &lt;- str_split(as.character(phe$title), <span class="string">' '</span>, simplify = <span class="literal">T</span>)[,<span class="number">4</span>]</span><br><span class="line"><span class="comment"># store the data</span></span><br><span class="line">save(raw_exprSet, group_list, file = <span class="string">"GSE42872.gset.Rdata"</span>)</span><br></pre></td></tr></table></figure><p><a href="http://www.bio-info-trainee.com/2087.html" target="_blank" rel="noopener">R来完成表达芯片分析全流程</a></p><p><a href="https://vip.biotrainee.com/d/342-geo" target="_blank" rel="noopener">从GEO数据库下载得到表达矩阵 一文就够</a></p></li></ul><h2 id="2-测试基因的表达-ID转换"><a href="#2-测试基因的表达-ID转换" class="headerlink" title="2.  测试基因的表达,ID转换"></a>2.  测试基因的表达,ID转换</h2><p><a href="http://www.bio-info-trainee.com/1399.html" target="_blank" rel="noopener">用R获取芯片探针与基因的对应关系三部曲-bioconductor</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># transfer probe id to gene symbol, some arraies' annotations have packages</span></span><br><span class="line"><span class="keyword">library</span>(hugene10sttranscriptcluster.db)</span><br><span class="line"><span class="comment"># get the table of probe and symbol.</span></span><br><span class="line">eg2proble &lt;- toTable(hugene10sttranscriptclusterSYMBOL)</span><br><span class="line"><span class="comment"># test a gene </span></span><br><span class="line">eg2proble[eg2proble$symbol == <span class="string">'TRAF4'</span>,]</span><br><span class="line">raw_exprSet[<span class="number">1</span>:<span class="number">4</span>, <span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line"><span class="comment"># normalization of the expression</span></span><br><span class="line">exprSet &lt;- log2(raw_exprSet)</span><br><span class="line"><span class="comment"># check TRAF4's expression in all samples</span></span><br><span class="line">dat &lt;- data.frame(gene = exprSet[<span class="string">'8005978'</span>,], mut = group_list)</span><br><span class="line">head(dat)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  boxplot of TRAF4 expression with ggpubr</span></span><br><span class="line"><span class="keyword">library</span>(ggpubr)</span><br><span class="line">p &lt;- ggboxplot(dat, x = <span class="string">"mut"</span>, y = <span class="string">"gene"</span>, color = <span class="string">"mut"</span>, palette = <span class="string">"jco"</span>, add = <span class="string">"jitter"</span>)</span><br><span class="line">p = p +stat_compare_means(method = <span class="string">"t.test"</span>)</span><br><span class="line">p</span><br><span class="line"><span class="comment"># plots with statistical details</span></span><br><span class="line"><span class="keyword">library</span>(ggstatsplot)</span><br><span class="line">ggbetweenstats(data = dat, x = mut, y = gene)</span><br><span class="line"><span class="comment"># boxplot of TRAF4 expression with ggplot2</span></span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">ggplot(dat, aes(x = mut, y = gene))+</span><br><span class="line">  geom_boxplot()+</span><br><span class="line">  theme_bw()</span><br></pre></td></tr></table></figure><p><img src="D:\forR\project\geoquery\1.png" alt=""></p><p><img src="D:\forR\project\geoquery\2.png" alt=""></p><p><img src="D:\forR\project\geoquery\3.png" alt=""></p><h2 id="3-表达矩阵过滤"><a href="#3-表达矩阵过滤" class="headerlink" title="3.表达矩阵过滤"></a>3.表达矩阵过滤</h2><h2 id="4-差异分析"><a href="#4-差异分析" class="headerlink" title="4. 差异分析"></a>4. 差异分析</h2><p><a href="https://vip.biotrainee.com/d/116-limma" target="_blank" rel="noopener">用limma对芯片数据做差异分析</a></p><h2 id="5-富集分析"><a href="#5-富集分析" class="headerlink" title="5. 富集分析"></a>5. 富集分析</h2><h2 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-表达矩阵下载&quot;&gt;&lt;a href=&quot;#1-表达矩阵下载&quot; class=&quot;headerlink&quot; title=&quot;1.表达矩阵下载&quot;&gt;&lt;/a&gt;1.表达矩阵下载&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;GEO Raw data(不推荐)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42872&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;网页下载 &lt;/a&gt; Series Matrix File(s)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;R-GEOquery&lt;/p&gt;
    
    </summary>
    
    
      <category term="GEO" scheme="https://cldiao.github.io/tags/GEO/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令行与shell脚本编程大全学习笔记第三章</title>
    <link href="https://cldiao.github.io/2018/12/06/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B%E5%A4%A7%E5%85%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://cldiao.github.io/2018/12/06/linux命令行与shell脚本编程大全学习笔记/</id>
    <published>2018-12-06T06:54:14.000Z</published>
    <updated>2019-04-06T06:45:33.532Z</updated>
    
    <content type="html"><![CDATA[<h1 id="第三章：基本的bash-shell-命令"><a href="#第三章：基本的bash-shell-命令" class="headerlink" title="第三章：基本的bash shell 命令"></a>第三章：基本的bash shell 命令</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><h3 id="1-man命令"><a href="#1-man命令" class="headerlink" title="1. man命令:"></a>1. man命令:</h3><p>用来访问存储在Linux系统上的手册页面。在想要查找的工具的名称前面输入man命令，就可以找到那个工具相应的手册条目。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ man touch</span><br><span class="line">NAME</span><br><span class="line">       touch - change file timestamps</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       touch [OPTION]... FILE...</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       Update the access and modification times of each FILE to the current time.</span><br><span class="line"></span><br><span class="line">       A FILE argument that does not exist is created empty, unless -c or -h is supplied.</span><br><span class="line"></span><br><span class="line">       A FILE argument string of - is handled specially and causes touch to change the times of the file associated with standard output.</span><br><span class="line"></span><br><span class="line">       Mandatory arguments to long options are mandatory for short options too.</span><br><span class="line"></span><br><span class="line">       -a     change only the access time</span><br><span class="line"></span><br><span class="line">       -c, --no-create</span><br><span class="line">              do not create any files</span><br><span class="line"></span><br><span class="line">       -d, --date=STRING</span><br><span class="line">              parse STRING and use it instead of current time</span><br><span class="line"></span><br><span class="line">       -f     (ignored)</span><br><span class="line"></span><br><span class="line">       -h, --no-dereference</span><br><span class="line">              affect each symbolic link instead of any referenced file (useful only on systems that can change the timestamps of a symlink)</span><br><span class="line"></span><br><span class="line">       -m     change only the modification time</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="2-制表键自动补全：Tab"><a href="#2-制表键自动补全：Tab" class="headerlink" title="2. 制表键自动补全：Tab"></a>2. 制表键自动补全：<code>Tab</code></h3><p>制表键自动补全可以子啊输入文件名或目录名时按<code>Tab</code>键，让shell将内容补充完整。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ cd biosoft/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$</span><br></pre></td></tr></table></figure><p>输入cp bow后按<code>Tab</code>键，文件名/文件夹名可以自动补全。</p><h3 id="3-绝对路径："><a href="#3-绝对路径：" class="headerlink" title="3. 绝对路径："></a>3. 绝对路径：</h3><p>定义目录的确切位置，以虚拟目录的根目录开始，相当于目录的全名。总是以<code>/</code>作为起始。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ cd /home/vip5/biosoft/bowtie/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$</span><br></pre></td></tr></table></figure><p>显示当前所处位置:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ pwd</span><br><span class="line">/home/vip5</span><br></pre></td></tr></table></figure><h3 id="4-相对路径："><a href="#4-相对路径：" class="headerlink" title="4. 相对路径："></a>4. 相对路径：</h3><p>指定一个基于当前位置的目标文件路径。以目录名或一个特殊字符开始。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ ls </span><br><span class="line">anaconda  bowtie</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ pwd</span><br><span class="line">/home/vip5/biosoft</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ cd bowtie/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$</span><br></pre></td></tr></table></figure><h3 id="5-列表命令-ls"><a href="#5-列表命令-ls" class="headerlink" title="5. 列表命令: ls"></a>5. 列表命令: ls</h3><p>显示当前目录下的文件和目录：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls </span><br><span class="line">biosoft  readme.txt  test</span><br></pre></td></tr></table></figure><p>-F 参数可以轻松区分文件和目录。目录后加了<code>/</code>，可执行文件后加了<code>*</code>。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -F</span><br><span class="line">biosoft/  readme.txt  test/</span><br></pre></td></tr></table></figure><p>-a 参数可以把隐藏文件和普通文件及目录一起显示。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -a</span><br><span class="line">.   .bash_history  biosoft  .conda    readme.txt  .vim</span><br><span class="line">..  .bashrc        .cache   .condarc  test        .viminfo</span><br></pre></td></tr></table></figure><p>-R 参数列出当前目录下包含的子目录中的文件。目录 很庞大，输出会很长。</p><p>-l 显示附加信息，会产生长列表格式的输出，包括文件类型，权限，属主，属组，大小，上次修改时间，文件名。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ ls -l</span><br><span class="line">total 12</span><br><span class="line">drwxrwxr-x 4 vip5 vip5 4096 Nov 13 16:12 biosoft</span><br><span class="line">-rw-r--r-- 1 root root  207 Nov 11 20:33 readme.txt</span><br><span class="line">drwxrwxr-x 2 vip5 vip5 4096 Nov 12 10:01 test</span><br></pre></td></tr></table></figure><p>-l 后可以添加过滤器：</p><ul><li><p><code>？</code>代表一个字符</p></li><li><p><code>*</code>代表零个或多个字符</p></li><li><p><code>[]</code>代表一个字符位置并给出多个可能选择</p></li><li><p><code>!</code>将不需要的内容排除</p><p>(两种符号可以放在过滤器的任意位置)</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$ ls</span><br><span class="line">bowtie2-2.3.4.3  bowtie2-2.3.4.3-source.zip</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$ ls -l bowtie2-2.3.4.3-source.zip </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 17156180 Sep 17 13:02 bowtie2-2.3.4.3-source.zip</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$ ls -l bowtie2-2.3.4.3-sour?e.zip </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 17156180 Sep 17 13:02 bowtie2-2.3.4.3-source.zip</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft/bowtie$ ls -l *.zip </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 17156180 Sep 17 13:02 bowtie2-2.3.4.3-source.zip</span><br></pre></td></tr></table></figure><h3 id="6-创建文件：touch"><a href="#6-创建文件：touch" class="headerlink" title="6. 创建文件：touch"></a>6. 创建文件：touch</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ touch test_one</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test_one </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 21:54 test_one</span><br></pre></td></tr></table></figure><p>改变文件的修改时间</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test_one </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 21:54 test_one</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ touch test_one</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test_one </span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 21:57 test_one</span><br></pre></td></tr></table></figure><h3 id="7-复制文件-cp"><a href="#7-复制文件-cp" class="headerlink" title="7. 复制文件: cp"></a>7. 复制文件: cp</h3><p>cp命令需要两个参数——源对象和目标对象：<code>cp source destination</code></p><p>当二者都是文件名时，cp命令将源文件复制成一个新文件，命名为后者。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cp test_one  test_two</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test_*</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 21:57 test_one</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:10 test_two</span><br></pre></td></tr></table></figure><p>两个文件的修改时间不同。-i选项会在目标文件存在的情况下询问是否覆盖。不回答y，复制会中止。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l test_*</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 21:57 test_one</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:10 test_two</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ cp -i test_one test_two </span><br><span class="line">cp: overwrite 'test_two'? n</span><br></pre></td></tr></table></figure><p>也可以将文件复制到现有目录中。目录可以使用绝对路径或者相对路径。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cp -i test_one /home/vip5/biosoft/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l /home/vip5/biosoft</span><br><span class="line">total 8</span><br><span class="line">drwxrwxr-x 3 vip5 vip5 4096 Nov 13 16:28 anaconda</span><br><span class="line">drwxrwxr-x 3 vip5 vip5 4096 Nov 13 21:29 bowtie</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5    0 Dec  6 22:16 test_one</span><br></pre></td></tr></table></figure><p>相对路径可以使用特殊符号，其中<code>.</code>表示当前工作目录。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cp -i /home/vip5/biosoft/bowtie/bowtie2-2.3.4.3/VERSION .</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l VERSION </span><br><span class="line">-rw-r--r-- 1 vip5 vip5 8 Dec  6 22:39 VERSION</span><br></pre></td></tr></table></figure><p>-R参数，递归地复制整个目录的内容。</p><p>也可以使用通配符。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ cp *one test/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/biosoft$ ls -l test_one</span><br><span class="line">-rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:16 test_one</span><br></pre></td></tr></table></figure><h3 id="8-移动-重命名文件：mv"><a href="#8-移动-重命名文件：mv" class="headerlink" title="8. 移动/重命名文件：mv"></a>8. 移动/重命名文件：mv</h3><p>Linux中，重命名文件成为移动（moving）。mv命令可以将文件和目录移动到另一个位置或重新命名。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li f?ll</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:58 fall</span><br><span class="line">30415747 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:57 fell</span><br><span class="line">30415748 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:57 fill</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ mv fall fzll</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li f?ll</span><br><span class="line">30415747 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:57 fell</span><br><span class="line">30415748 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:57 fill</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:58 fzll</span><br></pre></td></tr></table></figure><p>mv可以更改文件名，不改变inode编号和时间戳。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li </span><br><span class="line">total 4428</span><br><span class="line">30408713 -rw-rw-r-- 1 vip5 vip5 4524262 Oct 30 08:22 10.1038@s41556-018-0219-8.pdf</span><br><span class="line">30415747 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:57 fell</span><br><span class="line">30415748 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:57 fill</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:58 fzll</span><br><span class="line"> 3672325 drwxrwxr-x 2 vip5 vip5    4096 Dec  6 22:50 test_a</span><br><span class="line">30415653 -rw-rw-r-- 1 vip5 vip5       0 Dec  6 21:57 test_one</span><br><span class="line">30415654 -rw-rw-r-- 1 vip5 vip5       0 Dec  6 22:10 test_two</span><br><span class="line">30415656 -rw-r--r-- 1 vip5 vip5       8 Dec  6 22:39 VERSION</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li test_a/</span><br><span class="line">total 0</span><br><span class="line">3672326 -rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:50 test_one</span><br><span class="line">3672327 -rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:50 test_two</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ mv fzll test_a/</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li test_a/</span><br><span class="line">total 0</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:58 fzll</span><br><span class="line"> 3672326 -rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:50 test_one</span><br><span class="line"> 3672327 -rw-rw-r-- 1 vip5 vip5 0 Dec  6 22:50 test_two</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li fzll</span><br><span class="line">ls: cannot access 'fzll': No such file or directory</span><br></pre></td></tr></table></figure><p>mv也可以移动文件的位置。如上，将fzll从/test移动到/test/test_a。没有改变文件的inode编号或时间戳。使用-i参数同样可以在试图覆盖已有文件时得到提示。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li test_a/fzll</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5 0 Dec 11 16:58 test_a/fzll</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ mv test_a/fzll  fall</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li </span><br><span class="line">total 4428</span><br><span class="line">30408713 -rw-rw-r-- 1 vip5 vip5 4524262 Oct 30 08:22 10.1038@s41556-018-0219-8.pdf</span><br><span class="line">30415746 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:58 fall</span><br><span class="line">30415747 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:57 fell</span><br><span class="line">30415748 -rw-rw-r-- 1 vip5 vip5       0 Dec 11 16:57 fill</span><br><span class="line"> 3672325 drwxrwxr-x 2 vip5 vip5    4096 Dec 11 17:07 test_a</span><br><span class="line">30415653 -rw-rw-r-- 1 vip5 vip5       0 Dec  6 21:57 test_one</span><br><span class="line">30415654 -rw-rw-r-- 1 vip5 vip5       0 Dec  6 22:10 test_two</span><br><span class="line">30415656 -rw-r--r-- 1 vip5 vip5       8 Dec  6 22:39 VERSION</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li test_a/fzll</span><br><span class="line">ls: cannot access 'test_a/fzll': No such file or directory</span><br></pre></td></tr></table></figure><p>mv命令也可以同时移动文件位置并修改文件名称。</p><h3 id="9-删除文件：rm"><a href="#9-删除文件：rm" class="headerlink" title="9. 删除文件：rm"></a>9. 删除文件：rm</h3><p>Linux中删除称为一处（removing)。命令为rm。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls</span><br><span class="line">10.1038@s41556-018-0219-8.pdf  fell  test_a    test_two</span><br><span class="line">fall                           fill  test_one  VERSION</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ rm -i fall</span><br><span class="line">rm: remove regular empty file 'fall'? y</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l fall</span><br><span class="line">ls: cannot access 'fall': No such file or directory</span><br></pre></td></tr></table></figure><p>-i提示是否真的要删除。bash shell中没有回收站，使用rm命令时要养成加入-i参数的好习惯。</p><p>-f强制删除，小心使用。</p><h3 id="10-创建目录：mkdir"><a href="#10-创建目录：mkdir" class="headerlink" title="10. 创建目录：mkdir"></a>10. 创建目录：mkdir</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ mkdir new_dir</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -ld new_dir/</span><br><span class="line">drwxrwxr-x 2 vip5 vip5 4096 Dec 21 21:40 new_dir/</span><br></pre></td></tr></table></figure><p>系统创建了一个new_dir的新目录。</p><p>当需要批量的创建目录和子目录时，需要-p参数。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ mkdir -p new_dir1/sub_dir/under_dir</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -R new_dir1/</span><br><span class="line">new_dir1/:</span><br><span class="line">sub_dir</span><br><span class="line"></span><br><span class="line">new_dir1/sub_dir:</span><br><span class="line">under_dir</span><br><span class="line"></span><br><span class="line">new_dir1/sub_dir/under_dir:</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure><p>-p参数可以创建缺失的父目录。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ mkdir -p new_dir2/new_dir1</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -R new_dir2</span><br><span class="line">new_dir2:</span><br><span class="line">new_dir1</span><br><span class="line"></span><br><span class="line">new_dir2/new_dir1:</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure><h3 id="11-删除目录：rmdir"><a href="#11-删除目录：rmdir" class="headerlink" title="11. 删除目录：rmdir"></a>11. 删除目录：rmdir</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ touch new_dir/my_file</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -li new_dir</span><br><span class="line">total 0</span><br><span class="line">32254887 -rw-rw-r-- 1 vip5 vip5 0 Dec 21 21:49 my_file</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ rmdir new_dir</span><br><span class="line">rmdir: failed to remove 'new_dir': Directory not empty</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure><p>默认情况下，rmdir命令只能删除空的目录。因为new_dir目录下有文件my_file，rmdir命令拒绝删除目录。</p><p>要解决问题要先删除目录中的文件。然后才能在空目录上使用rmdir命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ rm -i new_dir/my_file </span><br><span class="line">rm: remove regular empty file 'new_dir/my_file'? y</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ rmdir new_dir</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -ld new_dir</span><br><span class="line">ls: cannot access 'new_dir': No such file or directory</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$</span><br></pre></td></tr></table></figure><p>因为rmdir没有-i参数，所以只能删除空的目录。</p><p>非空目录的删除也可以使用rm命令。-r参数可以删除其中的文件再删除目录本身。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l new_dir1</span><br><span class="line">total 4</span><br><span class="line">drwxrwxr-x 3 vip5 vip5 4096 Dec 21 21:43 sub_dir</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ rm -ri new_dir1</span><br><span class="line">rm: descend into directory 'new_dir1'? y</span><br><span class="line">rm: descend into directory 'new_dir1/sub_dir'? y</span><br><span class="line">rm: remove directory 'new_dir1/sub_dir/under_dir'? y</span><br><span class="line">rm: remove directory 'new_dir1/sub_dir'? y</span><br><span class="line">rm: remove directory 'new_dir1'? y</span><br><span class="line">vip5@VM-0-15-ubuntu:~/test$ ls -l new_dir1</span><br><span class="line">ls: cannot access 'new_dir1': No such file or directory</span><br></pre></td></tr></table></figure><p> 这种方法可以向下进入多个子目录，需要确认每个文件是否需要被删除。</p><p>一口气删除目录及其所有内容的终极大法就是使用带有-r参数和-f参数的rm命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ tree test/</span><br><span class="line">test/</span><br><span class="line">├── 10.1038@s41556-018-0219-8.pdf</span><br><span class="line">├── fell</span><br><span class="line">├── fill</span><br><span class="line">├── new_dir2</span><br><span class="line">│   └── new_dir1</span><br><span class="line">├── test_a</span><br><span class="line">│   ├── test_one</span><br><span class="line">│   └── test_two</span><br><span class="line">├── test_one</span><br><span class="line">├── test_two</span><br><span class="line">└── VERSION</span><br><span class="line"></span><br><span class="line">3 directories, 8 files</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ rm -rf test/</span><br><span class="line">vip5@VM-0-15-ubuntu:~$ tree test/</span><br><span class="line">test/ [error opening dir]</span><br><span class="line"></span><br><span class="line">0 directories, 0 files</span><br></pre></td></tr></table></figure><p>rm -rf命令既没有警告信息， 也没有声音提示。尤其是有超级用户权限的时候！！</p><h3 id="12-查看文件类型：file"><a href="#12-查看文件类型：file" class="headerlink" title="12. 查看文件类型：file"></a>12. 查看文件类型：file</h3><p>file命令能够探测文件的内部，并决定文件时什么类型的。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ file readme.txt </span><br><span class="line">readme.txt: ASCII text</span><br><span class="line">vip5@VM-0-15-ubuntu:~$</span><br></pre></td></tr></table></figure><p>file命令还可以区分目录、展示链接文件、脚本文件的返回结果、确定二进制程序的平台及所需的库。</p><h3 id="13-查看整个文件：cat-more-less"><a href="#13-查看整个文件：cat-more-less" class="headerlink" title="13.查看整个文件：cat, more, less"></a>13.查看整个文件：cat, more, less</h3><ul><li><p>cat</p><p>cat命令时显示文本文件中所有数据的得力助手。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~$ cat readme.txt </span><br><span class="line">Welcome to Biotrainee() !</span><br><span class="line">This is your personal account in our Cloud. </span><br><span class="line">Have a fun with it.</span><br><span class="line">Please feel free to contact with me( email to jmzeng1314@163.com )</span><br><span class="line">(http://www.biotrainee.com/thread-1376-1-1.html)</span><br></pre></td></tr></table></figure><p>-n 参数会给所有行加上行号，检查脚本时很有用。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat -n my_file.txt </span><br><span class="line">     1  Hello</span><br><span class="line">     2  </span><br><span class="line">     3  world</span><br><span class="line">     4  </span><br><span class="line">     5  this is rumble.</span><br></pre></td></tr></table></figure><p>-b参数可以只给有文本的行加上行号。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat -b my_file.txt </span><br><span class="line">     1  Hello</span><br><span class="line"></span><br><span class="line">     2  world</span><br><span class="line"></span><br><span class="line">     3  this is rumble.</span><br></pre></td></tr></table></figure><p>-T参数可以用^I替换文中的所有制表符。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat -T my_file.txt </span><br><span class="line">Hello</span><br><span class="line"></span><br><span class="line">world</span><br><span class="line"></span><br><span class="line">this is^Irumble.</span><br></pre></td></tr></table></figure><p>cat命令对于大型文件并不友好，文件的文本会在显示器上一晃而过。</p></li><li><p>more</p><p>more命令显示文本文件的内容，但会在显示每页数据之后停下来。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ more /etc/bash.bashrc</span><br><span class="line"><span class="meta">#</span><span class="bash"> System-wide .bashrc file <span class="keyword">for</span> interactive bash(1) shells.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> To <span class="built_in">enable</span> the settings / commands <span class="keyword">in</span> this file <span class="keyword">for</span> login shells as well,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> this file has to be sourced <span class="keyword">in</span> /etc/profile.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> If not running interactively, don<span class="string">'t do anything</span></span></span><br><span class="line">[ -z "$PS1" ] &amp;&amp; return</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> check the window size after each <span class="built_in">command</span> and, <span class="keyword">if</span> necessary,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> update the values of LINES and COLUMNS.</span></span><br><span class="line">shopt -s checkwinsize</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> variable identifying the chroot you work <span class="keyword">in</span> (used <span class="keyword">in</span> the prompt below)</span></span><br><span class="line">if [ -z "$&#123;debian_chroot:-&#125;" ] &amp;&amp; [ -r /etc/debian_chroot ]; then</span><br><span class="line">    debian_chroot=$(cat /etc/debian_chroot)</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> a fancy prompt (non-color, overwrite the one <span class="keyword">in</span> /etc/profile)</span></span><br><span class="line">PS1='$&#123;debian_chroot:+($debian_chroot)&#125;\u@\h:\w\$ '</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Commented out, don<span class="string">'t overwrite xterm -T "title" -n "icontitle" by default.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> If this is an xterm <span class="built_in">set</span> the title to user@host:dir</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">case</span> <span class="string">"<span class="variable">$TERM</span>"</span> <span class="keyword">in</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">xterm*|rxvt*)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    PROMPT_COMMAND=<span class="string">'echo -ne "\033]0;$&#123;USER&#125;@$&#123;HOSTNAME&#125;: $&#123;PWD&#125;\007"'</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">    ;;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">*)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    ;;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">esac</span></span></span><br></pre></td></tr></table></figure><p>只支持文本的基本移动，空格/回车键。</p></li><li><p>less<br>less命令实际是more命令的升级版（less is more)。除more的功能外，还识别上下键翻页。</p></li></ul><h3 id="14-查看部分文件：tail-head"><a href="#14-查看部分文件：tail-head" class="headerlink" title="14.查看部分文件：tail, head,"></a>14.查看部分文件：tail, head,</h3><ul><li><p>tail命令会显示文件的最后几行的内容，默认显示文件末尾10行。</p><p> 首先创建一个二十行的文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ cat -n my_file.txt </span><br><span class="line">     1  line1</span><br><span class="line">     2  line2</span><br><span class="line">     3  line3</span><br><span class="line">     4  line4</span><br><span class="line">     5  line5</span><br><span class="line">     6  Hello World - line 6</span><br><span class="line">     7  line7</span><br><span class="line">     8  line8</span><br><span class="line">     9  line9</span><br><span class="line">    10  line10</span><br><span class="line">    11  line11</span><br><span class="line">    12  Hello again - line 12</span><br><span class="line">    13  line13</span><br><span class="line">    14  line14</span><br><span class="line">    15  line15</span><br><span class="line">    16  Sweet - line16</span><br><span class="line">    17  line17</span><br><span class="line">    18  line18</span><br><span class="line">    19  line19</span><br><span class="line">    20  Last line - line20</span><br></pre></td></tr></table></figure><p>查看后十行。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ tail my_file.txt </span><br><span class="line">line11</span><br><span class="line">Hello again - line 12</span><br><span class="line">line13</span><br><span class="line">line14</span><br><span class="line">line15</span><br><span class="line">Sweet - line16</span><br><span class="line">line17</span><br><span class="line">line18</span><br><span class="line">line19</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><p>-n参数修改所显示的行数。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ tail -n 2 my_file.txt </span><br><span class="line">line19</span><br><span class="line">Last line - line20</span><br></pre></td></tr></table></figure><p>-f参数可以实时监测文件内容。</p></li><li><p>head</p><p>显示文件前10行的文本。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vip5@VM-0-15-ubuntu:~/test$ head my_file.txt </span><br><span class="line">line1</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">Hello World - line 6</span><br><span class="line">line7</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">line10</span><br></pre></td></tr></table></figure><p>-n/-f参数同样支持。</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;第三章：基本的bash-shell-命令&quot;&gt;&lt;a href=&quot;#第三章：基本的bash-shell-命令&quot; class=&quot;headerlink&quot; title=&quot;第三章：基本的bash shell 命令&quot;&gt;&lt;/a&gt;第三章：基本的bash shell 命令&lt;/h1&gt;&lt;h2 id=&quot;目录&quot;&gt;&lt;a href=&quot;#目录&quot; class=&quot;headerlink&quot; title=&quot;目录&quot;&gt;&lt;/a&gt;目录&lt;/h2&gt;&lt;h3 id=&quot;1-man命令&quot;&gt;&lt;a href=&quot;#1-man命令&quot; class=&quot;headerlink&quot; title=&quot;1. man命令:&quot;&gt;&lt;/a&gt;1. man命令:&lt;/h3&gt;&lt;p&gt;用来访问存储在Linux系统上的手册页面。在想要查找的工具的名称前面输入man命令，就可以找到那个工具相应的手册条目。&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vip5@VM-0-15-ubuntu:~/test$ man touch&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       touch - change file timestamps&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SYNOPSIS&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       touch [OPTION]... FILE...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DESCRIPTION&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       Update the access and modification times of each FILE to the current time.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       A FILE argument that does not exist is created empty, unless -c or -h is supplied.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       A FILE argument string of - is handled specially and causes touch to change the times of the file associated with standard output.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       Mandatory arguments to long options are mandatory for short options too.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -a     change only the access time&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -c, --no-create&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              do not create any files&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -d, --date=STRING&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              parse STRING and use it instead of current time&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -f     (ignored)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -h, --no-dereference&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              affect each symbolic link instead of any referenced file (useful only on systems that can change the timestamps of a symlink)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       -m     change only the modification time&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="linux, shell, bash" scheme="https://cldiao.github.io/tags/linux-shell-bash/"/>
    
  </entry>
  
  <entry>
    <title>GSEA实践:制作自己的gmt文件和chip文件</title>
    <link href="https://cldiao.github.io/2018/11/07/GSEA-%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E7%9A%84gmt%E6%96%87%E4%BB%B6%E5%92%8Cchip%E6%96%87%E4%BB%B6/"/>
    <id>https://cldiao.github.io/2018/11/07/GSEA-制作自己的gmt文件和chip文件/</id>
    <published>2018-11-07T15:22:43.000Z</published>
    <updated>2018-11-09T03:02:14.741Z</updated>
    
    <content type="html"><![CDATA[<h1 id="梯子"><a href="#梯子" class="headerlink" title="梯子"></a>梯子</h1><p><a href="http://www.omicsclass.com/article/223" target="_blank" rel="noopener">如何将GEO芯片注释文件整理成GSEA能使用的芯片注释文件？</a></p><p><a href="https://www.plob.org/article/12007.html" target="_blank" rel="noopener">GSEA分析支持的数据格式</a></p><p><a href="http://www.bio-info-trainee.com/2144.html" target="_blank" rel="noopener">制作自己的gene set文件给gsea软件</a></p><a id="more"></a><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>师姐讨论课题时看到一个gene set 十分合胃口。觉得我有能力解析一下！</p><p>来自一篇文献分享：<a href="https://www.nature.com/articles/ncomms10180" target="_blank" rel="noopener">Nuclear AURKA acquires kinase-independent<br>transactivating function to enhance breast cancer<br>stem cell phenotype</a></p><p>其中figer1f:</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/1.jpg" alt=""></p><p>注释为：<code>(f) Gene expression data acquired from a public database (GEO ID: GSE23541, the group of AURKAþDox and AURKA-Dox) were subjected to GSEA using the gene expression signature that was downregulated in the CD24low/CD44high-sphere population.</code></p><p>也就是用了GSE23541中的samples以CD44+/CD24-表型的一个gene set做GSEA分析。也就有了下面的解释：</p><p><code>We also performed gene set enrichment analysis (GSEA) and found that cells expressing low levels of AURKA showed a significant enrichment of genes that are downregulated in the CD24low/CD44high-sphere population.</code></p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>那么要进行GSEA分析，需要准备：</p><p>expression dataset, gene sets database, chip platform, phenotype labels四项内容。</p><h2 id="expression-dataset"><a href="#expression-dataset" class="headerlink" title="expression dataset"></a>expression dataset</h2><p>搜索<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE23541" target="_blank" rel="noopener">GSE24531</a>, 查看samples共有12个，其中前六个为图中研究的样本Aurka_R_+Dox, Aurka_R_-Dox。</p><p>下载GSE23541_non_normalized.txt.gz，修改内容得到六个样本的expression dataset。</p><h2 id="gene-set-database"><a href="#gene-set-database" class="headerlink" title="gene set database"></a>gene set database</h2><p>因为使用的是特定的set, GSEA的库中没有的话是需要自己制作的。</p><p>首先要获得gene，原文网站提供了下载<a href="http://www.pnas.org/content/suppl/2009/08/03/0905718106.DCSupplemental" target="_blank" rel="noopener">DATASET</a>。</p><p>gmt文件中，每行代表一个基因集，第一列是基因集的命名，第二列是简要介绍，后面为gene symbol。（第一列好像不要带符号，不然网页出不了图）</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/3.jpg" alt=""></p><h2 id="phenotype-labels"><a href="#phenotype-labels" class="headerlink" title="phenotype labels"></a>phenotype labels</h2><p>前面讲过，制作一个cls文件。</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/4.jpg" alt=""></p><h2 id="chip-platform"><a href="#chip-platform" class="headerlink" title="chip platform"></a>chip platform</h2><p>起初制作了以上三个文件，在选择在线chip时发现没有GSE23541对应的<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL6885" target="_blank" rel="noopener">GPL6885</a>Illumina MouseRef-8 v2.0 expression beadchip。</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/2.jpg" alt=""></p><p>那么就得自己制作chip文件了。</p><p>首先在GPL6885页面下载芯片的注释文件，解压后查看文件：</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/5.jpg" alt=""></p><p>上方是一些注释信息，下方第一列为ID, 第二列gene title, 第三列gene symbol。这三列使我们需要的信息。</p><p>提取这三列数据后，第一列列名改为Probe Set ID; 第二列和第三列更换顺序。删除含有空白的行（可以用Excel中的筛选功能）。</p><p>最后我们得到这样的文件：</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/6.jpg" alt=""></p><h1 id="运行GSEA"><a href="#运行GSEA" class="headerlink" title="运行GSEA"></a>运行GSEA</h1><p>load data and run GSEA.</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/7.jpg" alt=""></p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181107/enplot_CD44%2B_CD24-_3.png" alt=""></p><p>结果与原文有差异。需要探究一下。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;梯子&quot;&gt;&lt;a href=&quot;#梯子&quot; class=&quot;headerlink&quot; title=&quot;梯子&quot;&gt;&lt;/a&gt;梯子&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://www.omicsclass.com/article/223&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;如何将GEO芯片注释文件整理成GSEA能使用的芯片注释文件？&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.plob.org/article/12007.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GSEA分析支持的数据格式&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.bio-info-trainee.com/2144.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;制作自己的gene set文件给gsea软件&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="GSEA" scheme="https://cldiao.github.io/tags/GSEA/"/>
    
  </entry>
  
  <entry>
    <title>transcription factor binding site(TFBS) prediction</title>
    <link href="https://cldiao.github.io/2018/11/06/%E8%BD%AC%E5%BD%95%E5%9B%A0%E5%AD%90%E9%A2%84%E6%B5%8B/"/>
    <id>https://cldiao.github.io/2018/11/06/转录因子预测/</id>
    <published>2018-11-06T11:32:49.000Z</published>
    <updated>2018-11-06T16:14:29.131Z</updated>
    
    <content type="html"><![CDATA[<p>梯子：</p><p><a href="http://blog.sciencenet.cn/blog-3372875-1096783.html" target="_blank" rel="noopener">史上最全物种转录因子、motif数据库footprintDB</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjQ3MTU5Mg==&amp;mid=2650656785&amp;idx=1&amp;sn=a3b72ea64df125a190c3f7a1634a316c&amp;chksm=83b82c56b4cfa54033890e0cf52bed379f34bb2db372f83ec5d01e30b7272799906df58eecde&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">点鼠标就能找启动子区的motif | meme-FIMO</a></p><a id="more"></a>  <h2 id="转录因子数据库"><a href="#转录因子数据库" class="headerlink" title="转录因子数据库"></a>转录因子数据库</h2><p><a href="http://www.biotrainee.com/thread-1215-1-1.html" target="_blank" rel="noopener">footprintDB是目前为止我看到的最全的转录因子数据库</a>Jimmy师兄的评价。</p><h2 id="方法一：JASPAR-ENSEMBL-GENOME-BROSWER"><a href="#方法一：JASPAR-ENSEMBL-GENOME-BROSWER" class="headerlink" title="方法一：JASPAR+ENSEMBL GENOME BROSWER"></a>方法一：JASPAR+ENSEMBL GENOME BROSWER</h2><p>研究较多的转录因子在JASPAR上可以搜到，scan匹配想要分析的sequence即可。sequence可以从ensemble或者ucsc获取。</p><h2 id="方法二：footprintDB-MEME"><a href="#方法二：footprintDB-MEME" class="headerlink" title="方法二：footprintDB+MEME"></a>方法二：footprintDB+MEME</h2><p>当想要研究的转录因子在JASPAR中没有对应的motif时：</p><h3 id="第一步：搜索转录因子"><a href="#第一步：搜索转录因子" class="headerlink" title="第一步：搜索转录因子"></a>第一步：搜索转录因子</h3><p>打开<a href="http://floresta.eead.csic.es/footprintdb/index.php?search_entries" target="_blank" rel="noopener">footprintDB</a></p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/33.png" alt=""></p><p>以BPTF为例检索，既然JASPAR中没有，信息量应该不大，选择homo, 其它选择all</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/21.png" alt=""></p><p>找到了一个转录因子和一个motif</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/22.png" alt=""></p><p>在JASPAR中没有搜到，那么就没被收录，使用时需要转换motif格式。</p><h3 id="第二步：下载transfac文件"><a href="#第二步：下载transfac文件" class="headerlink" title="第二步：下载transfac文件"></a>第二步：下载transfac文件</h3><p>点击binding motifs下方蓝字链接，点击download下载TRANSFAC格式的motif，用meme自带的工具转换为meme格式的motif。</p><h3 id="第三步：-转换-transfac文件为-meme文件"><a href="#第三步：-转换-transfac文件为-meme文件" class="headerlink" title="第三步： 转换.transfac文件为.meme文件"></a>第三步： 转换.transfac文件为.meme文件</h3><p><a href="http://meme-suite.org/doc/motif_conversion.html" target="_blank" rel="noopener">Motif Conversion Utilities</a>：The MEME Suite provides tools for conversion to the MEME motif format from other popular motif formats. To use these tools, you need to <a href="http://meme-suite.org/doc/download.html" target="_blank" rel="noopener">download </a>and install a local copy of the MEME Suite software. MEME Suite can be compiled to run on OS X or <strong>Linux</strong>.</p><p><a href="http://meme-suite.org/doc/install.html?man_type=web#quick" target="_blank" rel="noopener">Quick Install (for Linux, OS X and Cygwin systems)</a></p><p>(这里我用的<strong>BIOLINUX</strong>，安装的时候有两个test fail.)</p><p><a href="http://meme-suite.org/doc/transfac2meme.html" target="_blank" rel="noopener">transfac2meme</a>：Convert a TRANSFAC ‘matrix.dat’ file into a MEME motif file suitable for use with MEME Suite programs.</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/24.png" alt=""></p><p>首先下载到的*.transfac文件内容如上图。在使用transfac2meme命令时输出：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Converted 0 motifs.</span><br><span class="line">Skipped 0 motifs.</span><br><span class="line">0 conversion errors.</span><br></pre></td></tr></table></figure><p>所以我去下载了JASPAR上已有转录因子的*.transfac查看。</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/25.png" alt=""></p><p>那么，我修改了BPTF的 .transfac内容，如下：</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/27.png" alt=""></p><p>转换成功。（这个问题google没什么答案，希望有大神能解答吧）</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/28.png" alt=""></p><p>然后新建文件*.meme。</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/29.png" alt=""></p><h3 id="第四步：-FIMO进行检测"><a href="#第四步：-FIMO进行检测" class="headerlink" title="第四步： FIMO进行检测"></a>第四步： FIMO进行检测</h3><p><a href="http://meme-suite.org/tools/fimo" target="_blank" rel="noopener">打开FIMO</a></p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/20181106/34.png" alt=""></p><p>上传motif的.meme文件和检测的序列，<code>start</code></p><p>等待运行（时间挺长的..)。可以收藏网页，回头再看，或者左侧有recent jobs。</p><h3 id="第五步：结果的展示"><a href="#第五步：结果的展示" class="headerlink" title="第五步：结果的展示"></a>第五步：结果的展示</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><h4 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h4><p>### </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;梯子：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://blog.sciencenet.cn/blog-3372875-1096783.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;史上最全物种转录因子、motif数据库footprintDB&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzAxMjQ3MTU5Mg==&amp;amp;mid=2650656785&amp;amp;idx=1&amp;amp;sn=a3b72ea64df125a190c3f7a1634a316c&amp;amp;chksm=83b82c56b4cfa54033890e0cf52bed379f34bb2db372f83ec5d01e30b7272799906df58eecde&amp;amp;scene=21#wechat_redirect&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;点鼠标就能找启动子区的motif | meme-FIMO&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="TFBS" scheme="https://cldiao.github.io/tags/TFBS/"/>
    
  </entry>
  
  <entry>
    <title>Analysis correlation between geneA and geneB using R2 platform</title>
    <link href="https://cldiao.github.io/2018/11/05/R2-platform/"/>
    <id>https://cldiao.github.io/2018/11/05/R2-platform/</id>
    <published>2018-11-05T08:50:29.000Z</published>
    <updated>2018-11-05T12:44:40.744Z</updated>
    
    <content type="html"><![CDATA[<p>用途：大样本验证</p><p>梯子：</p><a id="more"></a> <p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjQ3MTU5Mg==&amp;mid=2650657135&amp;idx=1&amp;sn=f1a390be1622675d78ac05c8676f5f84&amp;chksm=83b82d28b4cfa43e6393e5fd784a3d4df8b1708081bcf0ff3909d66893c8de43347bab038170&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">用别人的数据发自己的Science | 给你的文章加5分</a></p><p><a href="http://science.sciencemag.org/content/352/6282/227" target="_blank" rel="noopener">MYC regulates the antitumor immune response through CD47 and PD-L1</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjQ3MTU5Mg==&amp;mid=2650657155&amp;idx=1&amp;sn=beaef840cf22b1b0f0e26e85078c34e3&amp;chksm=83b82dc4b4cfa4d21fc7c6a2b7737bef6f06c545cdd41332a7a6c8b460c4749cd29f66e4b382&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">R2简介</a></p><p><a href="https://hgserver1.amc.nl/cgi-bin/r2/main.cgi" target="_blank" rel="noopener">R2 website</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjQ3MTU5Mg==&amp;mid=2650658414&amp;idx=1&amp;sn=92a59a9b63b1dbdae5cdd51d3289269b&amp;chksm=83b82a29b4cfa33f9062a2bf3ef9a7b9124607aade039b4b99adc8074006cfa2cc0dd89d1db3&amp;scene=0#rd" target="_blank" rel="noopener">R2的应用还在不断增加</a></p><p>我来实践：</p><h2 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h2><ol><li><p>single/multiple dataset nanlysis</p><p>但数据集中发现有超过30个结肠癌肿瘤数据集，所以可以选择multiple dataset</p></li><li><p>select an analysis</p><p>我想看两个gene的相关性所以选择2D gene overview</p><p><img src="C:\Users\DCL\Desktop\1.png" alt=""></p></li><li><p>select additional conditions</p><p>输入两个gene symbol</p></li><li><p>procee</p><p>点击<code>next</code></p></li></ol><h2 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h2><p>probeset overview</p><p>选择两个gene的探针，默认选择为最大值的探针（可以自行尝试）。</p><p>点击<code>next</code></p><p>R值按降序排列，搜索colon。</p><p><img src="https://hgserver1.amc.nl/r2/graph/xgv-SUPT6H-TERT-YYplot-1541421365.png" alt=""></p><p>可以看出两个gene是正相关关系。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用途：大样本验证&lt;/p&gt;
&lt;p&gt;梯子：&lt;/p&gt;
    
    </summary>
    
    
      <category term="R2, database, correlation" scheme="https://cldiao.github.io/tags/R2-database-correlation/"/>
    
  </entry>
  
  <entry>
    <title>if_publications 查询</title>
    <link href="https://cldiao.github.io/2018/10/30/if-publications-%E6%9F%A5%E8%AF%A2/"/>
    <id>https://cldiao.github.io/2018/10/30/if-publications-查询/</id>
    <published>2018-10-30T12:08:35.000Z</published>
    <updated>2018-10-30T12:09:25.782Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://guangchuangyu.github.io/cn/2018/07/scholar-impact-factor/" target="_blank" rel="noopener">scholar包检索期刊影响因子</a></p><a id="more"></a><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(scholar)</span><br><span class="line"><span class="keyword">library</span>(yyplot)</span><br><span class="line"><span class="comment"># if</span></span><br><span class="line">jn &lt;- c(<span class="string">"oncogene"</span>,</span><br><span class="line">       <span class="string">"cancer research"</span>,</span><br><span class="line">       <span class="string">"cancer letter"</span>,</span><br><span class="line">       <span class="string">"elife"</span>,</span><br><span class="line">       <span class="string">"cancer discovery"</span>,</span><br><span class="line">       <span class="string">"Proceedings of the National Academy of Sciences of the United States of America"</span>,</span><br><span class="line">       <span class="string">"cancer letters"</span>,</span><br><span class="line">       <span class="string">"journal of biological chemistry"</span>,</span><br><span class="line">       <span class="string">"molecular cancer"</span>,</span><br><span class="line">       <span class="string">"cancer prevention research"</span>,</span><br><span class="line">       <span class="string">"journal of investigative dermatology"</span>,</span><br><span class="line">       <span class="string">"journal of pineal research"</span>,</span><br><span class="line">       <span class="string">"Redox Biology"</span>)</span><br><span class="line">get_impactfactor(jn)</span><br><span class="line"><span class="comment"># A tibble: 13 x 4</span></span><br><span class="line">   Journal                                                                        Cites ImpactFactor Eigenfactor</span><br><span class="line">   &lt;chr&gt;                                                                          &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span><br><span class="line"> <span class="number">1</span> ONCOGENE                                                                       <span class="number">66411</span>         <span class="number">6.85</span>      <span class="number">0.0760</span></span><br><span class="line"> <span class="number">2</span> CANCER RESEARCH                                                               <span class="number">139291</span>         <span class="number">9.13</span>      <span class="number">0.130</span> </span><br><span class="line"> <span class="number">3</span> CA-A CANCER JOURNAL FOR CLINICIANS                                             <span class="number">28839</span>       <span class="number">245.</span>        <span class="number">0.0660</span></span><br><span class="line"> <span class="number">4</span> eLife                                                                          <span class="number">25592</span>         <span class="number">7.62</span>      <span class="number">0.196</span> </span><br><span class="line"> <span class="number">5</span> Cancer Discovery                                                               <span class="number">11896</span>        <span class="number">24.4</span>       <span class="number">0.0654</span></span><br><span class="line"> <span class="number">6</span> PROCEEDINGS OF THE NATIONAL ACADEMY OF SCIENCES OF THE UNITED STATES OF AMER~ <span class="number">637268</span>         <span class="number">9.50</span>      <span class="number">1.11</span>  </span><br><span class="line"> <span class="number">7</span> CANCER LETTERS                                                                 <span class="number">29311</span>         <span class="number">6.49</span>      <span class="number">0.0423</span></span><br><span class="line"> <span class="number">8</span> JOURNAL OF BIOLOGICAL CHEMISTRY                                               <span class="number">366247</span>         <span class="number">4.01</span>      <span class="number">0.321</span> </span><br><span class="line"> <span class="number">9</span> Molecular Cancer                                                               <span class="number">10301</span>         <span class="number">7.78</span>      <span class="number">0.0173</span></span><br><span class="line"><span class="number">10</span> Cancer Prevention Research                                                      <span class="number">5348</span>         <span class="number">4.02</span>      <span class="number">0.0119</span></span><br><span class="line"><span class="number">11</span> JOURNAL OF INVESTIGATIVE DERMATOLOGY                                           <span class="number">28457</span>         <span class="number">6.45</span>      <span class="number">0.0388</span></span><br><span class="line"><span class="number">12</span> JOURNAL OF PINEAL RESEARCH                                                      <span class="number">9079</span>        <span class="number">11.6</span>       <span class="number">0.0086</span></span><br><span class="line"><span class="number">13</span> Redox Biology                                                                   <span class="number">4083</span>         <span class="number">7.13</span>      <span class="number">0.0121</span></span><br></pre></td></tr></table></figure><p>其中7-13为实验室此前有文章发表的部分杂志。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># publication</span></span><br><span class="line"><span class="comment"># tiemout!!!</span></span><br><span class="line">x &lt;- get_publications(<span class="string">"61MwfeMAAAAJ"</span>)</span><br><span class="line">y &lt;- x %&gt;% select(year, author, journal, title)%&gt;%</span><br><span class="line">+ mutate(impactFactor = get_impactfactor(journal)$ImpactFactor)%&gt;%</span><br><span class="line">group_by(year)</span><br><span class="line">y</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://guangchuangyu.github.io/cn/2018/07/scholar-impact-factor/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;scholar包检索期刊影响因子&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="scholar, IF, publications" scheme="https://cldiao.github.io/tags/scholar-IF-publications/"/>
    
  </entry>
  
  <entry>
    <title>Pubmed趋势</title>
    <link href="https://cldiao.github.io/2018/10/28/pubmed%E8%B6%8B%E5%8A%BF/"/>
    <id>https://cldiao.github.io/2018/10/28/pubmed趋势/</id>
    <published>2018-10-28T13:58:55.000Z</published>
    <updated>2018-10-29T01:46:25.881Z</updated>
    
    <content type="html"><![CDATA[<p>感谢Y叔的工具<a href="https://guangchuangyu.github.io/cn/2017/11/pubmed-trend/" target="_blank" rel="noopener">传送门</a></p><a id="more"></a><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(yyplot)</span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">pm &lt;- pubmed_trend(<span class="string">"BPTF"</span>, year = <span class="number">2000</span>:<span class="number">2018</span>)</span><br><span class="line">p &lt;- ggplot(pm_b, aes(x = year, y = number))+</span><br><span class="line">  geom_bar(stat = <span class="string">"identity"</span>)+</span><br><span class="line">  theme_classic()</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/pubmed_trend/bptf.png" alt=""></p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/pubmed_trend/P_BPTF.png" alt=""></p><p>BPTF的研究很少。近今年多了一些。还是有机会好好做一下的。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;感谢Y叔的工具&lt;a href=&quot;https://guangchuangyu.github.io/cn/2017/11/pubmed-trend/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Pubmed, R, visualization" scheme="https://cldiao.github.io/tags/Pubmed-R-visualization/"/>
    
  </entry>
  
  <entry>
    <title>GSEA分析</title>
    <link href="https://cldiao.github.io/2018/10/18/GSEA%E5%88%86%E6%9E%90/"/>
    <id>https://cldiao.github.io/2018/10/18/GSEA分析/</id>
    <published>2018-10-18T07:07:34.000Z</published>
    <updated>2018-11-05T08:50:35.052Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GSEA-Gene-Set-Enrichment-Analysis"><a href="#GSEA-Gene-Set-Enrichment-Analysis" class="headerlink" title="GSEA(Gene Set Enrichment Analysis)"></a>GSEA(Gene Set Enrichment Analysis)</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>GSEA是一种鉴定一个基因集在两种生物状态间是否有统计学差异的计算方法。<a href="http://software.broadinstitute.org/gsea/doc/subramanian_tamayo_gsea_pnas.pdf" target="_blank" rel="noopener">Gene set enrichment analysis</a>一文介绍了详细的算法。<a id="more"></a></p><p>进行GSEA需要以下步骤：</p><ol><li>准备数据文件：<ul><li>表达数据（res, gct, pcl, txt)</li><li>表型标签文件（cls)</li><li>基因集文件（gmx, gmt)</li><li>注释文件(chip)</li></ul></li><li>将数据导入到GSEA。</li><li>设置分析参数并运行分析。</li><li>查看分析结果。</li></ol><h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p><a href="http://software.broadinstitute.org/gsea/downloads.jsp" target="_blank" rel="noopener">Download GSEA</a> </p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/1.png" alt=""></p><h2 id="Preparing-Data-Files"><a href="#Preparing-Data-Files" class="headerlink" title="Preparing Data Files"></a>Preparing Data Files</h2><table><thead><tr><th><strong>Data File</strong></th><th><strong>Content</strong></th><th><strong>Format</strong></th><th><strong>Source</strong></th></tr></thead><tbody><tr><td><a href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm#_Expression_Datasets" target="_blank" rel="noopener">Expression dataset</a></td><td>Contains features (genes or probes), samples, and an expression value for each feature in each sample. Expression data can come from any source (Affymetrix, Stanford cDNA, and so on).</td><td>res, gct, pcl, or txt</td><td>You create the file.</td></tr><tr><td><a href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm#_Phenotype_Labels" target="_blank" rel="noopener">Phenotype labels</a></td><td>Contains phenotype labels and associates each sample with a phenotype.</td><td>cls</td><td>You create the file or have GSEA create it for you.</td></tr><tr><td><a href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm#_Gene_Sets" target="_blank" rel="noopener">Gene sets</a></td><td>Contains one or more gene sets. For each gene set, gives the gene set name and list of features (genes or probes) in that gene set.</td><td>gmx or gmt</td><td>You use the files on the Broad ftp site, export gene sets from the Molecular Signature Database (MSigDb) or create your own gene sets file.</td></tr><tr><td><a href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideTEXT.htm#_DNA_Chip_(Array" target="_blank" rel="noopener">Chip annotations</a>_Annotations)</td><td>Lists each probe on a DNA chip and its matching HUGO gene symbol. Optional for the gene set enrichment analysis.</td><td>Chip</td><td>You use the files on the Broad ftp site, download the files from the GSEA web site, or create your own chip file.</td></tr></tbody></table><h2 id="Loading-Data"><a href="#Loading-Data" class="headerlink" title="Loading Data"></a>Loading Data</h2><p><a href="http://software.broadinstitute.org/gsea/downloads.jsp" target="_blank" rel="noopener"> P53 Sample Data</a>使用p53一栏三个样本数据。（试着运行这组数据，有报错。所以参考了数据格式）</p><p><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=gse1009" target="_blank" rel="noopener">GSE1009</a>数据整理：</p><p>制作一个表型的GSE1009.cls</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/3.PNG" alt=""></p><p>制作一个表达的GSE1009_series——matrix.txt</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/4.PNG" alt=""></p><p>有三种方式导入三个数据。</p><h2 id="Running-Analysis"><a href="#Running-Analysis" class="headerlink" title="Running Analysis"></a>Running Analysis</h2><p>点击RUN GSEA,设置分析参数：</p><ol><li><p>Required: 必填的参数。</p><ul><li>expression dataset: 输入的表达矩阵。</li><li>gene sets database: gene sets文件根据需要选择<a href="http://software.broadinstitute.org/gsea/msigdb/index.jsp" target="_blank" rel="noopener">MSigDB gene sets </a></li><li>number of permutations: 置换检验次数。初次试验个位数测试；次数越多，曲线越平滑。</li><li>Permutation type：选择置换的类型，是random phenotype还是random gene sets，一般每组样本数目大于7个时，建议选择phenotype，否则选择gene sets</li><li>chip platform: GEO数据来源会标注platform</li></ul></li><li><p>Basic: 有默认值的额外的参数。通常默认值即可。</p></li><li><p>Advanced: 通常不需要修改。</p></li></ol><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/2.png" alt=""></p><h2 id="Viewing-Analysis-Results"><a href="#Viewing-Analysis-Results" class="headerlink" title="Viewing Analysis Results"></a>Viewing Analysis Results</h2><p>点击左侧GSEA reports中sucess可以进入报告主页，里面的链接可以查看子报告。</p><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/5.PNG" alt=""></p><h3 id="snapshot解读"><a href="#snapshot解读" class="headerlink" title="snapshot解读"></a>snapshot解读</h3><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/gsea/6.png" alt=""></p><ul><li>上方绿色曲线展示ES的值得计算过程，从左到右每个基因对应一个ES值，练成线。最高峰为富集得分（ES）。在最左侧或最右侧有一个特别明显的峰的基因集通常是感兴趣的基因集。</li><li>总监部分每条线代表基因集中的一个基因，及其在基因集中的位置。</li><li>下方展示的是基因与表型关联的矩阵，红色为与第一个表型正相关。蓝色为与第二个表型正相关。</li></ul><h2 id="Leading-Edge-Analysis"><a href="#Leading-Edge-Analysis" class="headerlink" title="Leading Edge Analysis"></a>Leading Edge Analysis</h2><p><a href="http://software.broadinstitute.org/gsea/doc/desktop_tutorial.jsp" target="_blank" rel="noopener">Running the Leading Edge Analysis</a></p><p><a href="http://www.bio-info-trainee.com/1282.html" target="_blank" rel="noopener">用GSEA来做基因集富集分析</a></p><p><a href="http://www.bio-info-trainee.com/2144.html" target="_blank" rel="noopener">制作自己的gene set文件给gsea软件</a></p><p><a href="http://www.bio-info-trainee.com/2105.html" target="_blank" rel="noopener">java版本GSEA软件的ES score图片的修改</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;GSEA-Gene-Set-Enrichment-Analysis&quot;&gt;&lt;a href=&quot;#GSEA-Gene-Set-Enrichment-Analysis&quot; class=&quot;headerlink&quot; title=&quot;GSEA(Gene Set Enrichment Analysis)&quot;&gt;&lt;/a&gt;GSEA(Gene Set Enrichment Analysis)&lt;/h1&gt;&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;GSEA是一种鉴定一个基因集在两种生物状态间是否有统计学差异的计算方法。&lt;a href=&quot;http://software.broadinstitute.org/gsea/doc/subramanian_tamayo_gsea_pnas.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Gene set enrichment analysis&lt;/a&gt;一文介绍了详细的算法。
    
    </summary>
    
    
      <category term="GSEA," scheme="https://cldiao.github.io/tags/GSEA/"/>
    
  </entry>
  
  <entry>
    <title>R语言20题-学习笔记</title>
    <link href="https://cldiao.github.io/2018/09/27/R%E8%AF%AD%E8%A8%8020%E9%A2%98/"/>
    <id>https://cldiao.github.io/2018/09/27/R语言20题/</id>
    <published>2018-09-27T13:17:14.000Z</published>
    <updated>2018-10-29T01:47:01.151Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://www.bio-info-trainee.com/3409.html" target="_blank" rel="noopener">生信人的20个R语言习题</a></p><p><a href="http://www.bio-info-trainee.com/3415.html" target="_blank" rel="noopener">生信人的20个R语言习题的答案</a></p><h2 id="1-安装一些R包"><a href="#1-安装一些R包" class="headerlink" title="1.安装一些R包"></a>1.安装一些R包</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(c(<span class="string">'ALL'</span>,<span class="string">'CLL'</span>,<span class="string">'pasilla'</span>,<span class="string">'clusterProfiler'</span>)) </span><br><span class="line">biocLite(c(<span class="string">'airway'</span>,<span class="string">'DESeq2'</span>,<span class="string">'edgeR'</span>,<span class="string">'limma'</span>))</span><br><span class="line">install.packages(<span class="string">"reshape2"</span>, <span class="string">"ggplot2"</span>)</span><br></pre></td></tr></table></figure><h2 id="2-了解ExpressionSet对象，比如CLL包里面就有data-sCLLex-，找到它包含的元素，提取其表达矩阵-使用exprs函数-，查看其大小"><a href="#2-了解ExpressionSet对象，比如CLL包里面就有data-sCLLex-，找到它包含的元素，提取其表达矩阵-使用exprs函数-，查看其大小" class="headerlink" title="2.了解ExpressionSet对象，比如CLL包里面就有data(sCLLex) ，找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小"></a>2.了解ExpressionSet对象，比如<code>CLL</code>包里面就有<code>data(sCLLex)</code> ，找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小</h2><a id="more"></a><p>   参考：<a href="http://www.bio-info-trainee.com/bioconductor_China/software/limma.html" target="_blank" rel="noopener">http://www.bio-info-trainee.com/bioconductor_China/software/limma.html</a></p><p>   参考：<a href="https://github.com/bioconductor-china/basic/blob/master/ExpressionSet.md" target="_blank" rel="noopener">https://github.com/bioconductor-china/basic/blob/master/ExpressionSet.md</a></p>   <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(CLL) </span><br><span class="line"><span class="comment"># load package</span></span><br><span class="line">?CLL </span><br><span class="line"><span class="comment"># help</span></span><br><span class="line">data(CLL) </span><br><span class="line"><span class="comment"># load dataset</span></span><br><span class="line">sCLLex </span><br><span class="line"><span class="comment"># check the dataset: ExprssionSet</span></span><br><span class="line"><span class="comment"># ExpressionSet: Container for high-throughput assays and experimental metadata. The class is derived from eSet,and requires a matrix named exprs as assayData member.</span></span><br><span class="line">exprSet &lt;- exprs(sCLLex) </span><br><span class="line">dim(exprSet)</span><br><span class="line">exprSet[<span class="number">1</span>:<span class="number">5</span>,<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment"># exprs: These generic functions access the expression and error measurements of assay data stored in an object derived from the eSet-class.</span></span><br><span class="line"><span class="comment"># [1] 12625    22</span></span><br><span class="line">samples &lt;- sampleNames(sCLLex)</span><br><span class="line"><span class="comment"># sampleNames: These generic functions access the feature names (typically, gene or SNP identifiers) and sample names stored in an object derived from the eSet-class.</span></span><br><span class="line">pdata &lt;- pData(sCLLex)</span><br><span class="line"><span class="comment"># pData: These generic functions access the phenotypic data (e.g., covariates) and meta-data (e.g., descriptions of covariates) associated with an experiment.</span></span><br><span class="line">pdata</span><br><span class="line"><span class="comment"># check the pdata</span></span><br><span class="line">group_list &lt;- as.character(pdata[,<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h2 id="3-了解-str-head-help函数，作用于-第二步提取到的表达矩阵"><a href="#3-了解-str-head-help函数，作用于-第二步提取到的表达矩阵" class="headerlink" title="3.了解 str,head,help函数，作用于 第二步提取到的表达矩阵"></a>3.了解 str,head,help函数，作用于 第二步提取到的表达矩阵</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str(exprSet)</span><br><span class="line"><span class="comment"># str: Compactly display the internal structure of an R object, a diagnostic function and an alternative to summary (and to some extent, dput).</span></span><br><span class="line">head(exprSet)</span><br></pre></td></tr></table></figure><h2 id="4-安装并了解-hgu95av2-db-包-看看-ls-quot-package-hgu95av2-db-quot-后-显示的那些变量"><a href="#4-安装并了解-hgu95av2-db-包-看看-ls-quot-package-hgu95av2-db-quot-后-显示的那些变量" class="headerlink" title="4.安装并了解 hgu95av2.db 包,看看 ls(&quot;package:hgu95av2.db&quot;) 后 显示的那些变量"></a>4.安装并了解 <code>hgu95av2.db</code> 包,看看 <code>ls(&quot;package:hgu95av2.db&quot;)</code> 后 显示的那些变量</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"hgu95av2.db"</span>)</span><br><span class="line">??hgu95av2.db</span><br><span class="line"><span class="keyword">library</span>(hgu95av2.db)</span><br><span class="line">ls(<span class="string">"package:hgu95av2.db"</span>)</span><br><span class="line">columns(hgu95av2.db)</span><br><span class="line"><span class="comment"># columns shows which kinds of data can be returned for the AnnotationDb object.</span></span><br></pre></td></tr></table></figure><h2 id="5-理解-head-toTable-hgu95av2SYMBOL-的用法，找到-TP53-基因对应的探针ID"><a href="#5-理解-head-toTable-hgu95av2SYMBOL-的用法，找到-TP53-基因对应的探针ID" class="headerlink" title="5.理解 head(toTable(hgu95av2SYMBOL)) 的用法，找到 TP53 基因对应的探针ID"></a>5.理解 <code>head(toTable(hgu95av2SYMBOL))</code> 的用法，找到 TP53 基因对应的探针ID</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">head(toTable(hgu95av2SYMBOL))</span><br><span class="line"><span class="comment"># toTable: What we usually call "annotation maps" are in fact Bimap objects. Extract all the columns of the map</span></span><br><span class="line"><span class="comment">#   probe_id  symbol</span></span><br><span class="line"><span class="number">1</span>   1000_at   MAPK3</span><br><span class="line"><span class="number">2</span>   1001_at    TIE1</span><br><span class="line"><span class="number">3</span> 1002_f_at CYP2C19</span><br><span class="line"><span class="number">4</span> 1003_s_at   CXCR5</span><br><span class="line"><span class="number">5</span>   1004_at   CXCR5</span><br><span class="line"><span class="number">6</span>   1005_at   DUSP1</span><br><span class="line">ids &lt;- toTable(hgu95av2SYMBOL)</span><br><span class="line">View(ids)</span><br><span class="line">TP53 &lt;- c(<span class="string">"1939_at"</span>, <span class="string">"1974_s_at"</span>, <span class="string">"31618_at"</span>)</span><br></pre></td></tr></table></figure><h2 id="6-理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？"><a href="#6-理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？" class="headerlink" title="6.理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？"></a>6.理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">length(unique(ids$symbol))</span><br><span class="line"><span class="comment"># [1] 8585</span></span><br><span class="line"><span class="comment"># check the number of occurrences of every symbol in ids</span></span><br><span class="line"><span class="comment"># unique: returns a vector, data frame or array like x but with duplicate elements/rows removed.</span></span><br><span class="line">tail(sort(table(ids$symbol)))</span><br><span class="line"><span class="comment"># sort: Sort (or order) a vector or factor (partially) into ascending or descending order. </span></span><br><span class="line">plot(tail(sort(table(ids$symbol))))</span><br><span class="line"><span class="comment"># YME1L1  GAPDH INPP4A    MYB PTGER3  STAT1 </span></span><br><span class="line">   <span class="number">7</span>      <span class="number">8</span>      <span class="number">8</span>      <span class="number">8</span>      <span class="number">8</span>      <span class="number">8</span></span><br></pre></td></tr></table></figure><p><a href="http://www.affymetrix.com/support/help/faqs/mouse_430/faq_8.affx" target="_blank" rel="noopener"><em>What is a probe set? What do the different suffixes attached to a probe set name mean?</em></a></p><p><a href="https://www.ohsu.edu/xd/research/research-cores/gene-profiling-shared-resource/project-design/array-technology/affymetrix-genechip-arrays.cfm" target="_blank" rel="noopener">Probe Set Extension Nomenclature</a></p><h2 id="7（8）-第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵，找到那些不在-hgu95av2-db-包收录的对应着SYMBOL的探针。"><a href="#7（8）-第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵，找到那些不在-hgu95av2-db-包收录的对应着SYMBOL的探针。" class="headerlink" title="7（8）.第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵，找到那些不在 hgu95av2.db 包收录的对应着SYMBOL的探针。"></a>7（8）.第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵，找到那些不在 <code>hgu95av2.db</code> 包收录的对应着SYMBOL的探针。</h2><p>过滤表达矩阵，删除那1165个没有对应基因名字的探针。 </p><p>提示：有1165个探针是没有对应基因名字的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">table(rownames(exprSet)) %<span class="keyword">in</span>% ids$probe_id</span><br><span class="line"><span class="comment"># %in% is a more intuitive interface as a binary operator, which returns a logical vector indicating if there is a match or not for its left operand.</span></span><br><span class="line">n_exprSet &lt;- exprSet[!(rownames(exprSet) %<span class="keyword">in</span>% ids$probe_id),]</span><br><span class="line">dim(n_exprSet)</span><br><span class="line"><span class="comment"># [1] 1165   22</span></span><br><span class="line">View(n_exprSet)</span><br><span class="line"><span class="comment"># These probes are not in the package.</span></span><br><span class="line">exprSet &lt;- exprSet[rownames(exprSet) %<span class="keyword">in</span>% ids$probe_id),]</span><br><span class="line">dim(exprSet)</span><br><span class="line">[<span class="number">1</span>] <span class="number">11460</span>    <span class="number">22</span></span><br><span class="line">View(exprSet)</span><br><span class="line"><span class="comment"># These probes are in the package.</span></span><br></pre></td></tr></table></figure><h2 id="9-整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。"><a href="#9-整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。" class="headerlink" title="9.整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。"></a>9.整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。</h2><p>提示，理解 tapply,by,aggregate,split 函数 , 首先对每个基因找到最大表达量的探针。</p><p>然后根据得到探针去过滤原始表达矩阵</p><h2 id="10-把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。"><a href="#10-把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。" class="headerlink" title="10.把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。"></a>10.把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。</h2>   <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tapply: Apply a function to each cell of a ragged array, that is to each (non-empty) group of values given by a unique combination of the levels of certain factors.</span></span><br><span class="line"><span class="comment"># by: is an object-oriented wrapper for tapply applied to data frames.</span></span><br><span class="line"><span class="comment"># aggregate: Given an environment and an aggregator (an object of class aggregate simple aggregations are made.</span></span><br><span class="line"><span class="comment"># split: divides the data in the vector x into the groups defined by f. The replacement forms replace values corresponding to such a division. unsplit reverses the effect of split.</span></span><br><span class="line"><span class="comment"># match: Returns a vector of the positions of (first) matches of its first argument in its second.</span></span><br><span class="line"><span class="keyword">library</span>(reshape2)</span><br><span class="line">rownames(exprSet) &lt;- ids[match(rownames(exprSet), ids$probe_id), <span class="number">2</span>]</span><br><span class="line">exprSet_L &lt;- melt(exprSet)</span><br><span class="line"><span class="comment"># melt() Convert an object into a molten data frame. </span></span><br><span class="line">View(exprSet_L)</span><br><span class="line"><span class="comment">#      Var1      Var2    value</span></span><br><span class="line"><span class="number">1</span>   MAPK3 CLL11.CEL <span class="number">5.743132</span></span><br><span class="line"><span class="number">2</span>    TIE1 CLL11.CEL <span class="number">2.285143</span></span><br><span class="line"><span class="number">3</span> CYP2C19 CLL11.CEL <span class="number">3.309294</span></span><br><span class="line"><span class="number">4</span>   CXCR5 CLL11.CEL <span class="number">1.085264</span></span><br><span class="line"><span class="number">5</span>   CXCR5 CLL11.CEL <span class="number">7.544884</span></span><br><span class="line"><span class="number">6</span>   DUSP1 CLL11.CEL <span class="number">5.083793</span></span><br><span class="line">colnames(exprSet_L) &lt;- c(<span class="string">'probe'</span>, <span class="string">'sample'</span>, <span class="string">'value'</span>)</span><br><span class="line">View(exprSet_L)</span><br><span class="line"><span class="comment">#      Var1      Var2    value</span></span><br><span class="line"><span class="number">1</span>   MAPK3 CLL11.CEL <span class="number">5.743132</span></span><br><span class="line"><span class="number">2</span>    TIE1 CLL11.CEL <span class="number">2.285143</span></span><br><span class="line"><span class="number">3</span> CYP2C19 CLL11.CEL <span class="number">3.309294</span></span><br><span class="line"><span class="number">4</span>   CXCR5 CLL11.CEL <span class="number">1.085264</span></span><br><span class="line"><span class="number">5</span>   CXCR5 CLL11.CEL <span class="number">7.544884</span></span><br><span class="line"><span class="number">6</span>   DUSP1 CLL11.CEL <span class="number">5.083793</span></span><br><span class="line">exprSet_L$group &lt;- rep(group_list,each=nrow(exprSet))</span><br><span class="line"><span class="comment"># add a column named group</span></span><br><span class="line">View(exprSet_L)</span><br><span class="line">     Var1      Var2    value    group</span><br><span class="line"><span class="number">1</span>   MAPK3 CLL11.CEL <span class="number">5.743132</span> progres.</span><br><span class="line"><span class="number">2</span>    TIE1 CLL11.CEL <span class="number">2.285143</span> progres.</span><br><span class="line"><span class="number">3</span> CYP2C19 CLL11.CEL <span class="number">3.309294</span> progres.</span><br><span class="line"><span class="number">4</span>   CXCR5 CLL11.CEL <span class="number">1.085264</span> progres.</span><br><span class="line"><span class="number">5</span>   CXCR5 CLL11.CEL <span class="number">7.544884</span> progres.</span><br><span class="line"><span class="number">6</span>   DUSP1 CLL11.CEL <span class="number">5.083793</span> progres.</span><br></pre></td></tr></table></figure><p><a href="https://www.r-bloggers.com/melt/" target="_blank" rel="noopener">melt</a></p><h2 id="11-对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot-hist-density-，-然后画所有样本的-这些图"><a href="#11-对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot-hist-density-，-然后画所有样本的-这些图" class="headerlink" title="11.对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot,hist,density ， 然后画所有样本的 这些图"></a>11.对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot,hist,density ， 然后画所有样本的 这些图</h2><p>理解ggplot2的绘图语法，数据和图形元素的映射关系</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">p &lt;- ggplot(exprSet_L,aes(x=sample, y=value, fill=group)) +</span><br><span class="line">  geom_boxplot()</span><br><span class="line">  </span><br><span class="line">p</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/boxplot.png" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># boxplot</span></span><br><span class="line">p &lt;- ggplot(exprSet_L,aes(x=sample, y=value, fill=group))+ </span><br><span class="line">  geom_violin()</span><br><span class="line">p</span><br><span class="line"><span class="comment"># violin</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/violin.png" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(exprSet_L, aes(value, fill=group))+</span><br><span class="line">  geom_histogram(bins = <span class="number">200</span>)+</span><br><span class="line">  facet_wrap(~sample, nrow = <span class="number">4</span>)</span><br><span class="line">p</span><br><span class="line"><span class="comment"># density</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/histogram.png" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(exprSet_L,aes(value,col=group))+</span><br><span class="line">  geom_density()</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/density.png" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p=ggplot(exprSet_L,aes(x=sample,y=value,fill=group))+geom_boxplot()</span><br><span class="line">p=p+stat_summary(fun.y=<span class="string">"mean"</span>,geom=<span class="string">"point"</span>,shape=<span class="number">23</span>,size=<span class="number">3</span>,fill=<span class="string">"red"</span>)</span><br><span class="line">p=p+theme_set(theme_set(theme_bw(base_size=<span class="number">20</span>)))</span><br><span class="line">p=p+theme(text=element_text(face=<span class="string">'bold'</span>),axis.text.x=element_text(angle=<span class="number">30</span>,hjust=<span class="number">1</span>),axis.title=element_blank())</span><br><span class="line">print(p)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/boxplot-2.png" alt=""></p><p>参考：<a href="http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html" target="_blank" rel="noopener">basic visualization for expression matrix</a></p><h2 id="12-理解统计学指标mean-median-max-min-sd-var-mad并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top-50-mad值的基因，得到列表。"><a href="#12-理解统计学指标mean-median-max-min-sd-var-mad并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top-50-mad值的基因，得到列表。" class="headerlink" title="12.理解统计学指标mean,median,max,min,sd,var,mad并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top 50 mad值的基因，得到列表。"></a>12.理解统计学指标mean,median,max,min,sd,var,mad并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top 50 mad值的基因，得到列表。</h2><p>注意：这个题目出的并不合规，请仔细看。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply() Returns a vector or array or list of values obtained by applying a <span class="keyword">function</span> to margins of an array or matrix.  <span class="number">1</span> indicates rows, <span class="number">2</span> indicates columns, c(<span class="number">1</span>, <span class="number">2</span>) indicates rows and columns.</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mean</span></span><br><span class="line">g_mean &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, mean)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># median</span></span><br><span class="line">g_median &lt;-  tail(sort(apply(exprSet, <span class="number">1</span>, median)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># max</span></span><br><span class="line">g_max &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, max)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># min </span></span><br><span class="line">g_min &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, min)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sd</span></span><br><span class="line">g_sd &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, sd)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># var</span></span><br><span class="line">g_var &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, var)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mad: Compute the median absolute deviation.</span></span><br><span class="line">g_mad &lt;- tail(sort(apply(exprSet, <span class="number">1</span>, mad)),<span class="number">50</span>)</span><br></pre></td></tr></table></figure><h2 id="13-根据第12步骤得到top-50-mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。试试看其它5种热图的包的不同效果。"><a href="#13-根据第12步骤得到top-50-mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。试试看其它5种热图的包的不同效果。" class="headerlink" title="13.根据第12步骤得到top 50 mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。试试看其它5种热图的包的不同效果。"></a>13.根据第12步骤得到top 50 mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。试试看其它5种热图的包的不同效果。</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">g_mad</span><br><span class="line"><span class="comment">#    DUSP5   IGFBP4     H1FX    ENPP2     FLNA   CLEC2B   TSPYL2   ZNF266   S100A9    NR4A2    TGFBI     ARF6    APBB2 </span></span><br><span class="line"><span class="number">1.553782</span> <span class="number">1.554888</span> <span class="number">1.557412</span> <span class="number">1.561485</span> <span class="number">1.574436</span> <span class="number">1.578055</span> <span class="number">1.582430</span> <span class="number">1.587748</span> <span class="number">1.608285</span> <span class="number">1.612875</span> <span class="number">1.643149</span> <span class="number">1.654548</span> <span class="number">1.674443</span> </span><br><span class="line">    VCAN    RBM38     CAPG   PLXNC1     RGS2   RNASE6    VAMP5     CYBB     GNLY     CCL3     OAS1    ENPP2    TRIB2 </span><br><span class="line"><span class="number">1.681098</span> <span class="number">1.703638</span> <span class="number">1.713747</span> <span class="number">1.718297</span> <span class="number">1.770151</span> <span class="number">1.775430</span> <span class="number">1.791017</span> <span class="number">1.811973</span> <span class="number">1.814364</span> <span class="number">1.862311</span> <span class="number">1.883509</span> <span class="number">1.909442</span> <span class="number">1.937294</span> </span><br><span class="line"> ZNF804A     H1FX      IGH     JUND  SLC25A1    PCDH9    VIPR1   COBLL1  GUSBP11   S100A8      HBB      FOS   LHFPL2 </span><br><span class="line"><span class="number">1.986163</span> <span class="number">2.052788</span> <span class="number">2.090866</span> <span class="number">2.105234</span> <span class="number">2.115238</span> <span class="number">2.144223</span> <span class="number">2.171912</span> <span class="number">2.179666</span> <span class="number">2.204212</span> <span class="number">2.220970</span> <span class="number">2.267136</span> <span class="number">2.268946</span> <span class="number">2.317045</span> </span><br><span class="line">    FCN1    ZAP70    IGLC1   LGALS1      HBB      FOS   SLAMF1     TCF7      DMD  IGF2BP3   FAM30A </span><br><span class="line"><span class="number">2.371590</span> <span class="number">2.579046</span> <span class="number">2.590895</span> <span class="number">2.600604</span> <span class="number">2.732776</span> <span class="number">2.938078</span> <span class="number">2.944105</span> <span class="number">2.993352</span> <span class="number">3.071541</span> <span class="number">3.234011</span> <span class="number">3.982191</span> </span><br><span class="line">choose_gene &lt;- names(g_mad)</span><br><span class="line">choose_matrix &lt;- exprSet[choose_gene,]</span><br></pre></td></tr></table></figure><p>热图的几种画法：</p><h3 id="heatmap"><a href="#heatmap" class="headerlink" title="heatmap"></a>heatmap</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">choose_matrix &lt;- t(scale(t(choose_matrix)))</span><br><span class="line"><span class="comment"># t() Given a rectangular object x, t returns the transpose of x.</span></span><br><span class="line"><span class="comment"># scale is generic function whose default method centers and/or scales the columns of a numeric matrix.</span></span><br><span class="line"><span class="comment"># The value of scale determines how column scaling is performed.</span></span><br><span class="line">rc &lt;- rainbow(nrow(choose_matrix), start = <span class="number">0</span>, end = <span class="number">.3</span>)</span><br><span class="line">cc &lt;- rainbow(ncol(choose_matrix), start = <span class="number">0</span>, end = <span class="number">.3</span>)</span><br><span class="line"><span class="comment"># the heatmap doesnot offer the color key</span></span><br><span class="line">heatmap(choose_matrix, </span><br><span class="line">        col = cm.colors(<span class="number">256</span>), <span class="comment"># https://www.r-bloggers.com/color-palettes-in-r/锛?</span></span><br><span class="line">        RowSideColors = rc, ColSideColors = cc,<span class="comment"># color names for a horizontal side bar </span></span><br><span class="line">        <span class="comment">#Colv = NA, Rowv = NA # determines if and how the row dendrogram should be computed and reordered</span></span><br><span class="line">        margins = c(<span class="number">6</span>, <span class="number">5</span>), <span class="comment"># margins for column and row names</span></span><br><span class="line">        xlab = <span class="string">"samples"</span>, ylab = <span class="string">"genes"</span>, <span class="comment"># x/y axis titles</span></span><br><span class="line">        main = <span class="string">"heatmap"</span>, <span class="comment"># titles</span></span><br><span class="line">        scale = <span class="string">"column"</span></span><br><span class="line">        )</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/heatmap.png" alt=""></p><h3 id="pheatmap"><a href="#pheatmap" class="headerlink" title="pheatmap"></a>pheatmap</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(pheatmap)</span><br><span class="line">pheatmap(choose_matrix</span><br><span class="line">         <span class="comment"># kmeans_k = NA, # the number of kmeans clusters to make</span></span><br><span class="line">         <span class="comment"># clustering_distance_rows = "correlation", # distance measure used in clustering rows. </span></span><br><span class="line">         <span class="comment"># cluster_rows = F, cluster_cols = F, #  if rows/cols should be clustered</span></span><br><span class="line">         <span class="comment"># legend = F, # logical to determine if legend should be drawn or not.</span></span><br><span class="line">         <span class="comment"># cellwidth = 12, cellheight = 15,</span></span><br><span class="line">         <span class="comment"># filename = "test.pdf"锛? # file path where to save the picture</span></span><br><span class="line">         )</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/pheatmap.png" alt=""></p><h3 id="ggplot2"><a href="#ggplot2" class="headerlink" title="ggplot2"></a>ggplot2</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">choose_matrix_m &lt;- melt(choose_matrix)</span><br><span class="line">p &lt;- ggplot(choose_matrix_m, aes(x= Var2, y = Var1))</span><br><span class="line">p &lt;- p + geom_tile(aes(fill=value))</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/ggplot2.png" alt=""></p><p>参考：<a href="https://www.cnblogs.com/xiaofeiIDO/p/8337912.html" target="_blank" rel="noopener">ggplot 绘制热图</a></p><h3 id="heatmap-2"><a href="#heatmap-2" class="headerlink" title="heatmap.2"></a>heatmap.2</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># heatmap.2 offers the color key.</span></span><br><span class="line"><span class="keyword">library</span>(gplots)</span><br><span class="line">heatmap.2 (choose_matrix)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/heatmap.2.png" alt=""></p><h3 id="lattice"><a href="#lattice" class="headerlink" title="lattice"></a>lattice</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(latticeExtra)</span><br><span class="line">?levelplot</span><br></pre></td></tr></table></figure><h2 id="14-取不同统计学指标mean-median-max-mean-sd-var-mad的各top50基因列表，使用UpSetR包来看他们之间的overlap情况。"><a href="#14-取不同统计学指标mean-median-max-mean-sd-var-mad的各top50基因列表，使用UpSetR包来看他们之间的overlap情况。" class="headerlink" title="14.取不同统计学指标mean,median,max,mean,sd,var,mad的各top50基因列表，使用UpSetR包来看他们之间的overlap情况。"></a>14.取不同统计学指标mean,median,max,mean,sd,var,mad的各top50基因列表，使用UpSetR包来看他们之间的overlap情况。</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(UpSetR)</span><br><span class="line">??UpSetR</span><br><span class="line"><span class="comment"># Visualization of set intersections using novel UpSet matrix design.</span></span><br></pre></td></tr></table></figure><p><a href="https://ytlogos.github.io/2017/10/15/R%E8%AF%AD%E8%A8%80%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BUpSetR%E5%8C%85/" target="_blank" rel="noopener">R语言可视化之UpSetR包</a></p><p><a href="https://cran.r-project.org/web/packages/UpSetR/README.html" target="_blank" rel="noopener">UpSetR - CRAN.R-project.org</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">g_all &lt;- unique(c(names(g_mean), </span><br><span class="line">                  names(g_median), </span><br><span class="line">                  names(g_max), </span><br><span class="line">                  names(g_min), </span><br><span class="line">                  names(g_sd), </span><br><span class="line">                  names(g_var), </span><br><span class="line">                  names(g_mad)</span><br><span class="line">                  ))</span><br><span class="line">dat &lt;- data.frame(g_all,</span><br><span class="line">                  g_mean = ifelse(g_all %<span class="keyword">in</span>% names(g_mean), <span class="number">1</span>, <span class="number">0</span>),</span><br><span class="line">                  g_median = ifelse(g_all%<span class="keyword">in</span>% names(g_median), <span class="number">1</span> ,<span class="number">0</span>),</span><br><span class="line">                  g_max = ifelse(g_all %<span class="keyword">in</span>% names(g_max), <span class="number">1</span>, <span class="number">0</span>),</span><br><span class="line">                  g_min = ifelse(g_all %<span class="keyword">in</span>% names(g_min), <span class="number">1</span>, <span class="number">0</span>),</span><br><span class="line">                  g_sd = ifelse(g_all %<span class="keyword">in</span>% names(g_sd), <span class="number">1</span>, <span class="number">0</span>),</span><br><span class="line">                  g_var = ifelse(g_all %<span class="keyword">in</span>% names(g_var), <span class="number">1</span>, <span class="number">0</span>),</span><br><span class="line">                  g_mad = ifelse(g_all %<span class="keyword">in</span>% names(g_mad), <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">                  )</span><br><span class="line">upset(dat, nsets = <span class="number">7</span>)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/upset.png" alt=""></p><h2 id="15-在第二步的基础上面提取CLL包里面的data-sCLLex-数据对象的样本的表型数据。"><a href="#15-在第二步的基础上面提取CLL包里面的data-sCLLex-数据对象的样本的表型数据。" class="headerlink" title="15.在第二步的基础上面提取CLL包里面的data(sCLLex) 数据对象的样本的表型数据。"></a>15.在第二步的基础上面提取<code>CLL</code>包里面的<code>data(sCLLex)</code> 数据对象的样本的表型数据。</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(CLL)</span><br><span class="line">data(sCLLex)</span><br><span class="line">pdata &lt;- pData(sCLLex)</span><br><span class="line">group_list &lt;- as.character(pdata[,<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h2 id="16-对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息-更改样本名"><a href="#16-对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息-更改样本名" class="headerlink" title="16. 对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息(更改样本名)"></a>16. 对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息(更改样本名)</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dim(exprSet)</span><br><span class="line"><span class="comment"># [1] 11460    22</span></span><br><span class="line">exprSet[<span class="number">1</span>:<span class="number">5</span>,<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment">#        CLL11.CEL CLL12.CEL CLL13.CEL CLL14.CEL CLL15.CEL</span></span><br><span class="line">MAPK3    <span class="number">5.743132</span>  <span class="number">6.219412</span>  <span class="number">5.523328</span>  <span class="number">5.340477</span>  <span class="number">5.229904</span></span><br><span class="line">TIE1     <span class="number">2.285143</span>  <span class="number">2.291229</span>  <span class="number">2.287986</span>  <span class="number">2.295313</span>  <span class="number">2.662170</span></span><br><span class="line">CYP2C19  <span class="number">3.309294</span>  <span class="number">3.318466</span>  <span class="number">3.354423</span>  <span class="number">3.327130</span>  <span class="number">3.365113</span></span><br><span class="line">CXCR5    <span class="number">1.085264</span>  <span class="number">1.117288</span>  <span class="number">1.084010</span>  <span class="number">1.103217</span>  <span class="number">1.074243</span></span><br><span class="line">CXCR5    <span class="number">7.544884</span>  <span class="number">7.671801</span>  <span class="number">7.474025</span>  <span class="number">7.152482</span>  <span class="number">6.902932</span></span><br><span class="line">colnames(exprSet) &lt;- paste(group_list,<span class="number">1</span>:<span class="number">22</span>,sep=<span class="string">''</span>)</span><br><span class="line"><span class="comment"># change the sample names</span></span><br><span class="line">nodePar &lt;- list(lab.cex = <span class="number">0.6</span>, pch = c(<span class="number">10</span>, <span class="number">15</span>), cex = <span class="number">0.6</span>, col = <span class="string">"green"</span>)</span><br><span class="line"><span class="comment"># Define nodePar,lab.cex </span></span><br><span class="line">hc=hclust(dist(t(exprSet)))</span><br><span class="line"><span class="comment"># hclust() Hierarchical cluster analysis on a set of dissimilarities and methods for analyzing it.</span></span><br><span class="line"><span class="comment"># by default the row names or row numbers of the original data are used for the leaves of the tree. </span></span><br><span class="line">par(mar=c(<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">10</span>))</span><br><span class="line"><span class="comment"># mar() A numerical vector of the form c(bottom, left, top, right) which gives the number of lines of margin to be specified on the four sides of the plot. The default is c(5, 4, 4, 2) + 0.1.</span></span><br><span class="line"><span class="comment"># par() can be used to set or query graphical parameters.</span></span><br><span class="line">plot(as.dendrogram(hc), nodePar = nodePar, horiz = <span class="literal">TRUE</span>)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/hclust.png" alt=""></p><h2 id="17-对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息。"><a href="#17-对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息。" class="headerlink" title="17. 对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息。"></a>17. 对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息。</h2><p><a href="https://zhuanlan.zhihu.com/p/28172816" target="_blank" rel="noopener">Learn R | 可视化之ggfortify包</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"ggfortify"</span>)</span><br><span class="line"><span class="keyword">library</span>(ggfortify)</span><br><span class="line">exprSet &lt;- exprs(sCLLex)</span><br><span class="line">df &lt;- as.data.frame(t(exprSet))</span><br><span class="line">df$group &lt;- group_list</span><br><span class="line"><span class="comment"># autoplot uses ggplot2 to draw a particular plot for an object of a particular class in a single command.</span></span><br><span class="line">autoplot(prcomp(df[,<span class="number">1</span>:(ncol(df)-<span class="number">1</span>)]), data=df, colour = <span class="string">'group'</span>)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/pca.png" alt=""></p><h2 id="18-根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格"><a href="#18-根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格" class="headerlink" title="18. 根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格"></a>18. 根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格</h2><p><a href="https://www.statmethods.net/stats/ttest.html" target="_blank" rel="noopener">t.test </a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">rownames(exprSet) &lt;- ids[match(rownames(exprSet), ids$probe_id), <span class="number">2</span>]</span><br><span class="line"><span class="comment"># gain the matrix contains the sample names(colnames) and the gene symbol(rownames)</span></span><br><span class="line">dat = exprSet</span><br><span class="line">dim(dat)</span><br><span class="line"><span class="comment"># [1] 11460    22</span></span><br><span class="line">group_list=as.factor(group_list)</span><br><span class="line"><span class="comment"># levels provides access to the levels attribute of a variable. The first form returns the value of the levels of its argument and the second sets the attribute.</span></span><br><span class="line"><span class="comment"># levels(group_list)</span></span><br><span class="line">group1 = which(group_list == levels(group_list)[<span class="number">1</span>])</span><br><span class="line">group2 = which(group_list == levels(group_list)[<span class="number">2</span>])</span><br><span class="line">dat1 = dat[, group1]</span><br><span class="line">dat2 = dat[, group2]</span><br><span class="line">dat = cbind(dat1, dat2)</span><br><span class="line"><span class="comment"># apply() Returns a vector or array or list of values obtained by applying a function to margins of an array or matrix.</span></span><br><span class="line"><span class="comment"># 1 indicates rows, 2 indicates columns</span></span><br><span class="line">pvals = apply(exprSet, <span class="number">1</span>, <span class="keyword">function</span>(x)&#123;</span><br><span class="line">  t.test(as.numeric(x)~group_list)$p.value</span><br><span class="line">  &#125;)</span><br><span class="line">p.adj = p.adjust(pvals, method = <span class="string">"BH"</span>)</span><br><span class="line">avg_1 = rowMeans(dat1)</span><br><span class="line">avg_2 = rowMeans(dat2)</span><br><span class="line"><span class="comment"># log2(a/b) = log2(a) - log2(b)</span></span><br><span class="line">log2FC = avg_2-avg_1</span><br><span class="line">DEG_t.test = cbind(avg_1, avg_2, log2FC, pvals, p.adj)</span><br><span class="line">DEG_t.test[<span class="number">1</span>:<span class="number">5</span>,<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment">#           avg_1    avg_2      log2FC     pvals     p.adj</span></span><br><span class="line">MAPK3   <span class="number">5.409914</span> <span class="number">5.538191</span>  <span class="number">0.12827699</span> <span class="number">0.5355478</span> <span class="number">0.9946078</span></span><br><span class="line">TIE1    <span class="number">2.343562</span> <span class="number">2.317535</span> -<span class="number">0.02602712</span> <span class="number">0.4370106</span> <span class="number">0.9946078</span></span><br><span class="line">CYP2C19 <span class="number">3.389422</span> <span class="number">3.424209</span>  <span class="number">0.03478680</span> <span class="number">0.6064461</span> <span class="number">0.9946078</span></span><br><span class="line">CXCR5   <span class="number">1.114136</span> <span class="number">1.147225</span>  <span class="number">0.03308823</span> <span class="number">0.5487370</span> <span class="number">0.9946078</span></span><br><span class="line">CXCR5   <span class="number">7.482762</span> <span class="number">7.362510</span> -<span class="number">0.12025210</span> <span class="number">0.6829745</span> <span class="number">0.9946078</span></span><br><span class="line"><span class="comment"># ordered by pvals</span></span><br><span class="line">DEG_t.test=DEG_t.test[order(DEG_t.test[,<span class="number">4</span>]),]</span><br><span class="line">DEG_t.test[<span class="number">1</span>:<span class="number">5</span>,<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line"><span class="comment">#           avg_1    avg_2     log2FC        pvals     p.adj</span></span><br><span class="line">SGSM2  <span class="number">7.875615</span> <span class="number">8.791753</span>  <span class="number">0.9161377</span> <span class="number">1.629755e-05</span> <span class="number">0.1867699</span></span><br><span class="line">PDE8A  <span class="number">6.622749</span> <span class="number">7.965007</span>  <span class="number">1.3422581</span> <span class="number">4.058944e-05</span> <span class="number">0.2211373</span></span><br><span class="line">DLEU1  <span class="number">7.616197</span> <span class="number">5.786041</span> -<span class="number">1.8301554</span> <span class="number">6.965416e-05</span> <span class="number">0.2211373</span></span><br><span class="line">LDOC1  <span class="number">4.456446</span> <span class="number">2.152471</span> -<span class="number">2.3039752</span> <span class="number">8.993339e-05</span> <span class="number">0.2211373</span></span><br><span class="line">USP6NL <span class="number">5.988866</span> <span class="number">7.058738</span>  <span class="number">1.0698718</span> <span class="number">9.648226e-05</span> <span class="number">0.2211373</span></span><br><span class="line">DEG_t.test=as.data.frame(DEG_t.test)</span><br><span class="line">head(DEG_t.test)</span><br><span class="line"><span class="comment">#           avg_1    avg_2     log2FC        pvals     p.adj</span></span><br><span class="line">SGSM2  <span class="number">7.875615</span> <span class="number">8.791753</span>  <span class="number">0.9161377</span> <span class="number">1.629755e-05</span> <span class="number">0.1867699</span></span><br><span class="line">PDE8A  <span class="number">6.622749</span> <span class="number">7.965007</span>  <span class="number">1.3422581</span> <span class="number">4.058944e-05</span> <span class="number">0.2211373</span></span><br><span class="line">DLEU1  <span class="number">7.616197</span> <span class="number">5.786041</span> -<span class="number">1.8301554</span> <span class="number">6.965416e-05</span> <span class="number">0.2211373</span></span><br><span class="line">LDOC1  <span class="number">4.456446</span> <span class="number">2.152471</span> -<span class="number">2.3039752</span> <span class="number">8.993339e-05</span> <span class="number">0.2211373</span></span><br><span class="line">USP6NL <span class="number">5.988866</span> <span class="number">7.058738</span>  <span class="number">1.0698718</span> <span class="number">9.648226e-05</span> <span class="number">0.2211373</span></span><br><span class="line">COMMD4 <span class="number">4.157971</span> <span class="number">3.407405</span> -<span class="number">0.7505660</span> <span class="number">2.454557e-04</span> <span class="number">0.3192169</span></span><br></pre></td></tr></table></figure><h2 id="19-使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，重点看logFC和P值，画个火山图-就是logFC和-log10-P值-的散点图。-。"><a href="#19-使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，重点看logFC和P值，画个火山图-就是logFC和-log10-P值-的散点图。-。" class="headerlink" title="19.使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，重点看logFC和P值，画个火山图(就是logFC和-log10(P值)的散点图。)。"></a>19.使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，重点看logFC和P值，画个火山图(就是logFC和-log10(P值)的散点图。)。</h2><p><a href="https://science.nature.nps.gov/im/datamgmt/statistics/r/formulas/" target="_blank" rel="noopener">Statistical Formulas</a></p><p><a href="https://vip.biotrainee.com/d/116-limma" target="_blank" rel="noopener">用limma对芯片数据做差异分析</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># data1: Expression matrix</span></span><br><span class="line"><span class="keyword">library</span>(limma)</span><br><span class="line"><span class="comment"># data2: creat the grouping matrix</span></span><br><span class="line"><span class="comment"># model.matrix: creates a design (or model) matrix</span></span><br><span class="line">design &lt;- model.matrix(~ -<span class="number">1</span> + factor(group_list))</span><br><span class="line">colnames(design)=levels(factor(group_list))</span><br><span class="line">rownames(design)=colnames(exprSet)</span><br><span class="line">design</span><br><span class="line"><span class="comment"># data3: Difference comparison matrix</span></span><br><span class="line"><span class="comment"># paste0: Concatenate vectors after converting to character.</span></span><br><span class="line"><span class="comment"># makeContrasts: Construct the contrast matrix corresponding to specified contrasts of a set of parameters.</span></span><br><span class="line">contrast.matrix&lt;-makeContrasts(paste0(unique(group_list),collapse = <span class="string">"-"</span>),</span><br><span class="line">                               levels = design)</span><br><span class="line">contrast.matrix</span><br><span class="line"><span class="comment"># step1</span></span><br><span class="line"><span class="comment"># lmFit Fit linear model for each gene given a series of arrays</span></span><br><span class="line">fit &lt;- lmFit(exprSet,design)</span><br><span class="line"><span class="comment"># step2</span></span><br><span class="line"><span class="comment"># Given a linear model fit to microarray data, compute estimated coefficients and standard errors for a given set of contrasts.</span></span><br><span class="line">fit2 &lt;- contrasts.fit(fit, contrast.matrix) </span><br><span class="line">fit2 &lt;- eBayes(fit2) <span class="comment">## default no trend !!!</span></span><br><span class="line"><span class="comment"># eBayes() with trend=TRUE</span></span><br><span class="line"><span class="comment"># step3</span></span><br><span class="line"><span class="comment"># topTable</span></span><br><span class="line">tempOutput = topTable(fit2, coef=<span class="number">1</span>, n=<span class="literal">Inf</span>)</span><br><span class="line">nrDEG = na.omit(tempOutput)</span><br><span class="line">write.csv(nrDEG,<span class="string">"limma_notrend.results.csv"</span>,quote = <span class="literal">F</span>)</span><br><span class="line">head(nrDEG)</span><br><span class="line"><span class="comment">#            ID      logFC  AveExpr         t      P.Value  adj.P.Val        B</span></span><br><span class="line"><span class="number">8601</span>  TBC1D2B -<span class="number">1.0284628</span> <span class="number">5.620700</span> -<span class="number">5.835508</span> <span class="number">8.344767e-06</span> <span class="number">0.03035725</span> <span class="number">3.257356</span></span><br><span class="line"><span class="number">5522</span>    CLIC1  <span class="number">0.9888221</span> <span class="number">9.954273</span>  <span class="number">5.771215</span> <span class="number">9.672884e-06</span> <span class="number">0.03035725</span> <span class="number">3.139428</span></span><br><span class="line"><span class="number">3360</span>    DLEU1  <span class="number">1.8301554</span> <span class="number">6.950685</span>  <span class="number">5.736157</span> <span class="number">1.048607e-05</span> <span class="number">0.03035725</span> <span class="number">3.074853</span></span><br><span class="line"><span class="number">299</span>    SH3BP2 -<span class="number">1.3835699</span> <span class="number">4.463438</span> -<span class="number">5.731636</span> <span class="number">1.059590e-05</span> <span class="number">0.03035725</span> <span class="number">3.066513</span></span><br><span class="line"><span class="number">6286</span>    GPM6A  <span class="number">2.5471980</span> <span class="number">6.915045</span>  <span class="number">5.038363</span> <span class="number">5.360926e-05</span> <span class="number">0.11768171</span> <span class="number">1.752783</span></span><br><span class="line"><span class="number">10468</span>  YTHDC2 -<span class="number">0.5187135</span> <span class="number">7.602354</span> -<span class="number">4.878259</span> <span class="number">7.839394e-05</span> <span class="number">0.11768171</span> <span class="number">1.440739</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DEG=nrDEG</span><br><span class="line"><span class="comment"># abs(x) computes the absolute value of x</span></span><br><span class="line">logFC_cutoff &lt;- with(DEG,mean(abs( logFC)) + <span class="number">2</span>*sd(abs( logFC)) )</span><br><span class="line"><span class="comment"># [1] 0.5682807</span></span><br><span class="line">DEG$change = as.factor(ifelse(DEG$P.Value &lt; <span class="number">0.05</span> &amp; abs(DEG$logFC) &gt; logFC_cutoff,</span><br><span class="line">                              ifelse(DEG$logFC &gt; logFC_cutoff ,<span class="string">'UP'</span>,<span class="string">'DOWN'</span>),<span class="string">'NOT'</span>)</span><br><span class="line">)</span><br><span class="line">this_tile &lt;- paste0(<span class="string">'Cutoff for logFC is '</span>,round(logFC_cutoff,<span class="number">3</span>),</span><br><span class="line">                    <span class="string">'\nThe number of up gene is '</span>,nrow(DEG[DEG$change ==<span class="string">'UP'</span>,]) ,</span><br><span class="line">                    <span class="string">'\nThe number of down gene is '</span>,nrow(DEG[DEG$change ==<span class="string">'DOWN'</span>,])</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">g = ggplot(data=DEG, aes(x=logFC, y=-log10(P.Value), color=change)) +</span><br><span class="line">  geom_point(alpha=<span class="number">0.4</span>, size=<span class="number">1.75</span>) +</span><br><span class="line">  theme_set(theme_set(theme_bw(base_size=<span class="number">20</span>)))+</span><br><span class="line">  xlab(<span class="string">"log2 fold change"</span>) + ylab(<span class="string">"-log10 p-value"</span>) +</span><br><span class="line">  ggtitle( this_tile ) + theme(plot.title = element_text(size=<span class="number">15</span>,hjust = <span class="number">0.5</span>))+</span><br><span class="line">  scale_colour_manual(values = c(<span class="string">'blue'</span>,<span class="string">'black'</span>,<span class="string">'red'</span>)) <span class="comment">## corresponding to the levels(res$change)</span></span><br><span class="line">print(g)</span><br></pre></td></tr></table></figure><p><img src="https://github.com/CLDIAO/photo-for-blog-1.md/raw/master/R-20/volcano.png" alt=""></p><h2 id="20-对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大。"><a href="#20-对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大。" class="headerlink" title="20.对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大。"></a>20.对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大。</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://www.bio-info-trainee.com/3409.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;生信人的20个R语言习题&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.bio-info-trainee.com/3415.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;生信人的20个R语言习题的答案&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-安装一些R包&quot;&gt;&lt;a href=&quot;#1-安装一些R包&quot; class=&quot;headerlink&quot; title=&quot;1.安装一些R包&quot;&gt;&lt;/a&gt;1.安装一些R包&lt;/h2&gt;&lt;figure class=&quot;highlight r&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;source&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;https://bioconductor.org/biocLite.R&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;biocLite(c(&lt;span class=&quot;string&quot;&gt;&#39;ALL&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;CLL&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;pasilla&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;clusterProfiler&#39;&lt;/span&gt;)) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;biocLite(c(&lt;span class=&quot;string&quot;&gt;&#39;airway&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;DESeq2&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;edgeR&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;limma&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install.packages(&lt;span class=&quot;string&quot;&gt;&quot;reshape2&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;ggplot2&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;2-了解ExpressionSet对象，比如CLL包里面就有data-sCLLex-，找到它包含的元素，提取其表达矩阵-使用exprs函数-，查看其大小&quot;&gt;&lt;a href=&quot;#2-了解ExpressionSet对象，比如CLL包里面就有data-sCLLex-，找到它包含的元素，提取其表达矩阵-使用exprs函数-，查看其大小&quot; class=&quot;headerlink&quot; title=&quot;2.了解ExpressionSet对象，比如CLL包里面就有data(sCLLex) ，找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小&quot;&gt;&lt;/a&gt;2.了解ExpressionSet对象，比如&lt;code&gt;CLL&lt;/code&gt;包里面就有&lt;code&gt;data(sCLLex)&lt;/code&gt; ，找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小&lt;/h2&gt;
    
    </summary>
    
    
      <category term="R, 表达矩阵，heatmap, PCA, T检验，火山图，ID转换" scheme="https://cldiao.github.io/tags/R-%E8%A1%A8%E8%BE%BE%E7%9F%A9%E9%98%B5%EF%BC%8Cheatmap-PCA-T%E6%A3%80%E9%AA%8C%EF%BC%8C%E7%81%AB%E5%B1%B1%E5%9B%BE%EF%BC%8CID%E8%BD%AC%E6%8D%A2/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://cldiao.github.io/2018/09/02/hello-world/"/>
    <id>https://cldiao.github.io/2018/09/02/hello-world/</id>
    <published>2018-09-02T14:38:36.368Z</published>
    <updated>2018-09-02T16:13:15.359Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>. </p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitHub&lt;/a&gt;. &lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Mac上安装一些应用</title>
    <link href="https://cldiao.github.io/2018/09/01/Mac%E4%B8%8A%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8/"/>
    <id>https://cldiao.github.io/2018/09/01/Mac上安装一些应用/</id>
    <published>2018-09-01T06:51:45.000Z</published>
    <updated>2018-10-18T14:47:28.982Z</updated>
    
    <content type="html"><![CDATA[<p>帮师姐找的应用。<a id="more"></a></p><p><a href="https://www.vmware.com/go/getfusion" target="_blank" rel="noopener">Vmware fusion 10 download</a></p><p>激活码：FG3TU-DDX1M-084CY-MFYQX-QC0RD</p><p><a href="http://msdn.itellyou.cn/" target="_blank" rel="noopener">windows系统下载</a></p><p><a href="https://pan.baidu.com/s/1jxzGpv9NZtsvxeyGq3LmTA" target="_blank" rel="noopener">Windows系统绿化</a>  密码：6a5y (windows 中office也可使用此工具)</p><p><a href="https://www.adobe.com/cn/downloads.html?promoid=RL89NGY7&amp;mv=other" target="_blank" rel="noopener">Adobe2018下载</a></p><p><a href="https://pan.baidu.com/s/1LrTTR6D4zZ7o3WVXSppcDQ" target="_blank" rel="noopener">Adobe绿化工具</a>  密码：zv8c</p><p><a href="http://msdn.itellyou.cn/" target="_blank" rel="noopener">office2016下载</a></p><p><a href="https://pan.baidu.com/s/1LFRWxQiI5V9F6FJBf27gHw" target="_blank" rel="noopener">office 2016绿化工具</a>  密码：otve</p><p><a href="链接: https://pan.baidu.com/s/1G5TkQpQM3qrL6IkjWmCQSg">Dnastar</a>  提取码: 7wa6</p><p><a href="链接: https://pan.baidu.com/s/1I17bK3nOt83UbpRAGaVUOw">grapdhpad</a>   提取码: w7ke</p><p><a href="https://www.jianshu.com/p/d94353033f06" target="_blank" rel="noopener">文件已损坏问题解决</a></p><p><a href="链接: https://pan.baidu.com/s/1CX3xqjbY0AQDWNkjY2lbYw">spss下载</a>   提取码: 2pp2</p><p><a href="https://www.macxin.com/archives/1594.html" target="_blank" rel="noopener">spss激活</a></p><p><a href="链接: https://pan.baidu.com/s/1jae7WChwfSizWtoTlGJ41g">lantern下载</a>   提取码: uirv</p><p><a href="链接: https://pan.baidu.com/s/17OUwVd1mkw2kIo8lcvr8zQ">FLOW JO</a>   提取码: c87h</p><p>(仅供学习、研究)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;帮师姐找的应用。
    
    </summary>
    
    
      <category term="Mac, office, Vmware fusion, Ps，Adobe" scheme="https://cldiao.github.io/tags/Mac-office-Vmware-fusion-Ps%EF%BC%8CAdobe/"/>
    
  </entry>
  
  <entry>
    <title>RNA-Seq analysis in R(EDITING)</title>
    <link href="https://cldiao.github.io/2018/07/29/RNA-Seq%20analysis%20in%20R/"/>
    <id>https://cldiao.github.io/2018/07/29/RNA-Seq analysis in R/</id>
    <published>2018-07-28T16:28:44.000Z</published>
    <updated>2018-09-02T16:10:20.899Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RNA-Seq-analysis-in-R"><a href="#RNA-Seq-analysis-in-R" class="headerlink" title="RNA-Seq analysis in R"></a>RNA-Seq analysis in R</h1><h2 id="Some-preparation"><a href="#Some-preparation" class="headerlink" title="Some preparation:"></a>Some preparation:</h2><h3 id="Packages-used"><a href="#Packages-used" class="headerlink" title="Packages used:"></a>Packages used:</h3><p>limma</p><p>edgeR</p><p>gplots</p><p>org.Mm.eg.db</p><p>RColorBrewer</p><p>Glimma<a id="more"></a></p><h3 id="VMware-installation"><a href="#VMware-installation" class="headerlink" title="VMware installation:"></a>VMware installation:</h3><p><a href="http://www.zdfans.com/html/5928.html" target="_blank" rel="noopener">vmware-download</a></p><p><a href="http://environmentalomics.org/bio-linux-download/" target="_blank" rel="noopener">bio-linux-download</a></p><p><a href="http://environmentalomics.org/bio-linux-installation/" target="_blank" rel="noopener">bio-linux-installation</a></p><p><a href="https://www.jb51.net/softjc/189144.html" target="_blank" rel="noopener">vmware-tools-installation</a></p><p><a href="https://www.cnblogs.com/huangjianxin/p/6343881.html" target="_blank" rel="noopener">filessystem for share</a></p><p><a href="https://www.netsarang.com/download/down_form.html?code=622" target="_blank" rel="noopener">X shell-download</a></p><p><a href="http://www.bio-info-trainee.com/tag/%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank" rel="noopener">other common questions</a></p><p><a href="http://blog.sina.com.cn/s/blog_54f07aba0101s1br.html" target="_blank" rel="noopener">R语言编辑器：notepad++</a></p><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul><li>Reading in table of counts</li><li>Filtering lowly expressed genes</li><li>Quality control</li><li>Normalisation for composition bias</li><li>Differential expression analysis</li><li>Testing relative to a threshold</li><li>Visualisation</li><li>Gene set testing</li></ul><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>There are many steps involved in analysising an RNA-Seq experiment. Analysising an RNASeq experiment begins with sequencing reads. These are aligned to a reference genome, then the number of reads mapped to each gene can be counted. This results in a table of counts, which is what we perform statistical analyses on in R. While mapping and counting are important and necessary tasks, today we will be starting from the count data and getting stuck into analysis.</p><h3 id="Data-import"><a href="#Data-import" class="headerlink" title="Data import"></a>Data import</h3><p>Load all the packages will need to analysis the data.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library(edgeR)</span><br><span class="line">library(limma)</span><br><span class="line">library(Glimma)</span><br><span class="line">library(gplots)</span><br><span class="line">library(org.Mm.eg.db)</span><br><span class="line">library(RColorBrewer)</span><br></pre></td></tr></table></figure><h3 id="Mouse-mammary-gland-dataset"><a href="#Mouse-mammary-gland-dataset" class="headerlink" title="Mouse mammary gland dataset"></a>Mouse mammary gland dataset</h3><p>The data comes from a Nature Cell Biology paper, <a href="http://www.ncbi.nlm.nih.gov/pubmed/25730472" target="_blank" rel="noopener"><em>EGF-mediated induction of Mcl-1 at the switch to lactation is essential for alveolar cell survival</em></a>. Both the raw data (sequence reads) and processed data (counts) can be downloaded from <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60450" target="_blank" rel="noopener">GSE60450</a>.</p><p>This study examines the expression profiles of basal stem-cell enriched cells (B) and committed luminal cells (L) in the mammary gland of virgin, pregnant  and lactating mice. Six groups are present, with one for each combination of cell type and mouse status. Each group contains two biological replicates. We will first use the counts file as a starting point for out analysis. This data has already been aligned to the mouse genome.</p><h3 id="Reading-in-the-data"><a href="#Reading-in-the-data" class="headerlink" title="Reading in the data"></a>Reading in the data</h3><p>Download and read in the data.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Read the data into R</span><br><span class="line">seqdata &lt;- read.delim(&quot;GSE60450_Lactation-GenewiseCounts.txt&quot;, stringsAsFactors = FALSE)</span><br><span class="line"># Read the sample information into R</span><br><span class="line">sampleinfo &lt;- read.delim(&quot;SampleInfo.txt&quot;)</span><br><span class="line"># Take a look at the data</span><br><span class="line">head(seqdata)</span><br><span class="line"># See how many rows and columns the data frame has</span><br><span class="line">dim(seqdata)</span><br></pre></td></tr></table></figure><p>The <code>seqdata</code> object contains information about genes, the first column has the Entrez gene id, the second has the gene length and the remaining columns contain information about the number of reads aligning to the gene in each experimental sample. The sampleinfo file contains basic information about the samples that we will need for the analysis today.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sampleinfo</span><br></pre></td></tr></table></figure><p>We will manipulate and reformat the counts matrix into a suitable format for downstream analysis. The first columns in the <code>seqdata</code> dataframe contain annotation information. We need to make a new matrix containing only the counts, but we can store the gene identifiers (the <code>EntrezGeneID</code> column) as rownames. We will add more annotation information about each gene later on in the workshop.</p><h3 id="Format-the-data"><a href="#Format-the-data" class="headerlink" title="Format the data"></a>Format the data</h3><p>Create a new data object, <code>countdata</code>, that contains only the counts for the 12 samples.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Remove first two columns from seqdata</span><br><span class="line">countdata &lt;- seqdata[,-(1:2)]</span><br><span class="line"># Look at the output</span><br><span class="line">head(countdata)</span><br><span class="line"># Store EntrezGeneID as rownames</span><br><span class="line">rownames(countdata) &lt;- seqdata[,1]</span><br><span class="line"># Take a look at the output</span><br><span class="line">head(countdata)</span><br><span class="line"># Take a look at the column names</span><br><span class="line">colnames(countdata)</span><br></pre></td></tr></table></figure><p>The sample names are pretty long, so we’ll shorten these to contain only the relevant information about each sample. We will use the <code>substr</code> command to extract the first 7 characters and use these as the colnames.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># using substr, you extract the characters starting at position 1 and stopping at position 7 of the colnames</span><br><span class="line">colnames(countdata) &lt;- substr(colnames(countdata),start=1,stop=7)</span><br><span class="line"># Take a look at the output</span><br><span class="line">head(countdata)</span><br></pre></td></tr></table></figure><p>The column names are now the same as <code>SampleName</code> in the <code>sampleinfo</code> file, which means the sample information in <code>sampleinfo</code> is in the same order as the columns in  <code>countdata</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table(colnames(countdata)==sampleinfo$SampleName)</span><br></pre></td></tr></table></figure><h3 id="Filtering-to-remove-lowly-expressed-genes"><a href="#Filtering-to-remove-lowly-expressed-genes" class="headerlink" title="Filtering to remove lowly expressed genes"></a>Filtering to remove lowly expressed genes</h3><p><strong>Genes with very low counts</strong> across all libraries provide little evidence for differential expression and they interfere with some of the statistical approximations that are used later. They also add to the multiple testing burden when estimating false discovery rates, reducing power to detect differentially expressed genes. These genes <strong>should be filtered out prior to further analysis</strong>.</p><p>There are a few ways to filter out lowly expressed genes. When there are biological replicates in each group, in this case we have a sample size of 2 in each group, we favour filtering on a minimum counts per million threshold present in at least 2 samples. Two represents the smallest sample size for each group in out experiment. In this dataset, we choose to retain genes if they are expressed at a counts-per-million (CPM) above 0.5 in at least two samples.</p><p>We will use the <code>cpm</code> function from the <em>edgeR</em> library to generate the CPM values and then filter.</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;RNA-Seq-analysis-in-R&quot;&gt;&lt;a href=&quot;#RNA-Seq-analysis-in-R&quot; class=&quot;headerlink&quot; title=&quot;RNA-Seq analysis in R&quot;&gt;&lt;/a&gt;RNA-Seq analysis in R&lt;/h1&gt;&lt;h2 id=&quot;Some-preparation&quot;&gt;&lt;a href=&quot;#Some-preparation&quot; class=&quot;headerlink&quot; title=&quot;Some preparation:&quot;&gt;&lt;/a&gt;Some preparation:&lt;/h2&gt;&lt;h3 id=&quot;Packages-used&quot;&gt;&lt;a href=&quot;#Packages-used&quot; class=&quot;headerlink&quot; title=&quot;Packages used:&quot;&gt;&lt;/a&gt;Packages used:&lt;/h3&gt;&lt;p&gt;limma&lt;/p&gt;
&lt;p&gt;edgeR&lt;/p&gt;
&lt;p&gt;gplots&lt;/p&gt;
&lt;p&gt;org.Mm.eg.db&lt;/p&gt;
&lt;p&gt;RColorBrewer&lt;/p&gt;
&lt;p&gt;Glimma
    
    </summary>
    
    
      <category term="LINUX, VMware, RNA-Seq, R" scheme="https://cldiao.github.io/tags/LINUX-VMware-RNA-Seq-R/"/>
    
  </entry>
  
</feed>
