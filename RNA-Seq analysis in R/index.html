<!DOCTYPE html>
<html lang="en">

<!-- layout.ejs-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="B">
    <meta name="author" content="Rumble">
    <meta name="keyword" content="hexo, hexo theme, A-RSnippet, responsive, bootstrap">
    <link rel="canonical" href="CLDIAO.github.io/RNA-Seq analysis in R/">
    <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-person-128.png">
    <link rel="alternate" type="application/atom+xml" title="A" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <title>
        
        EDITING｜An A-RSnippet Hexo Theme
        
    </title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <link rel="stylesheet" href="/css/main.css">

    
      <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
      <link rel="stylesheet" href="/css/highlight.css">
    

    
      <script id="dsq-count-scr" src="//hexo-a-rsnippet.disqus.com/count.js" async></script>
    


    
      <meta name="google-site-verification" content="wtCjI-zcpr2FYwWS3sI4OWzMK9e7VomDrZyxpVUUIng" />
    

    

    


    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-38355881-1', 'auto');
    ga('send', 'pageview');
</script>





    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <!-- user customization -->
    <link rel="stylesheet" href="/css/arsnippet.css">
    <script src="/js/arsnippet.css.js"></script>
</head>

<style>
    header.intro-header {
        background-image: url('')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<header>
  <nav class="navbar navbar-default header-navbar" id="nav-top" data-ispost = "true" data-istags="false" data-ishome = "false" >
    <div class="container-fluid">
      <div class="navbar-header page-scroll">
        <button type="button" class="navbar-toggle" data-toggle="collapse" aria-expanded="false"  data-target="#website_navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <span class="navbar-brand animated pulse">
          <a class="brand-logo" href="/">
            A
          </a>
        </span>
      </div>

      <div class="collapse navbar-collapse" id="website_navbar">
          <ul class="nav navbar-nav navbar-right">
              
                <li>
                  <a href="/">home</a>
                </li>
              
                <li>
                  <a href="/tags/">tags</a>
                </li>
              
          </ul>
      </div>
  </nav>


  
    <style>
       .intro-header {
          background-image: url('/img/sky-clouds-moon-horizon.jpg?h=350&amp;auto=compress&amp;cs=tinysrgb');
      }
    </style>

    <div class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                    <div class="site-heading">
                        <h1>EDITING</h1>
                        
                        
                          <span class="meta">
                               <span class="meta-item">Author: Rumble</span>
                               <span class="meta-item">Date: Jul 29, 2018</span>
                               
                                 <span class="meta-item">Updated On: Aug 4, 2018</span>
                               
                          </span>
                          <div class="tags text-center">
                              Categories: 
                          </div>
                          <div class="tags text-center">
                              Tags: 
                              <a class="tag" href="/tags/#LINUX, VMware, RNA-Seq, R"
                                 title="LINUX, VMware, RNA-Seq, R">LINUX, VMware, RNA-Seq, R</a>
                              
                          </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
  
</header>


<!-- Main Content -->
<!-- post.ejs -->
<article>
    <div class="container">
      <div class="col-lg-8 col-lg-offset-1 col-sm-9">
          
            <div class="text-center"><div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5272bc2a7b3c1ddc" async = "async" ></script>
</div>
</div><hr>
          
          <div class="subscribe"><a href="http://eepurl.com/dh6iCD" target="_blank">Get Updated for Each Release!</a></div><p>
          <h1 id="RNA-Seq-analysis-in-R"><a href="#RNA-Seq-analysis-in-R" class="headerlink" title="RNA-Seq analysis in R"></a>RNA-Seq analysis in R</h1><h2 id="Some-preparation"><a href="#Some-preparation" class="headerlink" title="Some preparation:"></a>Some preparation:</h2><h3 id="Packages-used"><a href="#Packages-used" class="headerlink" title="Packages used:"></a>Packages used:</h3><p>limma</p>
<p>edgeR</p>
<p>gplots</p>
<p>org.Mm.eg.db</p>
<p>RColorBrewer</p>
<p>Glimma</p>
<h3 id="VMware-installation"><a href="#VMware-installation" class="headerlink" title="VMware installation:"></a>VMware installation:</h3><p><a href="http://www.zdfans.com/html/5928.html" target="_blank" rel="noopener">vmware-download</a></p>
<p><a href="http://environmentalomics.org/bio-linux-download/" target="_blank" rel="noopener">bio-linux-download</a></p>
<p><a href="http://environmentalomics.org/bio-linux-installation/" target="_blank" rel="noopener">bio-linux-installation</a></p>
<p><a href="https://www.jb51.net/softjc/189144.html" target="_blank" rel="noopener">vmware-tools-installation</a></p>
<p><a href="https://www.cnblogs.com/huangjianxin/p/6343881.html" target="_blank" rel="noopener">filessystem for share</a></p>
<p><a href="https://www.netsarang.com/download/down_form.html?code=622" target="_blank" rel="noopener">X shell-download</a></p>
<p><a href="http://www.bio-info-trainee.com/tag/%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank" rel="noopener">other common questions</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_54f07aba0101s1br.html" target="_blank" rel="noopener">R语言编辑器：notepad++</a></p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li>Reading in table of counts</li>
<li>Filtering lowly expressed genes</li>
<li>Quality control</li>
<li>Normalisation for composition bias</li>
<li>Differential expression analysis</li>
<li>Testing relative to a threshold</li>
<li>Visualisation</li>
<li>Gene set testing</li>
</ul>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>There are many steps involved in analysising an RNA-Seq experiment. Analysising an RNASeq experiment begins with sequencing reads. These are aligned to a reference genome, then the number of reads mapped to each gene can be counted. This results in a table of counts, which is what we perform statistical analyses on in R. While mapping and counting are important and necessary tasks, today we will be starting from the count data and getting stuck into analysis.</p>
<h3 id="Data-import"><a href="#Data-import" class="headerlink" title="Data import"></a>Data import</h3><p>Load all the packages will need to analysis the data.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library(edgeR)</span><br><span class="line">library(limma)</span><br><span class="line">library(Glimma)</span><br><span class="line">library(gplots)</span><br><span class="line">library(org.Mm.eg.db)</span><br><span class="line">library(RColorBrewer)</span><br></pre></td></tr></table></figure>
<h3 id="Mouse-mammary-gland-dataset"><a href="#Mouse-mammary-gland-dataset" class="headerlink" title="Mouse mammary gland dataset"></a>Mouse mammary gland dataset</h3><p>The data comes from a Nature Cell Biology paper, <a href="http://www.ncbi.nlm.nih.gov/pubmed/25730472" target="_blank" rel="noopener"><em>EGF-mediated induction of Mcl-1 at the switch to lactation is essential for alveolar cell survival</em></a>. Both the raw data (sequence reads) and processed data (counts) can be downloaded from <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE60450" target="_blank" rel="noopener">GSE60450</a>.</p>
<p>This study examines the expression profiles of basal stem-cell enriched cells (B) and committed luminal cells (L) in the mammary gland of virgin, pregnant  and lactating mice. Six groups are present, with one for each combination of cell type and mouse status. Each group contains two biological replicates. We will first use the counts file as a starting point for out analysis. This data has already been aligned to the mouse genome.</p>
<h3 id="Reading-in-the-data"><a href="#Reading-in-the-data" class="headerlink" title="Reading in the data"></a>Reading in the data</h3><p>Download and read in the data.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Read the data into R</span><br><span class="line">seqdata &lt;- read.delim(&quot;GSE60450_Lactation-GenewiseCounts.txt&quot;, stringsAsFactors = FALSE)</span><br><span class="line"># Read the sample information into R</span><br><span class="line">sampleinfo &lt;- read.delim(&quot;SampleInfo.txt&quot;)</span><br><span class="line"># Take a look at the data</span><br><span class="line">head(seqdata)</span><br><span class="line"># See how many rows and columns the data frame has</span><br><span class="line">dim(seqdata)</span><br></pre></td></tr></table></figure>
<p>The <code>seqdata</code> object contains information about genes, the first column has the Entrez gene id, the second has the gene length and the remaining columns contain information about the number of reads aligning to the gene in each experimental sample. The sampleinfo file contains basic information about the samples that we will need for the analysis today.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sampleinfo</span><br></pre></td></tr></table></figure>
<p>We will manipulate and reformat the counts matrix into a suitable format for downstream analysis. The first columns in the <code>seqdata</code> dataframe contain annotation information. We need to make a new matrix containing only the counts, but we can store the gene identifiers (the <code>EntrezGeneID</code> column) as rownames. We will add more annotation information about each gene later on in the workshop.</p>
<h3 id="Format-the-data"><a href="#Format-the-data" class="headerlink" title="Format the data"></a>Format the data</h3><p>Create a new data object, <code>countdata</code>, that contains only the counts for the 12 samples.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Remove first two columns from seqdata</span><br><span class="line">countdata &lt;- seqdata[,-(1:2)]</span><br><span class="line"># Look at the output</span><br><span class="line">head(countdata)</span><br><span class="line"># Store EntrezGeneID as rownames</span><br><span class="line">rownames(countdata) &lt;- seqdata[,1]</span><br><span class="line"># Take a look at the output</span><br><span class="line">head(countdata)</span><br><span class="line"># Take a look at the column names</span><br><span class="line">colnames(countdata)</span><br></pre></td></tr></table></figure>
<p>The sample names are pretty long, so we’ll shorten these to contain only the relevant information about each sample. We will use the <code>substr</code> command to extract the first 7 characters and use these as the colnames.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># using substr, you extract the characters starting at position 1 and stopping at position 7 of the colnames</span><br><span class="line">colnames(countdata) &lt;- substr(colnames(countdata),start=1,stop=7)</span><br><span class="line"># Take a look at the output</span><br><span class="line">head(countdata)</span><br></pre></td></tr></table></figure>
<p>The column names are now the same as <code>SampleName</code> in the <code>sampleinfo</code> file, which means the sample information in <code>sampleinfo</code> is in the same order as the columns in  <code>countdata</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table(colnames(countdata)==sampleinfo$SampleName)</span><br></pre></td></tr></table></figure>
<h3 id="Filtering-to-remove-lowly-expressed-genes"><a href="#Filtering-to-remove-lowly-expressed-genes" class="headerlink" title="Filtering to remove lowly expressed genes"></a>Filtering to remove lowly expressed genes</h3><p><strong>Genes with very low counts</strong> across all libraries provide little evidence for differential expression and they interfere with some of the statistical approximations that are used later. They also add to the multiple testing burden when estimating false discovery rates, reducing power to detect differentially expressed genes. These genes <strong>should be filtered out prior to further analysis</strong>.</p>
<p>There are a few ways to filter out lowly expressed genes. When there are biological replicates in each group, in this case we have a sample size of 2 in each group, we favour filtering on a minimum counts per million threshold present in at least 2 samples. Two represents the smallest sample size for each group in out experiment. In this dataset, we choose to retain genes if they are expressed at a counts-per-million (CPM) above 0.5 in at least two samples.</p>
<p>We will use the <code>cpm</code> function from the <em>edgeR</em> library to generate the CPM values and then filter.</p>

          
            <a href="https://www.patreon.com/arsnippet" target="_blank"><img src="/img/patreon.png" alt="support my work at patron"></a> <a href="https://arsnippet.freeflarum.com/" target="_blank"><img src="/img/forum.jpg" alt="support my work at patron"></a> <a href="https://discord.gg/CB6CPzq" target="_blank"><img src="/img/discord.png" alt="Join the Discord"></a>
          
          <hr>
          <ul class="pager">
              
              <li class="previous">
                  <a href="/Mac上安装一些应用/" data-toggle="tooltip" data-placement="left"
                     title="Mac上安装一些应用">&larr; Previous Post</a>
              </li>
              
              
              <li class="next">
                  <a href="/hello-world/" data-toggle="tooltip" data-placement="top"
                     title="Hello World">Next Post&rarr;</a>
              </li>
              
          </ul>
        
  <br>
  
  <!-- disqus start -->
  <div class="comment">
    <div id="disqus_thread"  class="disqus-thread"></div>
      <script>
      var disqus_shortname = 'hexo-a-rsnippet';
      
      var disqus_url = 'CLDIAO.github.io/RNA-Seq analysis in R/';
      
      (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  <!-- disqus end -->
  

  
  </div>


        
  <div class="hidden-xs col-sm-3 toc-col">
    <div class="toc-wrap">
        Table of Contents
        
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RNA-Seq-analysis-in-R"><span class="toc-number">1.</span> <span class="toc-text">RNA-Seq analysis in R</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Some-preparation"><span class="toc-number">1.1.</span> <span class="toc-text">Some preparation:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Packages-used"><span class="toc-number">1.1.1.</span> <span class="toc-text">Packages used:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VMware-installation"><span class="toc-number">1.1.2.</span> <span class="toc-text">VMware installation:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">1.2.</span> <span class="toc-text">Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Introduction"><span class="toc-number">1.2.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Data-import"><span class="toc-number">1.2.2.</span> <span class="toc-text">Data import</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mouse-mammary-gland-dataset"><span class="toc-number">1.2.3.</span> <span class="toc-text">Mouse mammary gland dataset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reading-in-the-data"><span class="toc-number">1.2.4.</span> <span class="toc-text">Reading in the data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Format-the-data"><span class="toc-number">1.2.5.</span> <span class="toc-text">Format the data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Filtering-to-remove-lowly-expressed-genes"><span class="toc-number">1.2.6.</span> <span class="toc-text">Filtering to remove lowly expressed genes</span></a></li></ol></li></ol></li></ol>
        
    </div>
  </div>


      </div>
  </div>
</article>

<!-- Footer -->
<!-- footer.ejs -->
<footer>
    <div class="text-center">
      <ul class="list-inline">
          
              <li>
                  <a href="/atom.xml" target="_blank">
                      <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                      </span>
                  </a>
              </li>
          
          
              <li>
                  <a target="_blank" href="https://twitter.com/the_best_dior">
                      <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                      </span>
                  </a>
              </li>
          
          

          

          

          
              <li>
                  <a target="_blank"  href="https://github.com/CLDIAO">
                      <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                      </span>
                  </a>
              </li>
          

          

          

      </ul>
     <div class="text-muted copyright">
            &copy;
            
            2015 - 2018
            
            
              <i class="fa fa-heart"></i>
            
            Rumble
        <br>
          
              Powered by <a target="_blank" href="https://hexo.io">Hexo</a>
          
          
            |
          
          
              Theme - <a href="https://github.com/huyingjie/hexo-theme-A-RSnippet" target="_blank">A-RSnippet</a> v0.1.0
          
          
      </div>
    </div>
</footer>

<!-- Custom Theme JavaScript -->
<script src="/js/main.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>



</body>

</html>
